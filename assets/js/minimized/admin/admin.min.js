/******/ (function() { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./assets/js/admin/modules/forms/button-styling.js":
/*!*********************************************************!*\
  !*** ./assets/js/admin/modules/forms/button-styling.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Button Styling Form Controls
 *
 * Handles conditional displays and interactions for button styling fields
 */

(function ($) {
  'use strict';

  /**
   * Initialize button styling controls state
   * This runs each time form elements are added (page load and modal open)
   */
  function initButtonStylingState() {
    // Initialize padding link button state
    $('.cta-padding-link-btn').each(function () {
      const $btn = $(this);
      const $container = $btn.closest('.cta-padding-controls');
      const $linkedInput = $container.find('input[name="cta_padding_linked"]');
      const isLinked = $linkedInput.val() === '1';
      $btn.toggleClass('is-linked', isLinked);
      const $icon = $btn.find('.dashicons');
      $icon.removeClass('dashicons-admin-links dashicons-editor-unlink');
      $icon.addClass(isLinked ? 'dashicons-admin-links' : 'dashicons-editor-unlink');
    });

    // Initialize padding controls - sync hidden inputs with value+unit
    $('.cta-padding-value').each(function () {
      const $input = $(this);
      const $form = $input.closest('form');
      const side = $input.data('side');
      const value = $input.val();
      const unit = $form.find(`#cta-padding-${side}-unit`).val();

      // Update hidden combined input
      $form.find(`#cta-padding-${side}`).val(value + unit);
    });

    // Initialize border width link button state
    $('.cta-border-width-link-btn').each(function () {
      const $btn = $(this);
      const $container = $btn.closest('.cta-border-width-controls');
      const $linkedInput = $container.find('input[name="cta_border_width_linked"]');
      const isLinked = $linkedInput.val() === '1';
      $btn.toggleClass('is-linked', isLinked);
      const $icon = $btn.find('.dashicons');
      $icon.removeClass('dashicons-admin-links dashicons-editor-unlink');
      $icon.addClass(isLinked ? 'dashicons-admin-links' : 'dashicons-editor-unlink');
    });

    // Initialize border width controls - sync hidden inputs with value+unit
    $('.cta-border-width-value').each(function () {
      const $input = $(this);
      const $form = $input.closest('form');
      const side = $input.data('side');
      const value = $input.val();
      const unit = $form.find(`#cta-border-width-${side}-unit`).val();

      // Update hidden combined input
      $form.find(`#cta-border-width-${side}`).val(value + unit);
    });

    // Initialize border radius link button state
    $('.cta-border-radius-link-btn').each(function () {
      const $btn = $(this);
      const $container = $btn.closest('.cta-border-radius-controls');
      const $linkedInput = $container.find('input[name="cta_border_radius_linked"]');
      const isLinked = $linkedInput.val() === '1';
      $btn.toggleClass('is-linked', isLinked);
      const $icon = $btn.find('.dashicons');
      $icon.removeClass('dashicons-admin-links dashicons-editor-unlink');
      $icon.addClass(isLinked ? 'dashicons-admin-links' : 'dashicons-editor-unlink');
    });

    // Initialize border radius controls - sync hidden inputs with value+unit
    $('.cta-border-radius-value').each(function () {
      const $input = $(this);
      const $form = $input.closest('form');
      const corner = $input.data('corner');
      const value = $input.val();
      const unit = $form.find(`#cta-border-radius-${corner}-unit`).val();

      // Update hidden combined input
      $form.find(`#cta-border-radius-${corner}`).val(value + unit);
    });

    // Initialize gradient controls visibility
    $('#cta-background-type').each(function () {
      const $select = $(this);
      const type = $select.val();
      const $form = $select.closest('form');

      // Show/hide controls based on current value
      if (type === 'solid') {
        $form.find('.cta-bg-solid-controls').show();
        $form.find('.cta-bg-gradient-controls').hide();
        $form.find('.cta-gradient-details-row').hide();
      } else if (type === 'gradient') {
        $form.find('.cta-bg-solid-controls').hide();
        $form.find('.cta-bg-gradient-controls').show();
        $form.find('.cta-gradient-details-row').show();
      } else {
        $form.find('.cta-bg-solid-controls').hide();
        $form.find('.cta-bg-gradient-controls').hide();
        $form.find('.cta-gradient-details-row').hide();
      }
    });

    // Initialize gradient type visibility
    $('#cta-gradient-type').each(function () {
      const $select = $(this);
      const type = $select.val();
      const $form = $select.closest('form');
      if (type === 'linear') {
        $form.find('.cta-gradient-angle-group').show();
      } else {
        $form.find('.cta-gradient-angle-group').hide();
      }
    });

    // Initialize border controls visibility
    $('#cta-border-style').each(function () {
      const $select = $(this);
      const style = $select.val();
      const $form = $select.closest('form');
      if (style !== 'none') {
        $form.find('.cta-border-controls').show();
      } else {
        $form.find('.cta-border-controls').hide();
      }
    });
  }

  /**
   * Function to update gradient preview
   */
  function updateGradientPreview($form) {
    const type = $form.find('#cta-gradient-type').val() || 'linear';
    const angle = $form.find('#cta-gradient-angle').val() || '90';
    const startColor = $form.find('#cta-gradient-start').val() || '#667eea';
    const startPos = $form.find('#cta-gradient-start-position').val() || '0';
    const endColor = $form.find('#cta-gradient-end').val() || '#764ba2';
    const endPos = $form.find('#cta-gradient-end-position').val() || '100';
    let gradient;
    if (type === 'linear') {
      gradient = `linear-gradient(${angle}deg, ${startColor} ${startPos}%, ${endColor} ${endPos}%)`;
    } else {
      gradient = `radial-gradient(circle, ${startColor} ${startPos}%, ${endColor} ${endPos}%)`;
    }
    $form.find('.cta-gradient-preview').css('background', gradient);
  }

  /**
   * Bind all event handlers - called only ONCE on page load
   */
  function bindEventHandlers() {
    // Background type toggle
    $(document).on('change', '#cta-background-type', function () {
      const type = $(this).val();
      const $form = $(this).closest('form');

      // Show/hide solid controls
      if (type === 'solid') {
        $form.find('.cta-bg-solid-controls').show();
      } else {
        $form.find('.cta-bg-solid-controls').hide();
      }

      // Show/hide gradient controls
      if (type === 'gradient') {
        $form.find('.cta-bg-gradient-controls').show();
        $form.find('.cta-gradient-details-row').show();
      } else {
        $form.find('.cta-bg-gradient-controls').hide();
        $form.find('.cta-gradient-details-row').hide();
      }

      // Trigger preview update
      $(this).trigger('input');
    });

    // Border style toggle
    $(document).on('change', '#cta-border-style', function () {
      const style = $(this).val();
      const $form = $(this).closest('form');

      // Show/hide border controls
      if (style !== 'none') {
        $form.find('.cta-border-controls').show();
      } else {
        $form.find('.cta-border-controls').hide();
      }

      // Trigger preview update
      $(this).trigger('input');
    });

    // Gradient type toggle
    $(document).on('change', '#cta-gradient-type', function () {
      const type = $(this).val();
      const $form = $(this).closest('form');

      // Show/hide angle group for linear gradients
      if (type === 'linear') {
        $form.find('.cta-gradient-angle-group').show();
      } else {
        $form.find('.cta-gradient-angle-group').hide();
      }

      // Update gradient preview
      updateGradientPreview($form);

      // Trigger preview update
      $(this).trigger('input');
    });

    // Gradient angle slider
    $(document).on('input', '#cta-gradient-angle', function () {
      const value = $(this).val();
      const $form = $(this).closest('form');
      $form.find('.cta-angle-value').text(value + 'Â°');

      // Update gradient preview
      updateGradientPreview($form);

      // Trigger preview update
      $(this).trigger('change');
    });

    // Gradient stop position sliders
    $(document).on('input', '.cta-stop-position', function () {
      const value = $(this).val();
      const $stop = $(this).closest('.cta-gradient-stop');
      const $form = $(this).closest('form');
      $stop.find('.cta-stop-label').text(value + '%');

      // Update gradient preview
      updateGradientPreview($form);
    });

    // Gradient stop color pickers
    $(document).on('input', '.cta-stop-color', function () {
      const $form = $(this).closest('form');

      // Update gradient preview
      updateGradientPreview($form);
    });

    // Padding value input changes
    $(document).on('input', '.cta-padding-value', function () {
      const $input = $(this);
      const $form = $input.closest('form');
      const side = $input.data('side');
      const value = $input.val();
      const unit = $form.find(`#cta-padding-${side}-unit`).val();

      // Update slider
      $form.find(`#cta-padding-${side}-slider`).val(value);

      // Update hidden combined input and trigger change for preview
      $form.find(`#cta-padding-${side}`).val(value + unit).trigger('change');

      // If linked, sync to all other sides
      const $container = $input.closest('.cta-padding-controls');
      const $linkedInput = $container.find('input[name="cta_padding_linked"]');
      const isLinked = $linkedInput.val() === '1';
      if (isLinked) {
        ['top', 'right', 'bottom', 'left'].forEach(function (s) {
          if (s !== side) {
            $form.find(`#cta-padding-${s}-value`).val(value);
            $form.find(`#cta-padding-${s}-slider`).val(value);
            const sUnit = $form.find(`#cta-padding-${s}-unit`).val();
            $form.find(`#cta-padding-${s}`).val(value + sUnit);
          }
        });
      }
    });

    // Padding slider changes
    $(document).on('input', '.cta-padding-slider', function () {
      const $slider = $(this);
      const $form = $slider.closest('form');
      const side = $slider.data('side');
      const value = $slider.val();

      // Update number input
      $form.find(`#cta-padding-${side}-value`).val(value).trigger('input');
    });

    // Padding unit dropdown changes
    $(document).on('change', '.cta-padding-unit', function () {
      const $select = $(this);
      const $form = $select.closest('form');
      const side = $select.data('side');
      const unit = $select.val();
      const value = $form.find(`#cta-padding-${side}-value`).val();

      // Update hidden combined input and trigger change for preview
      $form.find(`#cta-padding-${side}`).val(value + unit).trigger('change');

      // If linked, sync unit to all other sides
      const $container = $select.closest('.cta-padding-controls');
      const $linkedInput = $container.find('input[name="cta_padding_linked"]');
      const isLinked = $linkedInput.val() === '1';
      if (isLinked) {
        ['top', 'right', 'bottom', 'left'].forEach(function (s) {
          if (s !== side) {
            $form.find(`#cta-padding-${s}-unit`).val(unit);
            const sValue = $form.find(`#cta-padding-${s}-value`).val();
            $form.find(`#cta-padding-${s}`).val(sValue + unit);
          }
        });
      }
    });

    // Padding link button click handler
    $(document).on('click', '.cta-padding-link-btn', function (e) {
      e.preventDefault();
      const $btn = $(this);
      const $container = $btn.closest('.cta-padding-controls');
      const $linkedInput = $container.find('input[name="cta_padding_linked"]');
      const isLinked = $linkedInput.val() === '1';
      const newState = !isLinked;

      // Toggle linked state
      $linkedInput.val(newState ? '1' : '0');
      $btn.toggleClass('is-linked', newState);

      // Update icon
      const $icon = $btn.find('.dashicons');
      $icon.removeClass('dashicons-admin-links dashicons-editor-unlink');
      $icon.addClass(newState ? 'dashicons-admin-links' : 'dashicons-editor-unlink');

      // If linking, sync all padding values to top value
      if (newState) {
        const topValue = $container.find('.cta-padding-value[data-side="top"]').val();
        const topUnit = $container.find('.cta-padding-unit[data-side="top"]').val();
        ['right', 'bottom', 'left'].forEach(function (side) {
          $container.find(`.cta-padding-value[data-side="${side}"]`).val(topValue);
          $container.find(`.cta-padding-unit[data-side="${side}"]`).val(topUnit);
          $container.find(`.cta-padding-slider[data-side="${side}"]`).val(topValue);
          $container.find(`input[name="cta_padding_${side}"]`).val(topValue + topUnit);
        });
      }
    });

    // Border width value input changes
    $(document).on('input', '.cta-border-width-value', function () {
      const $input = $(this);
      const $form = $input.closest('form');
      const side = $input.data('side');
      const value = $input.val();
      const unit = $form.find(`#cta-border-width-${side}-unit`).val();

      // Update slider
      $form.find(`#cta-border-width-${side}-slider`).val(value);

      // Update hidden combined input and trigger change for preview
      $form.find(`#cta-border-width-${side}`).val(value + unit).trigger('change');

      // If linked, sync to all other sides
      const $container = $input.closest('.cta-border-width-controls');
      const $linkedInput = $container.find('input[name="cta_border_width_linked"]');
      const isLinked = $linkedInput.val() === '1';
      if (isLinked) {
        ['top', 'right', 'bottom', 'left'].forEach(function (s) {
          if (s !== side) {
            $form.find(`#cta-border-width-${s}-value`).val(value);
            $form.find(`#cta-border-width-${s}-slider`).val(value);
            const sUnit = $form.find(`#cta-border-width-${s}-unit`).val();
            $form.find(`#cta-border-width-${s}`).val(value + sUnit);
          }
        });
      }
    });

    // Border width slider changes
    $(document).on('input', '.cta-border-width-slider', function () {
      const $slider = $(this);
      const $form = $slider.closest('form');
      const side = $slider.data('side');
      const value = $slider.val();

      // Update number input
      $form.find(`#cta-border-width-${side}-value`).val(value).trigger('input');
    });

    // Border width unit dropdown changes
    $(document).on('change', '.cta-border-width-unit', function () {
      const $select = $(this);
      const $form = $select.closest('form');
      const side = $select.data('side');
      const unit = $select.val();
      const value = $form.find(`#cta-border-width-${side}-value`).val();

      // Update hidden combined input and trigger change for preview
      $form.find(`#cta-border-width-${side}`).val(value + unit).trigger('change');

      // If linked, sync unit to all other sides
      const $container = $select.closest('.cta-border-width-controls');
      const $linkedInput = $container.find('input[name="cta_border_width_linked"]');
      const isLinked = $linkedInput.val() === '1';
      if (isLinked) {
        ['top', 'right', 'bottom', 'left'].forEach(function (s) {
          if (s !== side) {
            $form.find(`#cta-border-width-${s}-unit`).val(unit);
            const sValue = $form.find(`#cta-border-width-${s}-value`).val();
            $form.find(`#cta-border-width-${s}`).val(sValue + unit);
          }
        });
      }
    });

    // Border width link button click handler
    $(document).on('click', '.cta-border-width-link-btn', function (e) {
      e.preventDefault();
      const $btn = $(this);
      const $container = $btn.closest('.cta-border-width-controls');
      const $linkedInput = $container.find('input[name="cta_border_width_linked"]');
      const isLinked = $linkedInput.val() === '1';
      const newState = !isLinked;

      // Toggle linked state
      $linkedInput.val(newState ? '1' : '0');
      $btn.toggleClass('is-linked', newState);

      // Update icon
      const $icon = $btn.find('.dashicons');
      $icon.removeClass('dashicons-admin-links dashicons-editor-unlink');
      $icon.addClass(newState ? 'dashicons-admin-links' : 'dashicons-editor-unlink');

      // If linking, sync all border width values to top value
      if (newState) {
        const topValue = $container.find('.cta-border-width-value[data-side="top"]').val();
        const topUnit = $container.find('.cta-border-width-unit[data-side="top"]').val();
        ['right', 'bottom', 'left'].forEach(function (side) {
          $container.find(`.cta-border-width-value[data-side="${side}"]`).val(topValue);
          $container.find(`.cta-border-width-unit[data-side="${side}"]`).val(topUnit);
          $container.find(`.cta-border-width-slider[data-side="${side}"]`).val(topValue);
          $container.find(`input[name="cta_border_width_${side}"]`).val(topValue + topUnit);
        });
      }
    });

    // Border radius value input changes
    $(document).on('input', '.cta-border-radius-value', function () {
      const $input = $(this);
      const $form = $input.closest('form');
      const corner = $input.data('corner');
      const value = $input.val();
      const unit = $form.find(`#cta-border-radius-${corner}-unit`).val();

      // Update slider
      $form.find(`#cta-border-radius-${corner}-slider`).val(value);

      // Update hidden combined input and trigger change for preview
      $form.find(`#cta-border-radius-${corner}`).val(value + unit).trigger('change');

      // If linked, sync to all other corners
      const $container = $input.closest('.cta-border-radius-controls');
      const $linkedInput = $container.find('input[name="cta_border_radius_linked"]');
      const isLinked = $linkedInput.val() === '1';
      if (isLinked) {
        ['top-left', 'top-right', 'bottom-right', 'bottom-left'].forEach(function (c) {
          if (c !== corner) {
            $form.find(`#cta-border-radius-${c}-value`).val(value);
            $form.find(`#cta-border-radius-${c}-slider`).val(value);
            const cUnit = $form.find(`#cta-border-radius-${c}-unit`).val();
            $form.find(`#cta-border-radius-${c}`).val(value + cUnit);
          }
        });
      }
    });

    // Border radius slider changes
    $(document).on('input', '.cta-border-radius-slider', function () {
      const $slider = $(this);
      const $form = $slider.closest('form');
      const corner = $slider.data('corner');
      const value = $slider.val();

      // Update number input
      $form.find(`#cta-border-radius-${corner}-value`).val(value).trigger('input');
    });

    // Border radius unit dropdown changes
    $(document).on('change', '.cta-border-radius-unit', function () {
      const $select = $(this);
      const $form = $select.closest('form');
      const corner = $select.data('corner');
      const unit = $select.val();
      const value = $form.find(`#cta-border-radius-${corner}-value`).val();

      // Update hidden combined input and trigger change for preview
      $form.find(`#cta-border-radius-${corner}`).val(value + unit).trigger('change');

      // If linked, sync unit to all other corners
      const $container = $select.closest('.cta-border-radius-controls');
      const $linkedInput = $container.find('input[name="cta_border_radius_linked"]');
      const isLinked = $linkedInput.val() === '1';
      if (isLinked) {
        ['top-left', 'top-right', 'bottom-right', 'bottom-left'].forEach(function (c) {
          if (c !== corner) {
            $form.find(`#cta-border-radius-${c}-unit`).val(unit);
            const cValue = $form.find(`#cta-border-radius-${c}-value`).val();
            $form.find(`#cta-border-radius-${c}`).val(cValue + unit);
          }
        });
      }
    });

    // Border radius link button click handler
    $(document).on('click', '.cta-border-radius-link-btn', function (e) {
      e.preventDefault();
      const $btn = $(this);
      const $container = $btn.closest('.cta-border-radius-controls');
      const $linkedInput = $container.find('input[name="cta_border_radius_linked"]');
      const isLinked = $linkedInput.val() === '1';
      const newState = !isLinked;

      // Toggle linked state
      $linkedInput.val(newState ? '1' : '0');
      $btn.toggleClass('is-linked', newState);

      // Update icon
      const $icon = $btn.find('.dashicons');
      $icon.removeClass('dashicons-admin-links dashicons-editor-unlink');
      $icon.addClass(newState ? 'dashicons-admin-links' : 'dashicons-editor-unlink');

      // If linking, sync all border radius values to top-left value
      if (newState) {
        const topLeftValue = $container.find('.cta-border-radius-value[data-corner="top-left"]').val();
        const topLeftUnit = $container.find('.cta-border-radius-unit[data-corner="top-left"]').val();
        ['top-right', 'bottom-right', 'bottom-left'].forEach(function (corner) {
          $container.find(`.cta-border-radius-value[data-corner="${corner}"]`).val(topLeftValue);
          $container.find(`.cta-border-radius-unit[data-corner="${corner}"]`).val(topLeftUnit);
          $container.find(`.cta-border-radius-slider[data-corner="${corner}"]`).val(topLeftValue);
          $container.find(`input[name="cta_border_radius_${corner.replace('-', '_')}"]`).val(topLeftValue + topLeftUnit);
        });
      }
    });
  }

  // Bind event handlers once on page load
  $(function () {
    bindEventHandlers();
    initButtonStylingState();
  });

  // Re-initialize state when form is loaded (for modals)
  // Event handlers are already bound via delegation, so only state initialization is needed
  $(document).on('ctc:initCtaForm', function () {
    initButtonStylingState();
  });
})(jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/admin/modules/forms/conditional-tabs.js":
/*!***********************************************************!*\
  !*** ./assets/js/admin/modules/forms/conditional-tabs.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Conditional Tabs
 *
 * Handles enabling/disabling tabs based on CTA type and layout
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function ($) {
  'use strict';

  /**
   * Enable a tab
   */
  function enableTab($tabLink, $tabPanel) {
    $tabLink.removeClass('is-disabled').removeAttr('aria-disabled').attr('tabindex', '0');
    $tabLink.find('.cta-tab-dependency-hint').remove();
  }

  /**
   * Disable a tab with optional hint text
   */
  function disableTab($tabLink, $tabPanel, hint) {
    $tabLink.addClass('is-disabled').attr('aria-disabled', 'true').attr('tabindex', '-1');

    // Add hint text if provided and not already present
    if (hint && !$tabLink.find('.cta-tab-dependency-hint').length) {
      $tabLink.append('<span class="cta-tab-dependency-hint">' + hint + '</span>');
    }

    // If currently active, switch to General tab
    if ($tabPanel.hasClass('is-active')) {
      var $container = $tabLink.closest('.cta-section, .cta-global-form-container');
      $container.find('.cta-tab-link[data-tab-target="cta-tab-general"]').trigger('click');
    }
  }

  /**
   * Update conditional tabs based on CTA type and layout
   */
  function updateConditionalTabs($form) {
    var $container = $form ? $form.closest('.cta-section, .cta-global-form-container') : $('.cta-section').first();
    if (!$container.length) {
      return;
    }
    var ctaType = $container.find('#cta-type').val() || 'phone';
    var layout = $container.find('#cta-layout').val() || 'button';

    // Content tab - enabled only for card layouts (not button-only)
    var $contentTabLink = $container.find('.cta-tab-link[data-tab-target="cta-tab-content"]');
    var $contentTabPanel = $container.find('#cta-tab-content');
    if (layout && layout !== 'button') {
      enableTab($contentTabLink, $contentTabPanel);
    } else {
      disableTab($contentTabLink, $contentTabPanel, 'Requires card layout');
    }

    // Slides tab - enabled only for slide-in type
    var $slidesTabLink = $container.find('.cta-tab-link[data-tab-target="cta-tab-slides"]');
    var $slidesTabPanel = $container.find('#cta-tab-slides');
    if (ctaType === 'slide-in') {
      enableTab($slidesTabLink, $slidesTabPanel);
    } else {
      disableTab($slidesTabLink, $slidesTabPanel, 'Requires slide-in type');
    }
  }

  // Prevent clicking disabled tabs
  $(document).on('click', '.cta-tab-link.is-disabled', function (e) {
    e.preventDefault();
    e.stopPropagation();
    e.stopImmediatePropagation();
    return false;
  });

  // Run on page load for existing forms
  $(function () {
    if ($('.cta-cta-form').length) {
      $('.cta-cta-form').each(function () {
        updateConditionalTabs($(this));
      });
    }
  });

  // Run when CTA type or layout changes
  $(document).on('change', '#cta-type, #cta-layout', function () {
    var $form = $(this).closest('.cta-cta-form');
    updateConditionalTabs($form);
  });

  // Run when form is initialized in modal
  $(document).on('ctc:initCtaForm', function (e, form) {
    var $form = $(form);
    setTimeout(function () {
      updateConditionalTabs($form);
    }, 100);
  });
})(jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/admin/modules/modals/docs-modal.js":
/*!******************************************************!*\
  !*** ./assets/js/admin/modules/modals/docs-modal.js ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Documentation Modal
 *
 * Handles the documentation modal functionality including:
 * - Accordion navigation
 * - Page switching
 * - Search filtering (starts after 3 characters)
 */
(function ($) {
  'use strict';

  var CTADocsModal = {
    /**
     * Selectors
     */
    selectors: {
      modal: '#cta-docs-modal',
      searchInput: '[data-docs-search]',
      accordion: '[data-docs-accordion]',
      accordionItem: '.cta-docs-accordion-item',
      accordionTrigger: '.cta-docs-accordion-trigger',
      accordionPanel: '.cta-docs-accordion-panel',
      submenuItem: '.cta-docs-submenu-item',
      submenuLink: '.cta-docs-submenu-link',
      submenuTrigger: '[data-submenu-trigger]',
      submenuPanel: '.cta-docs-submenu-panel',
      submenuAccordion: '.cta-docs-submenu-accordion',
      pageLink: '[data-docs-page]',
      pageContent: '[data-docs-page-content]',
      content: '[data-docs-content]'
    },
    /**
     * State
     */
    currentPage: 'welcome',
    searchQuery: '',
    pendingDocsPage: null,
    // Track the page to open when modal opens

    /**
     * Initialize the documentation modal
     */
    init: function () {
      this.bindEvents();
    },
    /**
     * Bind all event handlers
     */
    bindEvents: function () {
      var self = this;

      // Top-level accordion toggle
      $(document).on('click', self.selectors.accordionTrigger, function (e) {
        e.preventDefault();
        self.toggleAccordion($(this));
      });

      // Submenu accordion toggle
      $(document).on('click', self.selectors.submenuTrigger, function (e) {
        e.preventDefault();
        self.toggleSubmenuAccordion($(this));
      });

      // Page navigation
      $(document).on('click', self.selectors.pageLink, function (e) {
        e.preventDefault();
        var page = $(this).data('docs-page');
        if (page) {
          self.showPage(page);
          self.setActiveLink($(this));
        }
      });

      // Search input with debounce
      var searchTimeout;
      $(document).on('input', self.selectors.searchInput, function () {
        var $input = $(this);
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(function () {
          self.handleSearch($input.val());
        }, 150);
      });

      // Clear search on Escape
      $(document).on('keydown', self.selectors.searchInput, function (e) {
        if (e.key === 'Escape') {
          $(this).val('');
          self.handleSearch('');
        }
      });

      // Open documentation modal trigger
      $(document).on('click', '[data-open-docs-modal]', function (e) {
        e.preventDefault();
        self.openModal();
      });

      // Capture docs page from trigger before modal opens
      $(document).on('click', '[data-open-modal="#cta-docs-modal"]', function () {
        var docsPage = $(this).data('docs-page');
        if (docsPage) {
          self.pendingDocsPage = docsPage;
        }
      });

      // Handle modal open - check for pending docs page
      $(document).on('ctaModalOpened', function (e, $modal, modalId) {
        if (modalId === 'cta-docs-modal') {
          // Clear search and collapse accordions first
          $(self.selectors.searchInput).val('');
          self.handleSearch('');
          self.collapseAllAccordions();

          // Navigate to pending page or welcome
          var targetPage = self.pendingDocsPage || 'welcome';
          var $link = $('[data-docs-page="' + targetPage + '"]');

          // Fall back to welcome if page not found
          if (!$link.length) {
            targetPage = 'welcome';
            $link = $('[data-docs-page="welcome"]');
          }

          // Small delay to ensure modal is fully visible
          setTimeout(function () {
            self.showPage(targetPage);
            self.setActiveLink($link);
          }, 50);

          // Clear pending page
          self.pendingDocsPage = null;
        }
      });

      // Reset when modal closes (via modal-shell)
      $(document).on('ctaModalClosed', function (e, $modal, modalId) {
        if (modalId === 'cta-docs-modal') {
          self.resetModal();
        }
      });
    },
    /**
     * Reset modal to initial state
     */
    resetModal: function () {
      // Reset to welcome page
      this.showPage('welcome');
      this.setActiveLink($('[data-docs-page="welcome"]'));

      // Clear search
      $(this.selectors.searchInput).val('');
      this.handleSearch('');
      // Collapse all accordions
      this.collapseAllAccordions();
    },
    /**
     * Collapse all accordions and submenu accordions
     */
    collapseAllAccordions: function () {
      var self = this;

      // Collapse all top-level accordions
      $(this.selectors.accordionTrigger).each(function () {
        $(this).attr('aria-expanded', 'false');
      });
      $(this.selectors.accordionPanel).each(function () {
        $(this).attr('hidden', true);
      });

      // Collapse all submenu accordions
      $(this.selectors.submenuTrigger).each(function () {
        $(this).attr('aria-expanded', 'false');
      });
      $(this.selectors.submenuPanel).each(function () {
        $(this).attr('hidden', true);
      });
    },
    /**
     * Toggle top-level accordion panel (exclusive behavior)
     */
    toggleAccordion: function ($trigger) {
      var self = this;
      var $item = $trigger.closest(this.selectors.accordionItem);
      var $panel = $item.find(this.selectors.accordionPanel).first();
      var isExpanded = $trigger.attr('aria-expanded') === 'true';

      // Close all other top-level accordions
      $(this.selectors.accordionItem).each(function () {
        var $otherItem = $(this);
        if (!$otherItem.is($item)) {
          var $otherTrigger = $otherItem.find(self.selectors.accordionTrigger).first();
          var $otherPanel = $otherItem.find(self.selectors.accordionPanel).first();
          $otherTrigger.attr('aria-expanded', 'false');
          $otherPanel.attr('hidden', true);
          // Collapse all nested submenu accordions inside the closed parent
          $otherPanel.find(self.selectors.submenuTrigger).attr('aria-expanded', 'false');
          $otherPanel.find(self.selectors.submenuPanel).attr('hidden', true);
        }
      });

      // Toggle current
      $trigger.attr('aria-expanded', !isExpanded);
      if (isExpanded) {
        $panel.attr('hidden', true);
        // Collapse all nested submenu accordions
        $panel.find(self.selectors.submenuTrigger).attr('aria-expanded', 'false');
        $panel.find(self.selectors.submenuPanel).attr('hidden', true);
      } else {
        $panel.removeAttr('hidden');
        // Ensure nested submenu accordions start collapsed when opening
        $panel.find(self.selectors.submenuTrigger).attr('aria-expanded', 'false');
        $panel.find(self.selectors.submenuPanel).attr('hidden', true);
      }
    },
    /**
     * Toggle submenu accordion panel (exclusive within parent)
     */
    toggleSubmenuAccordion: function ($trigger) {
      var self = this;
      var $submenuAccordion = $trigger.closest(this.selectors.submenuAccordion);
      var $panel = $submenuAccordion.find(this.selectors.submenuPanel).first();
      var isExpanded = $trigger.attr('aria-expanded') === 'true';

      // Find the immediate parent list that contains this accordion
      var $parentList = $submenuAccordion.parent();

      // Close only direct sibling submenu accordions at the same level
      // Using .children() instead of .find() ensures we only target siblings, not nested accordions
      $parentList.children(this.selectors.submenuAccordion).each(function () {
        var $otherAccordion = $(this);
        if (!$otherAccordion.is($submenuAccordion)) {
          var $otherTrigger = $otherAccordion.find(self.selectors.submenuTrigger).first();
          var $otherPanel = $otherAccordion.find(self.selectors.submenuPanel).first();
          $otherTrigger.attr('aria-expanded', 'false');
          $otherPanel.attr('hidden', true);
          // Collapse all nested sub-submenus
          $otherPanel.find(self.selectors.submenuTrigger).attr('aria-expanded', 'false');
          $otherPanel.find(self.selectors.submenuPanel).attr('hidden', true);
        }
      });

      // Toggle current
      $trigger.attr('aria-expanded', !isExpanded);
      if (isExpanded) {
        $panel.attr('hidden', true);
        // Collapse all nested submenu accordions
        $panel.find(self.selectors.submenuTrigger).attr('aria-expanded', 'false');
        $panel.find(self.selectors.submenuPanel).attr('hidden', true);
      } else {
        $panel.removeAttr('hidden');
        // Collapse nested levels on open to avoid mixed states
        $panel.find(self.selectors.submenuTrigger).attr('aria-expanded', 'false');
        $panel.find(self.selectors.submenuPanel).attr('hidden', true);
      }
    },
    /**
     * Expand accordion for a specific item
     */
    expandAccordion: function ($item) {
      var $trigger = $item.find(this.selectors.accordionTrigger).first();
      var $panel = $item.find(this.selectors.accordionPanel).first();
      if ($trigger.length && $trigger.attr('aria-expanded') !== 'true') {
        $trigger.attr('aria-expanded', 'true');
        $panel.removeAttr('hidden');
      }
    },
    /**
     * Show a specific documentation page
     */
    showPage: function (pageId) {
      var self = this;
      var $pages = $(this.selectors.pageContent);
      var $targetPage = $('[data-docs-page-content="' + pageId + '"]');
      if (!$targetPage.length) {
        return;
      }

      // Hide all pages
      $pages.removeClass('is-active');

      // Show target page
      $targetPage.addClass('is-active');

      // Update state
      this.currentPage = pageId;

      // Scroll content to top
      $(this.selectors.content).scrollTop(0);
    },
    /**
     * Set active link in navigation
     */
    setActiveLink: function ($link) {
      // Remove active from all links
      $(this.selectors.submenuLink).removeClass('is-active');
      $(this.selectors.pageLink).removeClass('is-active');

      // Add active to clicked link
      $link.addClass('is-active');

      // Expand parent top-level accordion if needed
      var $parentItem = $link.closest(this.selectors.accordionItem);
      if ($parentItem.length) {
        this.expandAccordion($parentItem);
      }

      // Expand parent submenu accordion if needed
      var $parentSubmenu = $link.closest(this.selectors.submenuAccordion);
      if ($parentSubmenu.length) {
        this.expandSubmenuAccordion($parentSubmenu);
      }
    },
    /**
     * Expand submenu accordion for a specific item
     */
    expandSubmenuAccordion: function ($submenuAccordion) {
      var $trigger = $submenuAccordion.find(this.selectors.submenuTrigger).first();
      var $panel = $submenuAccordion.find(this.selectors.submenuPanel).first();
      if ($trigger.length && $trigger.attr('aria-expanded') !== 'true') {
        $trigger.attr('aria-expanded', 'true');
        $panel.removeAttr('hidden');
      }
    },
    /**
     * Handle search input
     */
    handleSearch: function (query) {
      var self = this;
      this.searchQuery = query.toLowerCase().trim();

      // Only filter if 3+ characters or empty
      if (this.searchQuery.length > 0 && this.searchQuery.length < 3) {
        return;
      }
      var $accordion = $(this.selectors.accordion);
      var $items = $accordion.find(this.selectors.accordionItem);
      var $submenuItems = $accordion.find(this.selectors.submenuItem);
      var $submenuAccordions = $accordion.find(this.selectors.submenuAccordion);

      // If empty query, show all
      if (this.searchQuery.length === 0) {
        $items.removeClass('is-hidden');
        $submenuItems.removeClass('is-hidden');
        $submenuAccordions.removeClass('is-hidden');
        return;
      }

      // Filter top-level items
      $items.each(function () {
        var $item = $(this);
        var searchTitle = ($item.data('search-title') || '').toLowerCase();
        var matchesParent = searchTitle.indexOf(self.searchQuery) !== -1;

        // Check submenu accordions
        var $subAccordions = $item.find(self.selectors.submenuAccordion);
        var hasVisibleSubmenuAccordion = false;
        $subAccordions.each(function () {
          var $subAccordion = $(this);
          var subSearchTitle = ($subAccordion.data('search-title') || '').toLowerCase();
          var matchesSubmenuHeader = subSearchTitle.indexOf(self.searchQuery) !== -1;

          // Check submenu items within this accordion
          var $subItems = $subAccordion.find(self.selectors.submenuItem).not(self.selectors.submenuAccordion);
          var hasVisibleChild = false;
          $subItems.each(function () {
            var $subItem = $(this);
            var itemSearchTitle = ($subItem.data('search-title') || '').toLowerCase();
            var matchesItem = itemSearchTitle.indexOf(self.searchQuery) !== -1;
            if (matchesItem || matchesSubmenuHeader || matchesParent) {
              $subItem.removeClass('is-hidden');
              hasVisibleChild = true;
            } else {
              $subItem.addClass('is-hidden');
            }
          });

          // Show/hide submenu accordion
          if (matchesSubmenuHeader || matchesParent || hasVisibleChild) {
            $subAccordion.removeClass('is-hidden');
            hasVisibleSubmenuAccordion = true;
            // Expand submenu accordion if has matching children
            if (hasVisibleChild) {
              self.expandSubmenuAccordion($subAccordion);
            }
          } else {
            $subAccordion.addClass('is-hidden');
          }
        });

        // Check regular submenu items (non-accordion)
        var $regularSubItems = $item.find(self.selectors.submenuItem).not(self.selectors.submenuAccordion).not($item.find(self.selectors.submenuAccordion).find(self.selectors.submenuItem));
        var hasVisibleRegularChild = false;
        $regularSubItems.each(function () {
          var $subItem = $(this);
          var subSearchTitle = ($subItem.data('search-title') || '').toLowerCase();
          var matchesSub = subSearchTitle.indexOf(self.searchQuery) !== -1;
          if (matchesSub || matchesParent) {
            $subItem.removeClass('is-hidden');
            hasVisibleRegularChild = true;
          } else {
            $subItem.addClass('is-hidden');
          }
        });

        // Show/hide parent item
        if (matchesParent || hasVisibleSubmenuAccordion || hasVisibleRegularChild) {
          $item.removeClass('is-hidden');
          // Expand top-level accordion if has matching children
          if ((hasVisibleSubmenuAccordion || hasVisibleRegularChild) && ($subAccordions.length > 0 || $regularSubItems.length > 0)) {
            self.expandAccordion($item);
          }
        } else {
          $item.addClass('is-hidden');
        }
      });
    },
    /**
     * Open the documentation modal
     */
    openModal: function () {
      var $modal = $(this.selectors.modal);
      if ($modal.length) {
        $modal.fadeIn(150);
        $('body').addClass('cta-modal-open');

        // Reset to welcome page
        this.showPage('welcome');
        this.setActiveLink($('[data-docs-page="welcome"]'));

        // Clear search
        $(this.selectors.searchInput).val('');
        this.handleSearch('');

        // Focus search input
        setTimeout(function () {
          $(this.selectors.searchInput).focus();
        }.bind(this), 200);
      }
    },
    /**
     * Close the documentation modal
     */
    closeModal: function () {
      var $modal = $(this.selectors.modal);
      if ($modal.length) {
        $modal.fadeOut(150);
        $('body').removeClass('cta-modal-open');
      }
    },
    /**
     * Open documentation modal and navigate to a specific feature
     *
     * @param {string} featureTitle - The title of the feature to navigate to
     * @param {string} categoryType - Optional category type ('feature' or 'integration')
     */
    openDocumentationModalWithFeature: function (featureTitle, categoryType) {
      var self = this;
      categoryType = categoryType || 'feature';

      // Open the modal first
      var $modal = $(this.selectors.modal);
      if ($modal.length) {
        $modal.fadeIn(150);
        $('body').addClass('cta-modal-open');
      }

      // Find the menu link with matching text
      var $targetLink = null;
      $(this.selectors.submenuLink).each(function () {
        var linkText = $(this).text().trim();
        // Remove any badge text (PRO, Soon, etc)
        linkText = linkText.replace(/\s*(PRO|Soon|Coming Soon)\s*/gi, '').trim();
        if (linkText === featureTitle || linkText.toLowerCase() === featureTitle.toLowerCase()) {
          $targetLink = $(this);
          return false; // Break the loop
        }
      });

      // If we found the link, navigate to it
      if ($targetLink && $targetLink.length) {
        var pageId = $targetLink.data('docs-page');
        if (pageId) {
          // Small delay to let modal open animation start
          setTimeout(function () {
            self.showPage(pageId);
            self.setActiveLink($targetLink);
          }, 100);
        }
      } else {
        // Fallback to welcome page if feature not found
        setTimeout(function () {
          self.showPage('welcome');
          self.setActiveLink($('[data-docs-page="welcome"]'));
        }, 100);
      }

      // Focus search input
      setTimeout(function () {
        $(self.selectors.searchInput).focus();
      }, 200);
    },
    /**
     * Open documentation modal and navigate directly to a docs page
     *
     * @param {string} pageId - The docs page slug
     */
    openDocumentationModalToPage: function (pageId) {
      var self = this;
      if (!pageId) {
        return;
      }
      var $modal = $(this.selectors.modal);
      if (!$modal.length) {
        return;
      }
      var $link = $('[data-docs-page="' + pageId + '"]');
      if (!$link.length) {
        pageId = 'welcome';
      }
      $modal.fadeIn(150);
      $('body').addClass('cta-modal-open');
      setTimeout(function () {
        self.showPage(pageId);
        if ($link.length) {
          self.setActiveLink($link);
        } else {
          self.setActiveLink($('[data-docs-page="welcome"]'));
        }
      }, 100);
      setTimeout(function () {
        $(self.selectors.searchInput).focus();
      }, 200);
    }
  };

  // Initialize when DOM is ready
  $(function () {
    CTADocsModal.init();
  });

  // Expose globally for debugging
  window.CTADocsModal = CTADocsModal;

  // Create CTAManager namespace if it doesn't exist and add the helper method
  window.CTAManager = window.CTAManager || {};
  window.CTAManager.openDocumentationModal = function (featureTitle, categoryType) {
    CTADocsModal.openDocumentationModalWithFeature(featureTitle, categoryType);
  };
  window.CTAManager.openDocumentationModalToPage = function (pageId) {
    CTADocsModal.openDocumentationModalToPage(pageId);
  };
  window.CTAManager.closeModal = function (modalId) {
    if (modalId === 'docs') {
      CTADocsModal.closeModal();
    } else {
      // Use the generic modal API for other modals
      if (window.ctaModalAPI && window.ctaModalAPI.close) {
        window.ctaModalAPI.close('[data-modal="' + modalId + '"]');
      }
    }
  };
})(jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTADocsModal);

/***/ }),

/***/ "./assets/js/admin/modules/modals/features-modal.js":
/*!**********************************************************!*\
  !*** ./assets/js/admin/modules/modals/features-modal.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Features Modal
 *
 * Handles the features modal functionality including:
 * - Tab switching
 * - Modal opening/closing
 */
(function ($) {
  'use strict';

  var CTAFeaturesModal = {
    /**
     * Selectors
     */
    selectors: {
      modal: '#cta-features-modal',
      openTrigger: '[data-open-modal="#cta-features-modal"]'
    },
    /**
     * Initialize the module
     */
    init: function () {
      this.bindEvents();
    },
    /**
     * Bind all event handlers
     */
    bindEvents: function () {
      var self = this;

      // Modal opened event - reset to first tab
      $(document).on('ctaModalOpened', function (e, $modal, modalId) {
        if (modalId === 'cta-features-modal') {
          self.onModalOpened();
        }
      });
    },
    /**
     * Handle modal opening
     */
    onModalOpened: function () {
      // Ensure first tab is active when modal opens
      var $modal = $(this.selectors.modal);
      var $firstTab = $modal.find('.cta-tab-link').first();
      if ($firstTab.length && window.CTATabs && window.CTATabs.goToTab) {
        var firstTabId = $firstTab.data('tab-target');
        window.CTATabs.goToTab(firstTabId, true);
      }
    }
  };

  // Initialize when DOM is ready
  $(function () {
    CTAFeaturesModal.init();
  });

  // Expose globally for debugging
  window.CTAFeaturesModal = CTAFeaturesModal;
})(jQuery);

// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTAFeaturesModal);

/***/ }),

/***/ "./assets/js/admin/modules/modals/format-modal.js":
/*!********************************************************!*\
  !*** ./assets/js/admin/modules/modals/format-modal.js ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Text Formatting Modal Handler
 *
 * Handles formatting modal interactions including:
 * - Font family, size, weight selection
 * - Color picker with hex, RGBA, and gradient support
 * - Text alignment buttons
 * - Live preview updates
 */

(function ($) {
  'use strict';

  window.CTCFormatModal = {
    currentField: null,
    currentFieldType: null,
    init: function () {
      this.bindFormatIcons();
      this.bindModalActions();
      this.bindFormattingControls();
      this.bindColorTabbing();
      this.bindRGBAControls();
      this.bindGradientControls();
    },
    /**
     * Bind format icon button clicks
     */
    bindFormatIcons: function () {
      var self = this;
      $(document).on('click', '.cta-format-icon-btn', function (e) {
        e.preventDefault();
        var fieldType = $(this).data('field');
        self.openModal(fieldType);
      });
    },
    /**
     * Open formatting modal for a specific field
     */
    openModal: function (fieldType) {
      this.currentFieldType = fieldType;
      this.loadCurrentSettings(fieldType);
      if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
        window.ctaModalAPI.open('#cta-format-modal');
      } else {
        $('#cta-format-modal').fadeIn(150);
        $('body').addClass('cta-modal-open');
      }
    },
    /**
     * Load current settings into modal
     */
    loadCurrentSettings: function (fieldType) {
      var fontSize = $('#' + fieldType + '_font_size').val() || '16px';
      var fontFamily = $('#' + fieldType + '_font_family').val() || 'inherit';
      var fontWeight = $('#' + fieldType + '_font_weight').val() || '400';
      var color = $('#' + fieldType + '_color').val() || '#1e1e1e';
      var alignment = $('#' + fieldType + '_alignment').val() || 'left';

      // Parse font size to number and unit
      var sizeMatch = fontSize.match(/^(\d+(?:\.\d+)?)(px|rem|em)$/);
      if (sizeMatch) {
        $('#cta-format-font-size-value').val(sizeMatch[1]);
        $('#cta-format-font-size-unit').val(sizeMatch[2]);
        $('#cta-format-font-size-slider').val(sizeMatch[1]);
      }
      $('#cta-format-font-family').val(fontFamily);
      $('#cta-format-font-weight').val(fontWeight);

      // Set alignment button
      $('.cta-alignment-btn').removeClass('active');
      $('.cta-alignment-btn[data-align="' + alignment + '"]').addClass('active');

      // Determine color type and load into appropriate tab
      if (color.indexOf('gradient') !== -1) {
        // Gradient color - switch to gradient tab
        $('.cta-color-tab-btn').removeClass('active');
        $('.cta-color-tab-btn[data-tab="gradient"]').addClass('active');
        $('.cta-color-tab-content').removeClass('active');
        $('.cta-color-tab-content[data-tab="gradient"]').addClass('active');

        // Parse gradient and populate controls
        // For now, just update the preview - user can adjust settings
        $('.cta-gradient-preview').css('background', color);
      } else if (color.indexOf('rgba') !== -1) {
        // RGBA color - switch to RGBA tab
        $('.cta-color-tab-btn').removeClass('active');
        $('.cta-color-tab-btn[data-tab="rgba"]').addClass('active');
        $('.cta-color-tab-content').removeClass('active');
        $('.cta-color-tab-content[data-tab="rgba"]').addClass('active');

        // Parse RGBA values
        var rgbaMatch = color.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);
        if (rgbaMatch) {
          $('#cta-rgba-r').val(rgbaMatch[1]);
          $('#cta-rgba-g').val(rgbaMatch[2]);
          $('#cta-rgba-b').val(rgbaMatch[3]);
          var alpha = rgbaMatch[4] ? Math.round(parseFloat(rgbaMatch[4]) * 100) : 100;
          $('#cta-rgba-a').val(alpha);

          // Update value inputs
          $('#cta-rgba-r').closest('.cta-rgba-input-group').find('.cta-rgba-value').val(rgbaMatch[1]);
          $('#cta-rgba-g').closest('.cta-rgba-input-group').find('.cta-rgba-value').val(rgbaMatch[2]);
          $('#cta-rgba-b').closest('.cta-rgba-input-group').find('.cta-rgba-value').val(rgbaMatch[3]);
          $('#cta-rgba-a').closest('.cta-rgba-input-group').find('.cta-rgba-value').val(alpha);
          this.updateRGBAPreview();
        }
      } else {
        // Hex/solid color - switch to hex tab (default)
        $('.cta-color-tab-btn').removeClass('active');
        $('.cta-color-tab-btn[data-tab="hex"]').addClass('active');
        $('.cta-color-tab-content').removeClass('active');
        $('.cta-color-tab-content[data-tab="hex"]').addClass('active');
        $('#cta-format-color').val(color);
        $('#cta-color-wheel').val(color);
        this.updateColorPreview(color);
      }
      this.updateFormattingPreview();
    },
    /**
     * Bind modal action buttons
     */
    bindModalActions: function () {
      var self = this;
      $(document).on('click', '#cta-format-modal [data-action="cancel"]', function (e) {
        e.preventDefault();
        self.closeModal();
      });
      $(document).on('click', '#cta-format-modal [data-action="apply"]', function (e) {
        e.preventDefault();
        self.applySettings();
      });
    },
    /**
     * Bind formatting control changes
     */
    bindFormattingControls: function () {
      var self = this;

      // Font family change
      $(document).on('change', '#cta-format-font-family', function () {
        self.updateFormattingPreview();
      });

      // Font size value change
      $(document).on('change input', '#cta-format-font-size-value, #cta-format-font-size-unit', function () {
        var value = $('#cta-format-font-size-value').val();
        $('#cta-format-font-size-slider').val(value);
        self.updateFormattingPreview();
      });

      // Font size slider change
      $(document).on('input', '#cta-format-font-size-slider', function () {
        var value = $(this).val();
        $('#cta-format-font-size-value').val(value);
        self.updateFormattingPreview();
      });

      // Font weight dropdown change
      $(document).on('change', '#cta-format-font-weight', function () {
        self.updateFormattingPreview();
      });

      // Alignment buttons
      $(document).on('click', '.cta-alignment-btn', function (e) {
        e.preventDefault();
        $('.cta-alignment-btn').removeClass('active');
        $(this).addClass('active');
        self.updateFormattingPreview();
      });

      // Hex color input
      $(document).on('input', '#cta-format-color', function () {
        var color = $(this).val();
        $('#cta-color-wheel').val(color);
        self.updateColorPreview(color);
        self.updateFormattingPreview();
      });

      // Color wheel picker
      $(document).on('input', '#cta-color-wheel', function () {
        var color = $(this).val();
        $('#cta-format-color').val(color);
        self.updateColorPreview(color);
        self.updateFormattingPreview();
      });

      // Color presets
      $(document).on('click', '.cta-preset-swatch', function (e) {
        e.preventDefault();
        var color = $(this).data('color');
        $('#cta-format-color').val(color);
        $('#cta-color-wheel').val(color);
        self.updateColorPreview(color);
        self.updateFormattingPreview();
      });
    },
    /**
     * Bind color tabbing
     */
    bindColorTabbing: function () {
      var self = this;
      $(document).on('click', '.cta-color-tab-btn', function (e) {
        e.preventDefault();
        var tab = $(this).data('tab');
        $('.cta-color-tab-btn').removeClass('active');
        $(this).addClass('active');
        $('.cta-color-tab-content').removeClass('active');
        $('.cta-color-tab-content[data-tab="' + tab + '"]').addClass('active');
      });
    },
    /**
     * Bind RGBA controls
     */
    bindRGBAControls: function () {
      var self = this;
      $(document).on('input', '.cta-rgba-slider', function () {
        var container = $(this).closest('.cta-rgba-input-group');
        var valueInput = container.find('.cta-rgba-value');
        valueInput.val($(this).val());
        self.updateRGBAPreview();
      });
      $(document).on('input', '.cta-rgba-value', function () {
        var container = $(this).closest('.cta-rgba-input-group');
        var slider = container.find('.cta-rgba-slider');
        var val = parseInt($(this).val(), 10);
        if (val < 0 || val > 255) {
          val = Math.max(0, Math.min(255, val));
          $(this).val(val);
        }
        slider.val(val);
        self.updateRGBAPreview();
      });
    },
    /**
     * Update RGBA preview
     */
    updateRGBAPreview: function () {
      var r = $('#cta-rgba-r').val();
      var g = $('#cta-rgba-g').val();
      var b = $('#cta-rgba-b').val();
      var a = ($('#cta-rgba-a').val() / 100).toFixed(2);
      var rgba = 'rgba(' + r + ', ' + g + ', ' + b + ', ' + a + ')';
      $('.cta-rgba-preview').css('background-color', rgba);
      $('#cta-format-color').val(rgba);
    },
    /**
     * Bind gradient controls
     */
    bindGradientControls: function () {
      var self = this;
      $(document).on('change', '#cta-gradient-type', function () {
        self.updateGradientPreview();
      });
      $(document).on('input', '#cta-gradient-angle', function () {
        $('.cta-angle-value').text($(this).val() + 'Â°');
        self.updateGradientPreview();
      });
      $(document).on('input', '.cta-gradient-stop input', function () {
        self.updateGradientPreview();
      });
      $(document).on('input', '.cta-stop-position', function () {
        var value = $(this).val();
        $(this).closest('.cta-gradient-stop').find('.cta-stop-label').text(value + '%');
        self.updateGradientPreview();
      });
    },
    /**
     * Update gradient preview
     */
    updateGradientPreview: function () {
      var type = $('#cta-gradient-type').val() || 'linear';
      var angle = $('#cta-gradient-angle').val() || 90;
      var stops = [];
      $('.cta-gradient-stop').each(function () {
        var color = $(this).find('.cta-stop-color').val();
        var position = $(this).find('.cta-stop-position').val();
        stops.push(color + ' ' + position + '%');
      });
      var gradient;
      if (type === 'radial') {
        gradient = 'radial-gradient(' + stops.join(', ') + ')';
      } else {
        gradient = 'linear-gradient(' + angle + 'deg, ' + stops.join(', ') + ')';
      }
      $('.cta-gradient-preview').css('background', gradient);
      // Don't sync gradient to hex color input - keep it separate
    },
    /**
     * Update color preview box
     */
    updateColorPreview: function (color) {
      $('.cta-preview-sample').css('color', color);

      // Adjust background for visibility based on color brightness
      var brightness = this.getBrightness(color);
      var bgColor = brightness > 128 ? '#1e1e1e' : '#ffffff';
      $('.cta-preview-sample').css('background-color', bgColor);
    },
    /**
     * Calculate color brightness (0-255)
     */
    getBrightness: function (color) {
      // Handle hex colors
      if (color.charAt(0) === '#') {
        var hex = color.substring(1);
        var r = parseInt(hex.substr(0, 2), 16);
        var g = parseInt(hex.substr(2, 2), 16);
        var b = parseInt(hex.substr(4, 2), 16);
        return (r * 299 + g * 587 + b * 114) / 1000;
      }
      // For other formats (rgba, gradients), default to light text on dark background
      return 50;
    },
    /**
     * Update formatting preview
     */
    updateFormattingPreview: function () {
      var fontSize = $('#cta-format-font-size-value').val() + $('#cta-format-font-size-unit').val();
      var fontFamily = $('#cta-format-font-family').val();
      var fontWeight = $('#cta-format-font-weight').val() || '400';
      var color = $('#cta-format-color').val();
      var alignment = $('.cta-alignment-btn.active').data('align') || 'left';

      // Note: Preview element was removed from template, this function kept for potential future use
    },
    /**
     * Apply settings to hidden inputs
     */
    applySettings: function () {
      var fieldType = this.currentFieldType;
      var fontSize = $('#cta-format-font-size-value').val() + $('#cta-format-font-size-unit').val();
      var fontFamily = $('#cta-format-font-family').val();
      var fontWeight = $('#cta-format-font-weight').val() || '400';
      var alignment = $('.cta-alignment-btn.active').data('align') || 'left';

      // Determine which color tab is active and get the appropriate color value
      var activeTab = $('.cta-color-tab-btn.active').data('tab');
      var color;
      if (activeTab === 'gradient') {
        // Build gradient CSS from current settings
        var type = $('#cta-gradient-type').val() || 'linear';
        var angle = $('#cta-gradient-angle').val() || 90;
        var stops = [];
        $('.cta-gradient-stop').each(function () {
          var stopColor = $(this).find('.cta-stop-color').val();
          var position = $(this).find('.cta-stop-position').val();
          stops.push(stopColor + ' ' + position + '%');
        });
        if (type === 'radial') {
          color = 'radial-gradient(' + stops.join(', ') + ')';
        } else {
          color = 'linear-gradient(' + angle + 'deg, ' + stops.join(', ') + ')';
        }
      } else if (activeTab === 'rgba') {
        // Get RGBA value
        var r = $('#cta-rgba-r').val();
        var g = $('#cta-rgba-g').val();
        var b = $('#cta-rgba-b').val();
        var a = ($('#cta-rgba-a').val() / 100).toFixed(2);
        color = 'rgba(' + r + ', ' + g + ', ' + b + ', ' + a + ')';
      } else {
        // Get hex/solid color
        color = $('#cta-format-color').val();
      }
      $('#' + fieldType + '_font_size').val(fontSize);
      $('#' + fieldType + '_font_family').val(fontFamily);
      $('#' + fieldType + '_font_weight').val(fontWeight);
      $('#' + fieldType + '_color').val(color);
      $('#' + fieldType + '_alignment').val(alignment);

      // Trigger preview update via custom event
      $(document).trigger('ctaFormatApplied', [fieldType]);
      this.closeModal();
    },
    /**
     * Close modal
     */
    closeModal: function () {
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close('#cta-format-modal');
      } else {
        $('#cta-format-modal').fadeOut(150, function () {
          if (!$('.cta-modal:visible').length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }
    }
  };
  $(function () {
    if ($('#cta-format-modal').length) {
      CTCFormatModal.init();
    }
  });
})(jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTCFormatModal);

/***/ }),

/***/ "./assets/js/admin/modules/modals/global-modal.js":
/*!********************************************************!*\
  !*** ./assets/js/admin/modules/modals/global-modal.js ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * Global CTA modal helper
 *
 * Handles template injection/cleanup while relying on the shared modal shell
 * for open/close interactions. Supports both create and edit modes.
 */
(function ($) {
  if (typeof $ !== 'function' || !$.fn) {
    return;
  }
  'use strict';
  var modalSelector = '#cta-global-form-modal';
  var templateSelector = '#cta-global-form-template';
  var currentCtaData = null;
  var triggerElement = null;

  /**
   * Field name mapping: CTA data key -> form field name
   */
  var fieldNameMap = {
    // General
    'name': 'cta_name',
    'status': 'cta_status',
    // Display
    'layout': 'cta_layout',
    // Action
    'type': 'cta_type',
    // Content (Pro)
    'title': 'cta_title',
    'tagline': 'cta_tagline',
    'body_text': 'cta_body_text',
    // Button
    'icon': 'cta_icon',
    'color': 'cta_color',
    'background_type': 'cta_background_type',
    'gradient_type': 'cta_gradient_type',
    'gradient_angle': 'cta_gradient_angle',
    'gradient_start': 'cta_gradient_start',
    'gradient_start_position': 'cta_gradient_start_position',
    'gradient_end': 'cta_gradient_end',
    'gradient_end_position': 'cta_gradient_end_position',
    'border_style': 'cta_border_style',
    'border_color': 'cta_border_color',
    'border_width_top': 'cta_border_width_top',
    'border_width_right': 'cta_border_width_right',
    'border_width_bottom': 'cta_border_width_bottom',
    'border_width_left': 'cta_border_width_left',
    'border_width_linked': 'cta_border_width_linked',
    'border_radius_top_left': 'cta_border_radius_top_left',
    'border_radius_top_right': 'cta_border_radius_top_right',
    'border_radius_bottom_right': 'cta_border_radius_bottom_right',
    'border_radius_bottom_left': 'cta_border_radius_bottom_left',
    'border_radius_linked': 'cta_border_radius_linked',
    'padding_top': 'cta_padding_top',
    'padding_right': 'cta_padding_right',
    'padding_bottom': 'cta_padding_bottom',
    'padding_left': 'cta_padding_left',
    'padding_linked': 'cta_padding_linked',
    // Button width and alignment (no prefix needed)
    'button_width': 'button_width',
    'button_alignment': 'button_alignment',
    // Advanced (Pro)
    'html_id': 'cta_html_id',
    'classes': 'cta_classes'
  };

  /**
   * Validate required fields and update save button state
   */
  function validateRequiredFields($modal) {
    var $saveBtn = $modal.find('#cta-modal-save-btn');
    var $container = $modal.find('.cta-global-form-container');
    if (!$saveBtn.length || !$container.length) {
      return;
    }
    var isValid = true;

    // CTA Name is always required
    var ctaName = $container.find('#cta-name').val();
    if (!ctaName || !ctaName.trim()) {
      isValid = false;
    }

    // Check action-specific required fields based on CTA type
    if (isValid) {
      var ctaType = $container.find('#cta-type').val() || 'phone';
      switch (ctaType) {
        case 'phone':
          var phoneNumber = $container.find('#phone-number').val();
          if (!phoneNumber || !phoneNumber.trim()) {
            isValid = false;
          }
          break;
        case 'email':
          var emailTo = $container.find('#cta-email-to').val();
          if (!emailTo || !emailTo.trim()) {
            isValid = false;
          }
          break;
        case 'link':
          var linkUrl = $container.find('#cta-link-url').val();
          if (!linkUrl || !linkUrl.trim()) {
            isValid = false;
          }
          break;

        // popup, slide-in don't have additional required action fields
      }
    }

    // Update save button state
    $saveBtn.prop('disabled', !isValid);
    $saveBtn.toggleClass('is-disabled', !isValid);
  }

  /**
   * Bind validation events to required fields
   */
  function bindValidationEvents($modal) {
    var $container = $modal.find('.cta-global-form-container');

    // Fields to watch for changes
    var fieldsToWatch = '#cta-name, #cta-type, #phone-number, #cta-email-to, #cta-link-url';

    // Unbind previous handlers and bind new ones
    $container.off('input.ctaValidation change.ctaValidation', fieldsToWatch);
    $container.on('input.ctaValidation change.ctaValidation', fieldsToWatch, function () {
      validateRequiredFields($modal);
    });

    // Initial validation
    validateRequiredFields($modal);
  }

  /**
   * Reset tabs to first tab (General)
   */
  function resetTabsToFirst($container) {
    var $tabs = $container.find('.cta-tabs');
    var $tabPanels = $container.find('.cta-tab-panels');

    // Reset to first tab
    $tabs.find('.cta-tab-link').removeClass('is-active').attr('aria-selected', 'false');
    $tabs.find('.cta-tab-link').first().addClass('is-active').attr('aria-selected', 'true');
    $tabPanels.find('.cta-tab-panel').removeClass('is-active');
    $tabPanels.find('.cta-tab-panel').first().addClass('is-active');
  }

  /**
   * Reset form fields to defaults
   */
  function resetFormFields($container) {
    var $form = $container.find('#cta-cta-form');
    if ($form.length) {
      $form[0].reset();

      // Reset select elements to their first option (default)
      $form.find('select').each(function () {
        var $select = $(this);
        var $firstOption = $select.find('option').first();
        if ($firstOption.length) {
          $select.val($firstOption.val()).trigger('change');
        }
      });

      // Ensure hidden fields are also reset
      $form.find('input[name="cta_action"]').val('create');
      $form.find('input[name="cta_id"]').remove();
    }

    // Hide metadata section for new CTA mode
    $container.find('#cta-form-metadata').hide();
  }

  /**
   * Reset modal to initial state (first tab, empty form)
   * @deprecated Use resetTabsToFirst and resetFormFields separately
   */
  function resetModalState($container) {
    resetTabsToFirst($container);
    resetFormFields($container);
  }

  /**
   * Populate form with CTA data for edit mode
   */
  function populateFormWithData($form, ctaData) {
    if (!$form.length || !ctaData) {
      return;
    }

    // Set form to update mode
    $form.find('input[name="cta_action"]').val('update');

    // Add or update CTA ID
    var $ctaIdField = $form.find('input[name="cta_id"]');
    if ($ctaIdField.length) {
      $ctaIdField.val(ctaData.id);
    } else {
      $form.append('<input type="hidden" name="cta_id" value="' + ctaData.id + '" />');
    }

    // Populate each field
    $.each(ctaData, function (key, value) {
      if (value === null || value === undefined) {
        return;
      }

      // Special handling for link_target -> link_target_new_tab checkbox
      if (key === 'link_target') {
        var $newTabCheckbox = $form.find('#cta-link-target-new-tab');
        if ($newTabCheckbox.length) {
          $newTabCheckbox.prop('checked', value === '_blank');
        }
        return;
      }

      // Map key to form field name if mapping exists
      var fieldName = fieldNameMap[key] || key;
      var $field = $form.find('[name="' + fieldName + '"]');

      // Also try original key if mapped field not found
      if (!$field.length && fieldNameMap[key]) {
        $field = $form.find('[name="' + key + '"]');
      }
      if ($field.length) {
        if ($field.is(':checkbox')) {
          $field.prop('checked', !!value);
        } else if ($field.is(':radio')) {
          $field.filter('[value="' + value + '"]').prop('checked', true);
        } else {
          $field.val(value);
        }
      }
    });

    // Trigger change events to update UI (show/hide conditional fields)
    $form.find('select').trigger('change');

    // Update button alignment buttons' active state (only if not full width)
    var buttonWidth = ctaData.button_width || 'auto';
    var buttonAlignment = ctaData.button_alignment || 'center';
    var $alignmentBtns = $form.find('.cta-button-alignment-buttons .cta-button-alignment-btn');
    if (buttonWidth === 'full') {
      // Full width forces center alignment with disabled buttons
      $alignmentBtns.addClass('disabled').prop('disabled', true);
      $alignmentBtns.removeClass('active');
      $alignmentBtns.filter('[data-align="center"]').addClass('active');
      $form.find('#button_alignment').val('center');
    } else {
      $alignmentBtns.removeClass('disabled').prop('disabled', false);
      $alignmentBtns.removeClass('active');
      $alignmentBtns.filter('[data-align="' + buttonAlignment + '"]').addClass('active');
    }

    // Populate metadata section for edit mode
    populateMetadataSection($form, ctaData);

    // Trigger custom event for form population
    $(document).trigger('ctc:editFormPopulated', [$form, ctaData]);
  }

  /**
   * Populate metadata section with CTA data (edit mode only)
   */
  function populateMetadataSection($form, ctaData) {
    var $container = $form.closest('.cta-section, .cta-global-form-container');
    var $metadata = $container.find('#cta-form-metadata');
    if (!$metadata.length || !ctaData) {
      return;
    }

    // Format date for display
    function formatDate(dateStr) {
      if (!dateStr) {
        return 'â';
      }
      var date = new Date(dateStr);
      if (isNaN(date.getTime())) {
        return 'â';
      }
      // Use locale date format
      return date.toLocaleDateString(undefined, {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      });
    }

    // Populate date fields
    $metadata.find('[data-field="created"] .cta-cta-date-value').text(formatDate(ctaData.created_at));
    $metadata.find('[data-field="modified"] .cta-cta-date-value').text(formatDate(ctaData.updated_at));
    var firstActive = ctaData.first_active_at || ctaData.published_at;
    $metadata.find('[data-field="first-active"] .cta-cta-date-value').text(formatDate(firstActive));

    // Populate created by field
    var createdByName = ctaData.created_by_name || 'â';
    $metadata.find('[data-field="created-by"] .cta-cta-date-value').text(createdByName);

    // Handle schedule dates
    var status = ctaData.status || 'draft';
    var scheduleStart = ctaData.schedule_start;
    var scheduleEnd = ctaData.schedule_end;
    var now = new Date();
    var isScheduled = status === 'scheduled' || status === 'publish' && scheduleStart && new Date(scheduleStart) > now;
    var isPublished = status === 'publish' && !isScheduled;

    // Show/hide schedule start
    var $startsField = $metadata.find('[data-field="starts"]');
    if (isScheduled && scheduleStart) {
      $startsField.find('.cta-cta-date-value').text(formatDate(scheduleStart));
      $startsField.show();
    } else {
      $startsField.hide();
    }

    // Show/hide schedule end
    var $endsField = $metadata.find('[data-field="ends"]');
    if (scheduleEnd && (isScheduled || isPublished)) {
      $endsField.find('.cta-cta-date-value').text(formatDate(scheduleEnd));
      $endsField.show();
    } else {
      $endsField.hide();
    }

    // Handle countdown timer
    var $countdown = $metadata.find('.cta-cta-dates-right');
    var countdownTarget = null;
    var countdownLabel = '';
    if (isScheduled && scheduleStart) {
      countdownTarget = new Date(scheduleStart + ' 00:00:00');
      countdownLabel = 'Publishes in:';
    } else if (isPublished && scheduleEnd) {
      var endDate = new Date(scheduleEnd + ' 23:59:59');
      if (endDate > now) {
        countdownTarget = endDate;
        countdownLabel = 'Ends in:';
      }
    }
    if (countdownTarget && countdownTarget > now) {
      $countdown.find('.cta-countdown-label').text(countdownLabel);
      $countdown.find('.cta-countdown-time').text(humanTimeDiff(now, countdownTarget));
      $countdown.show();
    } else {
      $countdown.hide();
    }

    // Show the metadata section
    $metadata.show();
  }

  /**
   * Calculate human-readable time difference
   */
  function humanTimeDiff(from, to) {
    var diff = Math.abs(to - from) / 1000; // seconds

    if (diff < 60) {
      return Math.round(diff) + ' seconds';
    }
    diff /= 60; // minutes
    if (diff < 60) {
      return Math.round(diff) + ' minute' + (Math.round(diff) !== 1 ? 's' : '');
    }
    diff /= 60; // hours
    if (diff < 24) {
      return Math.round(diff) + ' hour' + (Math.round(diff) !== 1 ? 's' : '');
    }
    diff /= 24; // days
    if (diff < 30) {
      return Math.round(diff) + ' day' + (Math.round(diff) !== 1 ? 's' : '');
    }
    diff /= 30; // months (approx)
    if (diff < 12) {
      return Math.round(diff) + ' month' + (Math.round(diff) !== 1 ? 's' : '');
    }
    diff /= 12; // years
    return Math.round(diff) + ' year' + (Math.round(diff) !== 1 ? 's' : '');
  }

  /**
   * Update modal title based on mode
   */
  function updateModalTitle($modal, isEditMode, ctaName) {
    var $titleContainer = $modal.find('.cta-modal-header h2');
    if (!$titleContainer.length) {
      return;
    }
    if (isEditMode && ctaName) {
      var escapedName = $('<div>').text(ctaName).html();
      $titleContainer.html('<span class="dashicons dashicons-edit"></span>Edit CTA: ' + escapedName);
    } else {
      $titleContainer.html('<span class="dashicons dashicons-welcome-add-page"></span>New CTA');
    }
  }

  /**
   * Update save button text based on mode
   */
  function updateSaveButtonText($modal, isEditMode) {
    var $saveBtn = $modal.find('#cta-modal-save-btn');
    if ($saveBtn.length) {
      $saveBtn.text(isEditMode ? 'Update CTA' : 'Save CTA');
    }
  }

  /**
   * Wire up modal header controls to work with the cloned form
   */
  function wireHeaderControls($modal, $form) {
    var $saveBtn = $modal.find('#cta-modal-save-btn');
    var $helpBtn = $modal.find('.cta-docs-trigger');
    var $formHelpBtn = $form.closest('.cta-section').find('.cta-docs-trigger');

    // Wire save button to submit form
    if ($saveBtn.length && $form.length) {
      $saveBtn.off('click.ctaGlobalModal').on('click.ctaGlobalModal', function (e) {
        e.preventDefault();
        $form.trigger('submit');
      });
    }

    // Wire help button to trigger same action as form help button
    if ($helpBtn.length && $formHelpBtn.length) {
      $helpBtn.off('click.ctaGlobalModal').on('click.ctaGlobalModal', function (e) {
        e.preventDefault();
        $formHelpBtn.trigger('click');
      });
    }
  }
  function renderTemplate() {
    var $modal = $(modalSelector);
    var $container = $modal.find('.cta-global-form-container');
    var templateEl = document.querySelector(templateSelector);
    if (!$container.length || !templateEl) {
      return;
    }

    // Always clear and re-render to ensure fresh state
    $container.empty();
    if ('content' in templateEl) {
      var clone = document.importNode(templateEl.content, true);
      $container.append(clone);
    } else {
      $container.html($(templateEl).html());
    }
    var $form = $container.find('#cta-cta-form').first();
    if ($form.length) {
      $(document).trigger('ctc:initCtaForm', [$form]);

      // Re-initialize tabs after template is rendered
      if (typeof window.CTATabs !== 'undefined' && window.CTATabs.init) {
        window.CTATabs.init();
      }

      // Hide section header actions since they're now in modal header
      $container.find('.cta-section-header').first().hide();

      // Wire up modal header controls
      wireHeaderControls($modal, $form);

      // Always reset tabs to first tab on modal open
      resetTabsToFirst($container);

      // Check if we're in edit mode (have CTA data)
      var isEditMode = currentCtaData !== null;
      if (isEditMode) {
        // Populate form with existing CTA data
        populateFormWithData($form, currentCtaData);
        updateModalTitle($modal, true, currentCtaData.name);
        updateSaveButtonText($modal, true);
      } else {
        // Reset form fields for new CTA
        resetFormFields($container);
        updateModalTitle($modal, false);
        updateSaveButtonText($modal, false);
      }

      // Bind validation events and run initial validation
      bindValidationEvents($modal);
    }
  }
  $(function () {
    // Capture trigger element before modal opens
    $(document).on('click', '[data-open-modal="' + modalSelector + '"]', function () {
      triggerElement = this;
      var $trigger = $(this);

      // Check if this is an edit action (has cta-data)
      if ($trigger.data('cta-data')) {
        currentCtaData = $trigger.data('cta-data');
      } else {
        currentCtaData = null;
      }
    });
    $(document).on('ctaModalOpened', function (event, $modal) {
      if (!$modal || !$modal.length || !$modal.is(modalSelector)) {
        return;
      }
      renderTemplate();
    });
    $(document).on('ctaModalClosed', function (event, $modal) {
      if (!$modal || !$modal.length || !$modal.is(modalSelector)) {
        return;
      }
      $modal.find('.cta-global-form-container').empty();
      // Reset state
      currentCtaData = null;
      triggerElement = null;
    });
  });
})(jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/admin/modules/modals/modals.js":
/*!**************************************************!*\
  !*** ./assets/js/admin/modules/modals/modals.js ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Modal Shell Helpers
 *
 * Provides open/close behavior for modals built with the shared modal partial.
 */
(function ($) {
  'use strict';

  // Reset tabs, forms, status messages, and file inputs inside a modal
  function resetModalState($modal) {
    resetModalTabs($modal);

    // Reset any forms to their default values
    $modal.find('form').each(function () {
      if (typeof this.reset === 'function') {
        this.reset();
      }
    });

    // Clear status/error/success messaging blocks
    const $statusBlocks = $modal.find('.cta-status-message, .cta-import-error, .cta-import-status, .cta-onboarding-import-status, .cta-onboarding-demo-status, .cta-modal-error, .cta-modal-success');
    $statusBlocks.removeClass('status-loading status-success status-error').hide().empty();

    // Restore file input wrappers to initial state
    $modal.find('.cta-file-selected, [id$="-file-selected"]').hide();
    $modal.find('.cta-file-wrapper, [id$="-file-wrapper"]').show();
    $modal.find('.cta-import-actions, [id$="-import-actions"]').hide();

    // Remove validation/error styling
    $modal.find('.is-error, .has-error').removeClass('is-error has-error');
    $modal.find('.cta-input-error').empty().hide();

    // Scroll modal content back to top
    $modal.scrollTop(0);
  }

  // Reset tabs within a modal to the first tab
  function resetModalTabs($modal) {
    const $tabs = $modal.find('.cta-tabs, .cta-tabs__nav');
    const $tabPanels = $modal.find('.cta-tab-panels');
    if (!$tabs.length) return;
    const $tabLinks = $tabs.find('.cta-tab-link');
    $tabLinks.removeClass('is-active').attr('aria-selected', 'false');
    $tabLinks.first().addClass('is-active').attr('aria-selected', 'true');
    const $panels = $tabPanels.find('.cta-tab-panel');
    $panels.removeClass('is-active');
    $panels.first().addClass('is-active');
  }
  function releaseBodyLock($modal) {
    if ($('.cta-modal:visible').not($modal).length === 0) {
      $('body').removeClass('cta-modal-open');
    }
  }

  // Update URL query param to reflect current modal without page reload
  function setModalQueryParam(modalId) {
    try {
      const url = new URL(window.location.href);
      if (modalId) {
        url.searchParams.set('modal', modalId);
      } else {
        url.searchParams.delete('modal');
      }
      history.replaceState(null, '', url.toString());
    } catch (e) {
      // Ignore if URL API unsupported
    }
  }
  function updateModalQueryToTopVisible() {
    const $visible = $('.cta-modal:visible').last();
    if ($visible.length) {
      setModalQueryParam($visible.attr('id'));
    } else {
      setModalQueryParam(null);
    }
  }
  function closeModal($modal) {
    $modal.fadeOut(150, function () {
      // Reset modal to pristine state after it is hidden
      resetModalState($modal);
      $(document).trigger('ctaModalClosed', [$modal]);
      // Remove modal param from URL when closing
      setModalQueryParam(null);
      releaseBodyLock($modal);
    });
  }
  function openModal($modal) {
    // Always start from a clean slate
    resetModalState($modal);
    $modal.fadeIn(150, function () {
      $(document).trigger('ctaModalOpened', [$modal]);
    });
    $('body').addClass('cta-modal-open');
    // Do not automatically add modal param to URL - only open on refresh if param was already present
    // setModalQueryParam($modal.attr('id'));
  }
  $(function () {
    $(document).on('click', '[data-open-modal]', function (e) {
      e.preventDefault();
      var target = $(this).data('open-modal');
      if (!target) return;
      var $modal = $(target);
      if ($modal.length) {
        openModal($modal);
      }
    });
    $(document).on('click', '.cta-modal [data-close-modal], .cta-modal .cta-modal-overlay', function (e) {
      e.preventDefault();
      // Respect click-out config
      if ($(this).is('.cta-modal-overlay') && $(this).attr('data-close-on-clickout') === 'false') {
        return;
      }
      var $modal = $(this).closest('.cta-modal');
      closeModal($modal);
    });
    $(document).on('keydown', function (e) {
      if (e.key === 'Escape') {
        $('.cta-modal:visible').each(function () {
          closeModal($(this));
        });
      }
    });
  });

  // Lightweight public helpers for other modal scripts
  window.ctaModalAPI = {
    open: function (selectorOrEl) {
      var $modal = selectorOrEl instanceof $ ? selectorOrEl : $(selectorOrEl);
      if ($modal && $modal.length) {
        openModal($modal);
      }
    },
    close: function (selectorOrEl) {
      var $modal = selectorOrEl instanceof $ ? selectorOrEl : $(selectorOrEl);
      if ($modal && $modal.length) {
        closeModal($modal);
      }
    },
    releaseBodyLock: releaseBodyLock
  };
})(jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/admin/modules/modals/onboarding-modal.js":
/*!************************************************************!*\
  !*** ./assets/js/admin/modules/modals/onboarding-modal.js ***!
  \************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Onboarding Wizard
 *
 * Handles the multi-step onboarding wizard with horizontal breadcrumb navigation.
 *
 * Steps:
 * 1. Welcome - Introduction to CTA Manager
 * 2. Import Data - Optional import of existing CTA data from JSON file
 * 3. Demo Data - Optional import of demo CTAs and analytics
 * 4. Support Overview - Explanation of support toolbar icons
 */

(function ($) {
  if (typeof $ !== 'function' || !$.fn) {
    return;
  }
  'use strict';

  /**
   * Onboarding Wizard Controller
   */
  window.CTAOnboarding = {
    currentStep: 1,
    totalSteps: 4,
    $modal: null,
    $breadcrumb: null,
    $steps: null,
    $nextBtn: null,
    $prevBtn: null,
    $finishBtn: null,
    $skipBtn: null,
    selectedFile: null,
    step2ImportComplete: false,
    step3DemoDataExists: false,
    /**
     * Initialize the onboarding wizard
     */
    init: function () {
      this.$modal = $('#cta-dashboard-help-modal');
      if (!this.$modal.length) {
        return;
      }
      this.$breadcrumb = this.$modal.find('.cta-onboarding-breadcrumb');
      this.$steps = this.$modal.find('.cta-onboarding-step');
      this.$nextBtn = this.$modal.find('.cta-onboarding-next');
      this.$prevBtn = this.$modal.find('.cta-onboarding-prev');
      this.$finishBtn = this.$modal.find('.cta-onboarding-finish');
      this.$skipBtn = this.$modal.find('.cta-onboarding-skip');
      this.$docsBtn = this.$modal.find('#cta-onboarding-docs-btn');
      this.$maybeLater = this.$modal.find('#cta-onboarding-maybe-later');
      this.$supportBtn = this.$modal.find('#cta-onboarding-support-btn');
      if (!this.$breadcrumb.length || !this.$steps.length) {
        return;
      }

      // Initialize step 3 demo data state from server
      if (typeof ctaAdminVars !== 'undefined' && ctaAdminVars.hasDemoData) {
        this.step3DemoDataExists = true;
      }
      this.bindEvents();
      this.bindImportEvents();
      this.bindDemoEvents();
      this.updateStepDisplay();
    },
    /**
     * Bind event handlers
     */
    bindEvents: function () {
      var self = this;

      // Next button
      this.$nextBtn.on('click', function (e) {
        e.preventDefault();
        self.goToStep(self.currentStep + 1);
      });

      // Previous button
      this.$prevBtn.on('click', function (e) {
        e.preventDefault();
        self.goToStep(self.currentStep - 1);
      });

      // Finish button
      this.$finishBtn.on('click', function (e) {
        e.preventDefault();
        self.finish();
      });

      // Skip button
      this.$skipBtn.on('click', function (e) {
        e.preventDefault();
        self.skip();
      });

      // Docs button (Step 1)
      if (this.$docsBtn && this.$docsBtn.length) {
        this.$docsBtn.on('click', function (e) {
          e.preventDefault();
          self.openDocsModal();
        });
      }

      // Support button (Step 4)
      if (this.$supportBtn && this.$supportBtn.length) {
        this.$supportBtn.on('click', function (e) {
          e.preventDefault();
          self.openSupportModal();
        });
      }

      // Maybe Later link in footer
      if (this.$maybeLater && this.$maybeLater.length) {
        this.$maybeLater.on('click', function (e) {
          e.preventDefault();
          self.skip();
        });
      }

      // Breadcrumb click navigation
      this.$breadcrumb.find('.cta-breadcrumb-step').on('click', function (e) {
        e.preventDefault();
        var step = parseInt($(this).data('step'), 10);
        if (!isNaN(step) && step !== self.currentStep) {
          self.goToStep(step);
        }
      });

      // Reset to first step when modal closes
      $(document).on('ctaModalClosed', function (e, $modal, modalId) {
        if (modalId === 'cta-dashboard-help-modal') {
          self.resetToFirstStep();
        }
      });
    },
    /**
     * Reset wizard to first step
     */
    resetToFirstStep: function () {
      this.currentStep = 1;
      this.goToStep(1);
    },
    /**
     * Bind events for Step 2 - Import existing data
     */
    bindImportEvents: function () {
      var self = this;
      var $fileInput = this.$modal.find('#cta-onboarding-import-file');
      var $wrapper = this.$modal.find('#cta-onboarding-file-wrapper');
      var $selected = this.$modal.find('#cta-onboarding-file-selected');
      var $fileName = this.$modal.find('#cta-onboarding-file-name');
      var $fileSize = this.$modal.find('#cta-onboarding-file-size');
      var $removeBtn = this.$modal.find('#cta-onboarding-file-remove');
      var $importActions = this.$modal.find('#cta-onboarding-import-actions');
      var $importBtn = this.$modal.find('#cta-onboarding-import-btn');
      var $status = this.$modal.find('#cta-onboarding-import-status');

      // File input change
      $fileInput.on('change', function () {
        var file = this.files[0];
        if (file) {
          self.selectedFile = file;
          $fileName.text(file.name);
          $fileSize.text(self.formatFileSize(file.size));
          $wrapper.hide();
          $selected.show();
          $importActions.show();
          $status.hide();
        }
      });

      // Remove file
      $removeBtn.on('click', function () {
        self.selectedFile = null;
        $fileInput.val('');
        $selected.hide();
        $wrapper.show();
        $importActions.hide();
        $status.hide();
      });

      // Import button click
      $importBtn.on('click', function () {
        if (!self.selectedFile) {
          return;
        }
        self.importFile();
      });

      // Drag and drop
      var $dropArea = this.$modal.find('#cta-onboarding-import-area');
      $dropArea.on('dragover', function (e) {
        e.preventDefault();
        $(this).addClass('drag-over');
      });
      $dropArea.on('dragleave drop', function (e) {
        e.preventDefault();
        $(this).removeClass('drag-over');
      });
      $dropArea.on('drop', function (e) {
        var files = e.originalEvent.dataTransfer.files;
        if (files.length) {
          $fileInput[0].files = files;
          $fileInput.trigger('change');
        }
      });
    },
    /**
     * Bind events for Step 3 - Demo data import
     */
    bindDemoEvents: function () {
      var self = this;
      var $demoBtn = this.$modal.find('#cta-onboarding-demo-btn');
      var $status = this.$modal.find('#cta-onboarding-demo-status');
      $demoBtn.on('click', function () {
        // Directly import demo data from bundled demo-data.json (all scopes)
        self.importDemoData($demoBtn, $status);
      });

      // Listen for import success to update onboarding UI
      $(document).on('ctaDemoDataImported', function (e, data) {
        self.handleDemoImportSuccess(data);
      });
    },
    /**
     * Handle successful demo data import from the import modal
     */
    handleDemoImportSuccess: function (data) {
      var self = this;
      var $status = this.$modal.find('#cta-onboarding-demo-status');

      // Mark demo data as imported and update button text
      this.step3DemoDataExists = true;
      this.updateButtonVisibility();

      // Hide the demo options and show success
      this.$modal.find('.cta-onboarding-demo-options').fadeOut(300, function () {
        var message = data && data.message ? data.message : 'Demo data has been imported.';
        var $successBox = $('<div class="cta-info-box cta-info-box--success">' + '<span class="cta-info-box__icon dashicons dashicons-yes-alt"></span>' + '<div><p class="cta-info-box__title">Demo Data Imported</p>' + '<p class="cta-info-box__body">' + message + '</p></div></div>');
        $(this).replaceWith($successBox);
      });

      // Auto-advance after short delay
      setTimeout(function () {
        self.goToStep(4);
      }, 2000);
    },
    /**
     * Import demo data directly using bundled demo-data.json
     */
    importDemoData: function ($btn, $status) {
      var self = this;
      if (typeof ctaAdminVars === 'undefined' || !ctaAdminVars.ajaxUrl) {
        console.warn('AJAX not available for demo import');
        return;
      }

      // Set loading state
      $btn.prop('disabled', true).addClass('cta-loading');
      $status.removeClass('status-success status-error').addClass('status-loading');
      $status.html('<span class="dashicons dashicons-update cta-spin"></span> ' + (ctaAdminVars.i18n?.importing || 'Importing demo data...')).show();
      $.ajax({
        url: ctaAdminVars.ajaxUrl,
        type: 'POST',
        dataType: 'json',
        data: {
          action: 'cta_import_demo_data_selective',
          nonce: ctaAdminVars.nonce || '',
          import_settings: 1,
          import_ctas: 1,
          import_analytics: 1,
          import_notifications: 1
        },
        success: function (res) {
          if (res.success) {
            // Notify any listeners and update onboarding UI
            $(document).trigger('ctaDemoDataImported', [res.data]);
          } else {
            var msg = res.data && res.data.message || res.message || 'Import failed. Please try again.';
            $status.removeClass('status-loading').addClass('status-error').html('<span class="dashicons dashicons-warning"></span> ' + msg).show();
          }
        },
        error: function (xhr, status, error) {
          $status.removeClass('status-loading').addClass('status-error').html('<span class="dashicons dashicons-warning"></span> ' + (error || 'Network error. Please try again.')).show();
        },
        complete: function () {
          $btn.prop('disabled', false).removeClass('cta-loading');
        }
      });
    },
    /**
     * Import file (Step 2)
     */
    importFile: function () {
      var self = this;
      var $status = this.$modal.find('#cta-onboarding-import-status');
      var $importBtn = this.$modal.find('#cta-onboarding-import-btn');
      if (!this.selectedFile) {
        return;
      }

      // Show loading state
      $status.removeClass('status-success status-error').addClass('status-loading');
      $status.html('<span class="dashicons dashicons-update cta-spin"></span> Importing...').show();
      $importBtn.prop('disabled', true);

      // Read file
      var reader = new FileReader();
      reader.onload = function (e) {
        try {
          var data = JSON.parse(e.target.result);

          // Validate it's CTA Manager data
          if (!data.plugin || data.plugin !== 'cta-manager') {
            $status.removeClass('status-loading').addClass('status-error');
            $status.html('<span class="dashicons dashicons-warning"></span> Invalid CTA Manager export file.');
            $importBtn.prop('disabled', false);
            return;
          }

          // Send to server
          self.sendImportData(data);
        } catch (err) {
          $status.removeClass('status-loading').addClass('status-error');
          $status.html('<span class="dashicons dashicons-warning"></span> Invalid JSON file format.');
          $importBtn.prop('disabled', false);
        }
      };
      reader.onerror = function () {
        $status.removeClass('status-loading').addClass('status-error');
        $status.html('<span class="dashicons dashicons-warning"></span> Error reading file.');
        $importBtn.prop('disabled', false);
      };
      reader.readAsText(this.selectedFile);
    },
    /**
     * Send import data to server
     */
    sendImportData: function (data) {
      var self = this;
      var $status = this.$modal.find('#cta-onboarding-import-status');
      var $importBtn = this.$modal.find('#cta-onboarding-import-btn');
      if (typeof ctaAdminVars === 'undefined' || !ctaAdminVars.ajaxUrl) {
        $status.removeClass('status-loading').addClass('status-error');
        $status.html('<span class="dashicons dashicons-warning"></span> AJAX not available.');
        $importBtn.prop('disabled', false);
        return;
      }

      // Get selective import toggles
      var importSettings = this.$modal.find('#onboarding-import-toggle-settings').is(':checked') ? 1 : 0;
      var importCtas = this.$modal.find('#onboarding-import-toggle-ctas').is(':checked') ? 1 : 0;
      var importAnalytics = this.$modal.find('#onboarding-import-toggle-analytics').is(':checked') ? 1 : 0;
      var importNotifications = this.$modal.find('#onboarding-import-toggle-notifications').is(':checked') ? 1 : 0;
      $.ajax({
        url: ctaAdminVars.ajaxUrl,
        type: 'POST',
        data: {
          action: 'cta_import_settings',
          nonce: ctaAdminVars.nonce || '',
          import_data: JSON.stringify(data),
          import_mode: 'replace',
          create_backup: false,
          import_settings: importSettings,
          import_ctas: importCtas,
          import_analytics: importAnalytics,
          import_notifications: importNotifications
        },
        success: function (response) {
          if (response.success) {
            $status.removeClass('status-loading').addClass('status-success');
            $status.html('<span class="dashicons dashicons-yes-alt"></span> ' + (response.data.message || 'Import successful!'));

            // Mark step 2 import as complete and update button text
            self.step2ImportComplete = true;
            self.updateButtonVisibility();

            // Auto-advance after short delay
            setTimeout(function () {
              self.goToStep(3);
            }, 1500);
          } else {
            $status.removeClass('status-loading').addClass('status-error');
            $status.html('<span class="dashicons dashicons-warning"></span> ' + (response.data.message || 'Import failed.'));
            $importBtn.prop('disabled', false);
          }
        },
        error: function () {
          $status.removeClass('status-loading').addClass('status-error');
          $status.html('<span class="dashicons dashicons-warning"></span> Server error. Please try again.');
          $importBtn.prop('disabled', false);
        }
      });
    },
    /**
     * Format file size for display
     */
    formatFileSize: function (bytes) {
      if (bytes === 0) return '0 Bytes';
      var k = 1024;
      var sizes = ['Bytes', 'KB', 'MB', 'GB'];
      var i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    },
    /**
     * Navigate to a specific step
     */
    goToStep: function (stepNumber) {
      if (stepNumber < 1 || stepNumber > this.totalSteps) {
        return;
      }

      // Hide current step
      this.$steps.removeClass('cta-step-active').hide();

      // Show target step
      var $targetStep = this.$modal.find('.cta-step-' + stepNumber);
      $targetStep.addClass('cta-step-active').fadeIn(300);

      // Update current step
      this.currentStep = stepNumber;

      // Update breadcrumb
      this.updateBreadcrumb();

      // Update button visibility
      this.updateButtonVisibility();
    },
    /**
     * Update breadcrumb indicator
     */
    updateBreadcrumb: function () {
      var self = this;
      this.$breadcrumb.find('.cta-breadcrumb-step').each(function () {
        var $step = $(this);
        var stepNumber = parseInt($step.data('step'), 10);

        // Remove all state classes
        $step.removeClass('cta-breadcrumb-step-active cta-breadcrumb-step-completed');
        if (stepNumber === self.currentStep) {
          // Current step - active state
          $step.addClass('cta-breadcrumb-step-active');
        } else if (stepNumber < self.currentStep) {
          // Previous steps - completed state
          $step.addClass('cta-breadcrumb-step-completed');
        }
        // Future steps have no special class (default/faded state)
      });
    },
    /**
     * Update button visibility based on current step
     */
    updateButtonVisibility: function () {
      // Show/hide previous button
      if (this.currentStep === 1) {
        this.$prevBtn.hide();
      } else {
        this.$prevBtn.show();
      }

      // Show/hide next/finish buttons
      if (this.currentStep === this.totalSteps) {
        this.$nextBtn.hide();
        this.$finishBtn.show();
      } else {
        this.$nextBtn.show();
        this.$finishBtn.hide();
      }

      // Show/hide Maybe Later (only on step 1, styled like Back)
      if (this.$maybeLater && this.$maybeLater.length) {
        if (this.currentStep === 1) {
          this.$maybeLater.show();
        } else {
          this.$maybeLater.hide();
        }
      }

      // Update Next button text for step 2 and step 3
      if (this.currentStep === 2) {
        if (this.step2ImportComplete) {
          this.$nextBtn.text(ctaAdminVars.i18n?.next || 'Next');
        } else {
          this.$nextBtn.text(ctaAdminVars.i18n?.skip || 'Skip');
        }
      } else if (this.currentStep === 3) {
        if (this.step3DemoDataExists) {
          this.$nextBtn.text(ctaAdminVars.i18n?.next || 'Next');
        } else {
          this.$nextBtn.text(ctaAdminVars.i18n?.skip || 'Skip');
        }
      } else {
        this.$nextBtn.text(ctaAdminVars.i18n?.next || 'Next');
      }
    },
    /**
     * Update overall step display
     */
    updateStepDisplay: function () {
      this.updateBreadcrumb();
      this.updateButtonVisibility();
    },
    /**
     * Finish the onboarding wizard
     */
    finish: function () {
      // Close the modal
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close(this.$modal);
      } else {
        this.$modal.fadeOut(150, function () {
          if (!$('.cta-modal:visible').length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }

      // Mark onboarding as completed
      this.markOnboardingComplete();
    },
    /**
     * Skip the onboarding wizard
     */
    skip: function () {
      this.finish();
    },
    /**
     * Open Docs modal after closing onboarding modal
     */
    openDocsModal: function () {
      var self = this;
      var $docsModal = $('#cta-docs-modal');

      // Close onboarding first
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close(this.$modal);
      } else {
        this.$modal.fadeOut(150, function () {
          if (!$('.cta-modal:visible').length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }

      // Open docs modal shortly after close
      setTimeout(function () {
        if ($docsModal.length) {
          if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
            window.ctaModalAPI.open($docsModal);
          } else {
            $docsModal.fadeIn(150);
            $('body').addClass('cta-modal-open');
          }
        } else {
          console.warn('Docs modal not found');
        }
      }, 180);
    },
    /**
     * Open Support modal after closing onboarding modal
     */
    openSupportModal: function () {
      var $supportModal = $('#cta-new-ticket-modal');
      if (!$supportModal.length) {
        console.warn('Support modal not found');
        return;
      }

      // Open support modal first
      if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
        window.ctaModalAPI.open($supportModal);
      } else {
        $supportModal.fadeIn(150);
        $('body').addClass('cta-modal-open');
      }

      // Then close onboarding (body lock remains because another modal is open)
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close(this.$modal);
      } else {
        this.$modal.fadeOut(150);
      }
    },
    /**
     * Mark onboarding as completed (AJAX call to save state)
     */
    markOnboardingComplete: function () {
      if (typeof ctaAdminVars === 'undefined' || !ctaAdminVars.ajaxUrl) {
        return;
      }
      $.ajax({
        url: ctaAdminVars.ajaxUrl,
        type: 'POST',
        data: {
          action: 'cta_complete_onboarding',
          nonce: ctaAdminVars.nonce || ''
        },
        success: function (response) {
          if (response.success) {
            console.log('Onboarding completed successfully');
          }
        },
        error: function () {
          console.warn('Failed to mark onboarding as complete');
        }
      });
    }
  };

  /**
   * Initialize on document ready
   */
  $(function () {
    CTAOnboarding.init();

    // Re-initialize when modal is opened (in case it wasn't loaded on page load)
    $(document).on('click', '.cta-help-trigger[data-target="#cta-dashboard-help-modal"]', function () {
      setTimeout(function () {
        if (!CTAOnboarding.$modal || !CTAOnboarding.$modal.length) {
          CTAOnboarding.init();
        }
      }, 100);
    });
  });
})(window.jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTAOnboarding);

/***/ }),

/***/ "./assets/js/admin/modules/modals/preview-modal.js":
/*!*********************************************************!*\
  !*** ./assets/js/admin/modules/modals/preview-modal.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
(function ($) {
  'use strict';

  let docShowHandlerBound = false;
  let addToggleBound = false;
  function initCtaFormPreview($form) {
    if (!$form || !$form.length || $form.data('ctaPreviewReady')) {
      return;
    }
    $form.data('ctaPreviewReady', true);

    // Try multiple ways to find the container
    let $container = $form.closest('#cta-cta-section, .cta-section');
    if (!$container.length) {
      // Fallback: if form is in a modal, look in the modal container
      $container = $form.closest('.cta-global-form-container, .cta-global-form-modal');
      if (!$container.length) {
        // Last fallback: use the form's parent
        $container = $form.parent();
      }
    }
    const $previewCard = $container.find('#cta-live-preview .cta-preview-card').first();
    const $typeIndicator = $container.find('#cta-preview-type-indicator .cta-preview-type-label').first();
    const titleEl = $previewCard.find('.cta-preview-title');
    const taglineEl = $previewCard.find('.cta-preview-tagline');
    const bodyEl = $previewCard.find('.cta-preview-body');
    const btnEl = $previewCard.find('.cta-preview-button');
    const btnLabel = $previewCard.find('.cta-preview-label');
    const iconEl = $previewCard.find('.cta-preview-icon-wrapper');

    // Type labels mapping
    const typeLabels = {
      'phone': 'Phone Call',
      'email': 'Email',
      'link': 'Link',
      'popup': 'Popup',
      'slide-in': 'Slide-in'
    };
    const formWrapper = $container.find('#cta-form-wrapper').first();
    const formSection = $container.is('#cta-cta-section') ? $container : $container.find('#cta-cta-section').first();
    const addToggle = $('#cta-add-new-toggle');
    const isGlobalModal = $form.closest('.cta-global-form-modal').length > 0;
    const typeSelect = $form.find('#cta-type');
    const layoutSelect = $form.find('#cta-layout');
    const emailField = $form.find('#cta-email-to').closest('.cta-form-group');
    const linkField = $form.find('#cta-link-url').closest('.cta-form-group');
    const phoneField = $form.find('#phone-number').closest('.cta-form-group');
    const proNumberSelect = $container.find('#pro-number-select').first();
    const buttonTextField = $form.find('#button-text');
    const blacklistModal = $container.find('#cta-blacklist-modal').first();
    const blacklistRows = $container.find('#cta-blacklist-rows').first();
    const blacklistHiddenContainer = $container.find('#cta-blacklist-hidden-container').first();
    const blacklistCount = $container.find('#cta-blacklist-count').first();
    const openBlacklistBtn = $container.find('#cta-open-blacklist-modal').first();
    const addBlacklistBtn = $container.find('#cta-add-blacklist-row').first();
    let blacklistValues = [];
    function setRequired($el, isRequired) {
      if (!$el || !$el.length) return;
      if (isRequired) {
        $el.attr('required', 'required');
      } else {
        $el.removeAttr('required');
      }
    }
    function toggleFields() {
      const type = typeSelect.val();
      emailField.hide();
      linkField.hide();
      phoneField.hide();
      setRequired(emailField.find('input'), false);
      setRequired(linkField.find('input'), false);
      setRequired(phoneField.find('input'), false);
      switch (type) {
        case 'email':
          emailField.show();
          setRequired(emailField.find('input'), true);
          break;
        case 'link':
          linkField.show();
          setRequired(linkField.find('input[type="url"]'), true);
          break;
        case 'popup':
          break;
        // popup does not need a target field
        default:
          phoneField.show();
          setRequired(phoneField.find('input'), true);
          break;
      }
      setRequired(buttonTextField, true);
    }

    /**
     * Check if all required fields have values
     */
    function checkRequiredFields() {
      const type = typeSelect.val() || 'phone';
      const name = $form.find('#cta-name').val() || '';
      const buttonText = $form.find('#button-text').val() || '';

      // Name and button text are always required
      if (!name.trim() || !buttonText.trim()) {
        return false;
      }

      // Check type-specific required field
      switch (type) {
        case 'email':
          const email = $form.find('#cta-email-to').val() || '';
          if (!email.trim()) return false;
          break;
        case 'link':
          const url = $form.find('#cta-link-url').val() || '';
          if (!url.trim()) return false;
          break;
        case 'popup':
          // Popup doesn't need a target
          break;
        case 'slide-in':
          // Slide-in may have additional requirements - for now just name/button
          break;
        default:
          // phone
          const phone = $form.find('#phone-number').val() || '';
          if (!phone.trim()) return false;
          break;
      }
      return true;
    }

    /**
     * Get missing required fields for hint display
     */
    function getMissingFields() {
      const missing = [];
      const type = typeSelect.val() || 'phone';
      const name = $form.find('#cta-name').val() || '';
      const buttonText = $form.find('#button-text').val() || '';
      if (!name.trim()) missing.push('Name');
      if (!buttonText.trim()) missing.push('Button Text');
      switch (type) {
        case 'email':
          const email = $form.find('#cta-email-to').val() || '';
          if (!email.trim()) missing.push('Email Address');
          break;
        case 'link':
          const url = $form.find('#cta-link-url').val() || '';
          if (!url.trim()) missing.push('Link URL');
          break;
        case 'popup':
          break;
        default:
          // phone
          const phone = $form.find('#phone-number').val() || '';
          if (!phone.trim()) missing.push('Phone Number');
          break;
      }
      return missing;
    }
    function updatePreview() {
      if (!$previewCard.length) {
        return;
      }
      toggleFields();

      // Update type indicator text
      const currentType = typeSelect.val() || 'phone';
      if ($typeIndicator.length) {
        $typeIndicator.text(typeLabels[currentType] || 'Phone Call');
      }
      const $previewContainer = $previewCard.closest('.cta-live-preview');
      const allFieldsValid = checkRequiredFields();

      // Show/hide placeholder state
      if (!allFieldsValid) {
        const missing = getMissingFields();
        $previewCard.addClass('is-placeholder');
        $previewContainer.addClass('has-placeholder');

        // Update or create placeholder message
        let $placeholder = $previewContainer.find('.cta-preview-placeholder');
        if (!$placeholder.length) {
          $placeholder = $('<div class="cta-preview-placeholder"></div>');
          $previewContainer.append($placeholder);
        }
        $placeholder.html('<span class="dashicons dashicons-visibility"></span>' + '<span class="cta-preview-placeholder-title">Preview will appear here</span>' + '<span class="cta-preview-placeholder-hint">Complete required fields: ' + missing.join(', ') + '</span>');
        $placeholder.show();
        $previewCard.hide();
        return;
      }

      // Hide placeholder, show preview
      $previewCard.removeClass('is-placeholder').show();
      $previewContainer.removeClass('has-placeholder');
      $previewContainer.find('.cta-preview-placeholder').hide();
      const title = $form.find('#cta-title').val() || '';
      const tagline = $form.find('#cta-tagline').val() || '';
      const body = $form.find('#cta-body-text').val() || '';
      const btn = $form.find('#button-text').val() || 'Call Now';
      const layout = layoutSelect.val() || 'button';
      const iconValue = $form.find('#cta-icon').val() || 'none';
      const showIcon = iconValue !== 'none';
      titleEl.text(title);
      taglineEl.text(tagline);
      bodyEl.text(body);
      btnLabel.text(btn);
      iconEl.toggle(showIcon);

      // Apply text formatting from format modal
      applyTextFormatting();

      // Make button functional based on type
      updateButtonAction();

      // Apply button styles from form configuration
      applyButtonStyles();
      $previewCard.removeClass(function (index, className) {
        return (className.match(/(^|\s)layout-\S+/g) || []).join(' ');
      }).addClass('layout-' + layout);
    }

    /**
     * Apply inline styles to preview button from form configuration
     */
    function applyButtonStyles() {
      if (!btnEl.length) return;

      // Get background settings
      const backgroundType = $form.find('#cta-background-type').val() || 'solid';
      const buttonColor = $form.find('#cta-color').val() || '#667eea';
      const gradientStart = $form.find('#cta-gradient-start').val() || '#667eea';
      const gradientEnd = $form.find('#cta-gradient-end').val() || '#764ba2';
      const gradientAngle = $form.find('#cta-gradient-angle').val() || '90';

      // Build background style
      let background, backgroundColor;
      if (backgroundType === 'transparent') {
        background = 'transparent';
        backgroundColor = 'transparent';
      } else if (backgroundType === 'gradient') {
        background = 'linear-gradient(' + gradientAngle + 'deg, ' + gradientStart + ', ' + gradientEnd + ')';
        backgroundColor = gradientStart; // Fallback
      } else {
        background = buttonColor;
        backgroundColor = buttonColor;
      }

      // Get border settings (using individual side fields)
      const borderStyle = $form.find('#cta-border-style').val() || 'none';
      const borderColor = $form.find('#cta-border-color').val() || '#667eea';

      // Get border width values (use top as default for shorthand, or build full border)
      const borderWidthTop = $form.find('#cta-border-width-top').val() || '2px';
      const borderWidthRight = $form.find('#cta-border-width-right').val() || '2px';
      const borderWidthBottom = $form.find('#cta-border-width-bottom').val() || '2px';
      const borderWidthLeft = $form.find('#cta-border-width-left').val() || '2px';

      // Get border radius values
      const borderRadiusTL = $form.find('#cta-border-radius-top-left').val() || '8px';
      const borderRadiusTR = $form.find('#cta-border-radius-top-right').val() || '8px';
      const borderRadiusBR = $form.find('#cta-border-radius-bottom-right').val() || '8px';
      const borderRadiusBL = $form.find('#cta-border-radius-bottom-left').val() || '8px';
      const borderRadius = borderRadiusTL + ' ' + borderRadiusTR + ' ' + borderRadiusBR + ' ' + borderRadiusBL;

      // Build border CSS using individual widths
      let borderTop = 'none',
        borderRight = 'none',
        borderBottom = 'none',
        borderLeft = 'none';
      if (borderStyle !== 'none') {
        borderTop = borderWidthTop + ' ' + borderStyle + ' ' + borderColor;
        borderRight = borderWidthRight + ' ' + borderStyle + ' ' + borderColor;
        borderBottom = borderWidthBottom + ' ' + borderStyle + ' ' + borderColor;
        borderLeft = borderWidthLeft + ' ' + borderStyle + ' ' + borderColor;
      }

      // Get padding settings (always enabled now)
      const paddingTop = $form.find('#cta-padding-top').val() || '12px';
      const paddingRight = $form.find('#cta-padding-right').val() || '24px';
      const paddingBottom = $form.find('#cta-padding-bottom').val() || '12px';
      const paddingLeft = $form.find('#cta-padding-left').val() || '24px';
      const padding = paddingTop + ' ' + paddingRight + ' ' + paddingBottom + ' ' + paddingLeft;

      // Apply inline styles - these override the unstyled class defaults
      // Note: We don't set color here - that's handled by applyTextFormatting()
      // We also don't set font-weight and font-size - those come from text formatting
      btnEl.css({
        'background': background,
        'background-color': backgroundColor,
        'border-top': borderTop,
        'border-right': borderRight,
        'border-bottom': borderBottom,
        'border-left': borderLeft,
        'border-radius': borderRadius,
        'padding': padding
      });
    }

    /**
    * Apply text formatting from format modal to preview elements
    */
    function applyTextFormatting() {
      // Title formatting
      var titleFontSize = $form.find('#cta_title_font_size').val();
      var titleFontFamily = $form.find('#cta_title_font_family').val();
      var titleFontWeight = $form.find('#cta_title_font_weight').val();
      var titleColor = $form.find('#cta_title_color').val();
      var titleAlignment = $form.find('#cta_title_alignment').val();
      if (titleEl.length) {
        var titleStyles = {};
        if (titleFontSize) titleStyles['font-size'] = titleFontSize;
        if (titleFontFamily && titleFontFamily !== 'inherit') titleStyles['font-family'] = titleFontFamily;
        if (titleFontWeight) titleStyles['font-weight'] = titleFontWeight;
        if (titleColor) {
          // Handle gradient colors
          if (titleColor.indexOf('gradient') !== -1) {
            titleStyles['background'] = titleColor;
            titleStyles['background-clip'] = 'text';
            titleStyles['-webkit-background-clip'] = 'text';
            titleStyles['-webkit-text-fill-color'] = 'transparent';
            titleStyles['color'] = 'transparent';
          } else {
            titleStyles['color'] = titleColor;
          }
        }
        if (titleAlignment) titleStyles['text-align'] = titleAlignment;
        titleEl.css(titleStyles);
      }

      // Tagline formatting
      var taglineFontSize = $form.find('#cta_tagline_font_size').val();
      var taglineFontFamily = $form.find('#cta_tagline_font_family').val();
      var taglineFontWeight = $form.find('#cta_tagline_font_weight').val();
      var taglineColor = $form.find('#cta_tagline_color').val();
      var taglineAlignment = $form.find('#cta_tagline_alignment').val();
      if (taglineEl.length) {
        var taglineStyles = {};
        if (taglineFontSize) taglineStyles['font-size'] = taglineFontSize;
        if (taglineFontFamily && taglineFontFamily !== 'inherit') taglineStyles['font-family'] = taglineFontFamily;
        if (taglineFontWeight) taglineStyles['font-weight'] = taglineFontWeight;
        if (taglineColor) {
          if (taglineColor.indexOf('gradient') !== -1) {
            taglineStyles['background'] = taglineColor;
            taglineStyles['background-clip'] = 'text';
            taglineStyles['-webkit-background-clip'] = 'text';
            taglineStyles['-webkit-text-fill-color'] = 'transparent';
            taglineStyles['color'] = 'transparent';
          } else {
            taglineStyles['color'] = taglineColor;
          }
        }
        if (taglineAlignment) taglineStyles['text-align'] = taglineAlignment;
        taglineEl.css(taglineStyles);
      }

      // Body formatting
      var bodyFontSize = $form.find('#cta_body_font_size').val();
      var bodyFontFamily = $form.find('#cta_body_font_family').val();
      var bodyFontWeight = $form.find('#cta_body_font_weight').val();
      var bodyColor = $form.find('#cta_body_color').val();
      var bodyAlignment = $form.find('#cta_body_alignment').val();
      if (bodyEl.length) {
        var bodyStyles = {};
        if (bodyFontSize) bodyStyles['font-size'] = bodyFontSize;
        if (bodyFontFamily && bodyFontFamily !== 'inherit') bodyStyles['font-family'] = bodyFontFamily;
        if (bodyFontWeight) bodyStyles['font-weight'] = bodyFontWeight;
        if (bodyColor) {
          if (bodyColor.indexOf('gradient') !== -1) {
            bodyStyles['background'] = bodyColor;
            bodyStyles['background-clip'] = 'text';
            bodyStyles['-webkit-background-clip'] = 'text';
            bodyStyles['-webkit-text-fill-color'] = 'transparent';
            bodyStyles['color'] = 'transparent';
          } else {
            bodyStyles['color'] = bodyColor;
          }
        }
        if (bodyAlignment) bodyStyles['text-align'] = bodyAlignment;
        bodyEl.css(bodyStyles);
      }

      // Button text formatting (with defaults)
      var btnFontSize = $form.find('#button_text_font_size').val() || '16px';
      var btnFontFamily = $form.find('#button_text_font_family').val() || 'inherit';
      var btnFontWeight = $form.find('#button_text_font_weight').val() || '600';
      var btnColor = $form.find('#button_text_color').val() || '#ffffff';
      var btnAlignment = $form.find('#button_text_alignment').val() || 'center';
      var buttonAlignment = $form.find('#button_alignment').val() || 'center';
      var buttonWidth = $form.find('#button_width').val() || 'auto';

      // Apply text alignment to button container using justify-content (for flex)
      // text-align doesn't work on inline spans, so we use flex alignment
      if (btnEl.length) {
        var alignmentMap = {
          'left': 'flex-start',
          'center': 'center',
          'right': 'flex-end'
        };
        var justifyContent = alignmentMap[btnAlignment] || 'center';
        btnEl.css('justify-content', justifyContent);

        // Button width and alignment
        var buttonWidthValue = buttonWidth === 'full' ? '100%' : 'fit-content';
        var buttonStyles = {
          'display': 'flex',
          'width': buttonWidthValue
        };
        if (buttonWidth !== 'full') {
          buttonStyles['margin-left'] = buttonAlignment === 'left' ? '0' : 'auto';
          buttonStyles['margin-right'] = buttonAlignment === 'right' ? '0' : 'auto';
        } else {
          buttonStyles['margin-left'] = '0';
          buttonStyles['margin-right'] = '0';
        }
        btnEl.css(buttonStyles);
      }
      if (btnLabel.length) {
        var btnStyles = {
          'font-size': btnFontSize,
          'font-weight': btnFontWeight
        };
        if (btnFontFamily && btnFontFamily !== 'inherit') {
          btnStyles['font-family'] = btnFontFamily;
        }

        // Apply color (gradient or solid)
        if (btnColor.indexOf('gradient') !== -1) {
          btnStyles['background'] = btnColor;
          btnStyles['background-clip'] = 'text';
          btnStyles['-webkit-background-clip'] = 'text';
          btnStyles['-webkit-text-fill-color'] = 'transparent';
          btnStyles['color'] = 'transparent';
        } else {
          btnStyles['color'] = btnColor;
        }
        btnLabel.css(btnStyles);
      }
    }

    /**
     * Update button action based on CTA type
     */
    function updateButtonAction() {
      if (!btnEl.length) return;
      const type = typeSelect.val() || 'phone';
      let href = '#';
      let target = '_self';
      switch (type) {
        case 'phone':
          const phone = $form.find('#phone-number').val() || '';
          if (phone.trim()) {
            // Remove any non-digit characters for tel: link
            const cleanPhone = phone.replace(/[^\d+]/g, '');
            href = 'tel:' + cleanPhone;
          }
          break;
        case 'email':
          const email = $form.find('#cta-email-to').val() || '';
          if (email.trim()) {
            href = 'mailto:' + email.trim();
          }
          break;
        case 'link':
          const url = $form.find('#cta-link-url').val() || '';
          if (url.trim()) {
            href = url.trim();
          }
          // Check if new tab is enabled
          const newTab = $form.find('#cta-link-target-new-tab').is(':checked');
          target = newTab ? '_blank' : '_self';
          break;
        case 'popup':
        case 'slide-in':
          // These don't need functional links in preview
          href = '#';
          break;
      }

      // Update button attributes
      btnEl.attr('href', href);
      btnEl.attr('target', target);

      // Remove onclick handler if href is functional, add it back if not
      if (href !== '#' && type !== 'popup' && type !== 'slide-in') {
        btnEl.removeAttr('onclick');
      } else {
        btnEl.attr('onclick', 'return false;');
      }
    }
    $form.on('input change', 'input, textarea, select', updatePreview);
    $form.on('click', '.cta-button-alignment-btn', function (e) {
      e.preventDefault();
      var $btn = $(this);
      var $widthSelect = $form.find('#button_width');

      // Don't allow alignment change if full width is selected
      if ($widthSelect.val() === 'full') {
        return;
      }
      var align = $btn.data('align') || 'center';
      $btn.closest('.cta-button-alignment-buttons').find('.cta-button-alignment-btn').removeClass('active');
      $btn.addClass('active');
      $form.find('#button_alignment').val(align).trigger('change');
      updatePreview();
    });

    // Handle button width changes - force center alignment when full width is selected
    function handleButtonWidthChange() {
      var $widthSelect = $form.find('#button_width');
      var $alignmentBtns = $form.find('.cta-button-alignment-btn');
      var $alignmentInput = $form.find('#button_alignment');
      if ($widthSelect.val() === 'full') {
        // Disable alignment buttons and force center
        $alignmentBtns.addClass('disabled').prop('disabled', true);
        $alignmentBtns.removeClass('active');
        $alignmentBtns.filter('[data-align="center"]').addClass('active');
        $alignmentInput.val('center');
      } else {
        // Re-enable alignment buttons
        $alignmentBtns.removeClass('disabled').prop('disabled', false);
      }
      updatePreview();
    }

    // Listen for button width changes
    $form.on('change', '#button_width', handleButtonWidthChange);

    // Initialize on form load
    handleButtonWidthChange();

    // Ensure format modal changes update the live preview immediately
    $(document).on('ctaFormatApplied', function () {
      updatePreview();
    });
    if (proNumberSelect.length) {
      proNumberSelect.on('change', function () {
        const val = $(this).val();
        if (val) {
          phoneField.find('input').val(val).trigger('input');
        }
      });
    }
    function showForm() {
      if (!formWrapper.length) return;
      if (formSection.length && formSection.is(':hidden')) {
        formSection.slideDown(150);
      }
      formWrapper.slideDown(150, function () {
        $form.find('#cta-name').trigger('focus');
      });
    }
    if (addToggle.length && !isGlobalModal && !addToggleBound) {
      addToggle.on('click', function (e) {
        e.preventDefault();
        showForm();
      });
      addToggleBound = true;
    }
    if (!docShowHandlerBound && !isGlobalModal) {
      $(document).on('click', 'a[href="#cta-cta-form"]', function (e) {
        if (!formWrapper.length) return;
        if (formWrapper.is(':hidden')) {
          e.preventDefault();
          showForm();
        }
      });
      docShowHandlerBound = true;
    }
    function loadBlacklistFromInputs() {
      if (!blacklistHiddenContainer.length) return;
      blacklistValues = [];
      blacklistHiddenContainer.find('input[name="cta_blacklist_urls[]"]').each(function () {
        const val = ($(this).val() || '').trim();
        if (val) {
          blacklistValues.push(val);
        }
      });
    }
    function renderBlacklistRows() {
      if (!blacklistRows.length) return;
      blacklistRows.empty();
      if (!blacklistValues.length) {
        blacklistValues.push('');
      }
      blacklistValues.forEach((val, index) => {
        const row = $('<div class="cta-blacklist-row"></div>');
        const input = $('<input type="text" class="regular-text">').val(val);
        const removeBtn = $('<button type="button" class="cta-button-link"></button>').text('Remove');
        removeBtn.on('click', function () {
          blacklistValues.splice(index, 1);
          renderBlacklistRows();
        });
        row.append(input, removeBtn);
        blacklistRows.append(row);
      });
    }
    function syncBlacklistFromModal() {
      if (!blacklistRows.length) return;
      const values = [];
      blacklistRows.find('input[type="text"]').each(function () {
        const val = ($(this).val() || '').trim();
        if (val) {
          values.push(val);
        }
      });
      blacklistValues = values;
    }
    function updateBlacklistCount() {
      if (blacklistCount.length) {
        blacklistCount.text(blacklistValues.length);
      }
    }
    function syncBlacklistHiddenInputs() {
      if (!blacklistHiddenContainer.length) return;
      blacklistHiddenContainer.empty();
      blacklistValues.forEach(val => {
        $('<input>', {
          type: 'hidden',
          name: 'cta_blacklist_urls[]',
          value: val
        }).appendTo(blacklistHiddenContainer);
      });
      updateBlacklistCount();
    }
    function openBlacklistModal() {
      loadBlacklistFromInputs();
      renderBlacklistRows();
      if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
        window.ctaModalAPI.open(blacklistModal);
      } else {
        blacklistModal.fadeIn(120);
        $('body').addClass('cta-modal-open');
      }
    }
    function closeBlacklistModal() {
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close(blacklistModal);
      } else {
        blacklistModal.fadeOut(120, function () {
          if (!$('.cta-modal:visible').not(blacklistModal).length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }
    }
    if (openBlacklistBtn.length && blacklistModal.length) {
      openBlacklistBtn.on('click', function () {
        openBlacklistModal();
      });
      blacklistModal.on('click', '.cta-modal-close, .cta-modal-overlay, [data-action="cancel"]', function () {
        closeBlacklistModal();
      });
      blacklistModal.on('click', '[data-action="save"]', function () {
        syncBlacklistFromModal();
        syncBlacklistHiddenInputs();
        closeBlacklistModal();
      });
      if (addBlacklistBtn.length) {
        addBlacklistBtn.on('click', function () {
          blacklistValues.push('');
          renderBlacklistRows();
          const lastInput = blacklistRows.find('input[type="text"]').last();
          if (lastInput.length) {
            lastInput.trigger('focus');
          }
        });
      }
      loadBlacklistFromInputs();
      updateBlacklistCount();
    }
    updatePreview();
  }
  $('.cta-cta-form').each(function () {
    initCtaFormPreview($(this));
  });
  $(document).on('ctc:initCtaForm', function (e, form) {
    initCtaFormPreview($(form));
  });
})(jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/admin/modules/modals/pro-upsell-modal.js":
/*!************************************************************!*\
  !*** ./assets/js/admin/modules/modals/pro-upsell-modal.js ***!
  \************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager Pro Upsell
 *
 * Handles upgrade button clicks and Pro upgrade modal functionality
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function ($) {
  'use strict';

  // Ensure CTCAdmin namespace exists
  window.CTCAdmin = window.CTCAdmin || {};

  /**
   * Show Pro upgrade modal
   */
  CTCAdmin.showProUpgradeModal = function () {
    var $modal = $('#cta-pro-upgrade-modal');
    if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
      window.ctaModalAPI.open($modal);
    } else {
      $modal.fadeIn(300);
      $('body').addClass('cta-modal-open');
    }
  };

  /**
   * Close Pro upgrade modal
   */
  CTCAdmin.closeProUpgradeModal = function () {
    var $modal = $('#cta-pro-upgrade-modal');
    if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
      window.ctaModalAPI.close($modal);
    } else {
      $modal.fadeOut(300, function () {
        if (!$('.cta-modal:visible').not($modal).length) {
          $('body').removeClass('cta-modal-open');
        }
      });
    }
  };

  /**
   * Close notifications panel if open
   */
  CTCAdmin.closeNotificationsPanel = function () {
    if (window.CTANotificationsManager && window.CTANotificationsManager.isOpen) {
      window.CTANotificationsManager.closePanel();
    }
  };

  /**
   * Handle Add API Key button click
   * Scrolls to and focuses the API key input field
   */
  CTCAdmin.handleAddApiKeyClick = function (e, $button) {
    e.preventDefault();
    var scrollToElement = $button.attr('data-scroll-to');
    var focusFieldName = $button.attr('data-focus-field');
    var settingsPageUrl = $button.attr('href');
    var currentUrl = window.location.href;

    // Check if we're already on the settings page
    var isOnSettingsPage = currentUrl.includes('page=cta-manager-settings');
    if (isOnSettingsPage && scrollToElement) {
      // Close notifications panel if open
      CTCAdmin.closeNotificationsPanel();

      // Already on settings page - just scroll and focus immediately
      CTCAdmin.scrollAndFocusField(scrollToElement, focusFieldName);
    } else {
      // Navigate to settings page - hash will be handled on page load
      window.location.href = settingsPageUrl;
    }
  };

  /**
   * Scroll to element and focus input field with smooth animation
   */
  CTCAdmin.scrollAndFocusField = function (scrollToElement, focusFieldName) {
    if (!scrollToElement) return;
    var $target = $('#' + scrollToElement);
    if (!$target.length) return;
    var paddingTop = 150;
    var paddingBottom = 32;
    var offsetTop = $target.offset().top;
    var viewportHeight = window.innerHeight || document.documentElement.clientHeight;
    var initialTop = Math.max(offsetTop - paddingTop, 0);
    var minTopForBottom = Math.max(offsetTop + $target.outerHeight(true) + paddingBottom - viewportHeight, 0);
    var targetOffset = Math.max(initialTop, minTopForBottom);

    // Smooth scroll without bounce using CSS scroll-behavior
    $('html').css('scroll-behavior', 'smooth');
    window.scrollTo({
      top: targetOffset,
      behavior: 'smooth'
    });

    // Focus the input field after scroll completes
    if (focusFieldName) {
      var $focusField = $('[name="' + focusFieldName + '"]');
      if (!$focusField.length) {
        // Fallback: try by ID
        $focusField = $('#' + scrollToElement);
      }
      if ($focusField.length) {
        // Wait for smooth scroll to complete (approx 400ms)
        setTimeout(function () {
          $focusField.focus().select();

          // Add a subtle highlight
          $focusField.addClass('cta-field-highlight');
          setTimeout(function () {
            $focusField.removeClass('cta-field-highlight');
          }, 2000);
        }, 400);
      }
    }
  };

  // Initialize on document ready
  $(function () {
    // Handle Add API Key button clicks
    $(document).on('click', '.cta-add-api-key-button', function (e) {
      CTCAdmin.handleAddApiKeyClick(e, $(this));
    });

    // Open upgrade modal from any upgrade trigger
    $(document).on('click', '.cta-upgrade-button, .cta-pro-cta-button, .cta-topbar-upgrade, .cta-upgrade-link-inline', function (e) {
      // Don't show modal for API key button
      if ($(this).hasClass('cta-add-api-key-button')) {
        return;
      }
      if ($(this).closest('#cta-pro-upgrade-modal').length) {
        return; // allow modal primary action to proceed to URL
      }
      e.preventDefault();
      CTCAdmin.showProUpgradeModal();
    });

    // Modal close handlers - ONLY for pro-upgrade modal
    $(document).on('click', '#cta-pro-upgrade-modal .cta-modal-close, #cta-pro-upgrade-modal [data-close-modal], #cta-pro-upgrade-modal .cta-modal-overlay', function (e) {
      e.preventDefault();
      CTCAdmin.closeProUpgradeModal();
    });

    // Close modal on ESC key - ONLY if pro-upgrade modal is visible
    $(document).on('keydown', function (e) {
      if (e.key === 'Escape' && $('#cta-pro-upgrade-modal').is(':visible')) {
        CTCAdmin.closeProUpgradeModal();
      }
    });

    // If we navigated here via hash, scroll and focus immediately
    if (window.location.hash) {
      var hashElement = window.location.hash.substring(1);
      var $hashTarget = $('#' + hashElement);
      if ($hashTarget.length) {
        // Use requestAnimationFrame for immediate execution after render
        requestAnimationFrame(function () {
          var paddingTop = 150;
          var paddingBottom = 32;
          var offsetTop = $hashTarget.offset().top;
          var viewportHeight = window.innerHeight || document.documentElement.clientHeight;
          var initialTop = Math.max(offsetTop - paddingTop, 0);
          var minTopForBottom = Math.max(offsetTop + $hashTarget.outerHeight(true) + paddingBottom - viewportHeight, 0);
          var targetOffset = Math.max(initialTop, minTopForBottom);

          // Instant scroll to position first (no animation on page load)
          window.scrollTo(0, targetOffset);

          // Find and focus the license key input field
          var $input = $hashTarget.find('input[type="text"]').first();

          // If no input found in target, try by ID
          if (!$input.length) {
            $input = $('#' + hashElement);
          }

          // Focus the input field immediately
          if ($input.length) {
            $input.focus().select();

            // Add a visual highlight
            $input.addClass('cta-field-highlight');
            setTimeout(function () {
              $input.removeClass('cta-field-highlight');
            }, 2000);
          }
        });
      }
    }
  });
})(jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTCAdmin);

/***/ }),

/***/ "./assets/js/admin/modules/pages/dashboard.js":
/*!****************************************************!*\
  !*** ./assets/js/admin/modules/pages/dashboard.js ***!
  \****************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Admin Utilities
 *
 * Provides general admin utilities, form handling, save functionality,
 * and common helper methods for the admin interface.
 */

(function ($) {
  if (typeof $ !== 'function' || !$.fn) {
    return;
  }
  'use strict';

  /**
   * Main CTA Admin Object
   */
  window.CTCAdmin = window.CTCAdmin || {};
  CTCAdmin.init = function () {
    if (typeof ctaAdminVars === 'undefined') {
      console.error('CTC Admin: Missing localization variables');
      return;
    }
    this.cacheSelectors();
    this.bindEvents();
    this.initTabs();
    this.initTooltips();
    this.initColorPickers();
    this.initPerformanceTable();
  };

  /**
   * Cache frequently used selectors
   */
  CTCAdmin.cacheSelectors = function () {
    this.$document = $(document);
    this.$body = $('body');
    this.$formContainer = $('.cta-admin-container');
    this.$forms = $('form.cta-form, #cta-cta-form');
    this.$buttons = $('.cta-button, .cta-button-primary, .cta-button-secondary, .cta-button-danger');
    this.$notices = $('.cta-notice');
  };

  /**
   * Bind event handlers
   */
  CTCAdmin.bindEvents = function () {
    var self = this;

    // Form submission
    this.$forms.on('submit', function (e) {
      self.handleFormSubmit(e, this);
    });

    // Dismiss notices
    this.$notices.on('click', '.cta-notice-close', function (e) {
      e.preventDefault();
      self.dismissNotice($(this).closest('.cta-notice'));
    });

    // Auto-dismiss notices after 5 seconds
    this.$notices.not('.cta-notice-persistent').each(function () {
      self.autoDismissNotice($(this), 5000);
    });

    // Confirm dialogs
    this.$document.on('click', '[data-confirm]', function (e) {
      if (!self.confirm($(this).data('confirm'))) {
        e.preventDefault();
      }
    });

    // Help text toggles
    this.$document.on('click', '[data-toggle-help]', function (e) {
      e.preventDefault();
      self.toggleHelpText($(this));
    });

    // Simple modal toggles for dashboard help
    this.$document.on('click', '.cta-help-trigger', function (e) {
      e.preventDefault();
      var target = $(this).data('target');
      if (!target) return;
      if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
        window.ctaModalAPI.open(target);
      } else {
        $(target).fadeIn(150);
        $('body').addClass('cta-modal-open');
      }
    });
    this.$document.on('click', '.cta-modal-close, .cta-modal-overlay', function (e) {
      e.preventDefault();
      var $modal = $(this).closest('.cta-modal').length ? $(this).closest('.cta-modal') : $(this).siblings('.cta-modal-content').parent();
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close($modal);
      } else {
        $modal.fadeOut(150, function () {
          if (!$('.cta-modal:visible').not($modal).length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }
    });
    this.$document.on('keydown', function (e) {
      if (e.key === 'Escape') {
        if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
          $('.cta-modal:visible').each(function () {
            window.ctaModalAPI.close($(this));
          });
        } else {
          $('.cta-modal:visible').fadeOut(150);
          $('body').removeClass('cta-modal-open');
        }
      }
    });
  };

  /**
   * Handle tab switching
   */
  CTCAdmin.initTabs = function () {
    this.$document.on('click', '.cta-tab-link', function (e) {
      e.preventDefault();
      var $btn = $(this);
      var target = $btn.data('tab-target');
      if (!target) return;
      var $tabs = $btn.closest('.cta-tabs');
      var $tabPanels = $tabs.siblings('.cta-tab-panels');
      $tabs.find('.cta-tab-link').removeClass('is-active').attr('aria-selected', 'false');
      $btn.addClass('is-active').attr('aria-selected', 'true');
      $tabPanels.find('.cta-tab-panel').removeClass('is-active');
      $tabPanels.find('#' + target).addClass('is-active');
    });
  };

  /**
   * Initialize tooltips
   */
  CTCAdmin.initTooltips = function () {
    $('[data-tooltip]').each(function () {
      var $this = $(this);
      var content = $this.data('tooltip');
      $this.on('mouseenter', function () {
        CTCAdmin.showTooltip($this, content);
      }).on('mouseleave', function () {
        CTCAdmin.hideTooltip($this);
      });
    });
  };

  /**
   * Initialize color pickers (if jQuery color picker is available)
   */
  CTCAdmin.initColorPickers = function () {
    var $colorInputs = $('.cta-color-picker');
    if ($colorInputs.length && typeof jQuery.fn.spectrum !== 'undefined') {
      $colorInputs.spectrum({
        preferredFormat: 'hex',
        move: function (color) {
          $(this).val(color.toHexString()).trigger('change');
        }
      });
    } else if ($colorInputs.length && typeof jQuery.fn.minicolors !== 'undefined') {
      $colorInputs.minicolors();
    } else if ($colorInputs.length) {
      // Fallback: make inputs type="color" if supported
      if ($colorInputs.attr('type') === 'text') {
        $colorInputs.attr('type', 'color');
      }
    }
  };

  /**
   * Initialize CTA Performance table sorting + pagination on dashboard.
   */
  CTCAdmin.initPerformanceTable = function () {
    var table = document.getElementById('cta-performance-table');
    if (!table) {
      return;
    }
    var tbody = table.querySelector('tbody');
    if (!tbody) {
      return;
    }
    var pagination = document.getElementById('cta-performance-pagination');
    var perPageSelect = document.getElementById('cta-performance-per-page');
    if (!pagination || !perPageSelect) {
      return;
    }
    var rows = Array.prototype.slice.call(tbody.querySelectorAll('tr'));
    if (!rows.length) {
      return;
    }
    var currentPage = 1;
    var currentSortKey = null;
    var currentSortDir = 'desc';
    var perPage = parseInt(perPageSelect.value, 10) || 25;
    function getSortValue(row, key) {
      if (!key) return '';
      if (key === 'cta') return (row.dataset.ctaTitle || '').toLowerCase();
      if (key === 'top_page') return (row.dataset.topPage || '').toLowerCase();
      if (key === 'impressions') return parseInt(row.dataset.impressions || '0', 10);
      if (key === 'clicks') return parseInt(row.dataset.clicks || '0', 10);
      if (key === 'ctr') return parseFloat(row.dataset.ctr || '0');
      return '';
    }
    function sortRows(key) {
      if (!key) return;
      rows.sort(function (a, b) {
        var aVal = getSortValue(a, key);
        var bVal = getSortValue(b, key);
        if (typeof aVal === 'number' && typeof bVal === 'number') {
          return aVal - bVal;
        }
        return String(aVal).localeCompare(String(bVal));
      });
      if (currentSortDir === 'desc') {
        rows.reverse();
      }
      rows.forEach(function (row) {
        tbody.appendChild(row);
      });
    }
    function updateSortIndicators(key) {
      var headers = table.querySelectorAll('th.cta-sortable');
      headers.forEach(function (header) {
        header.classList.remove('cta-sort-asc', 'cta-sort-desc');
        if (header.dataset.sortKey === key) {
          header.classList.add(currentSortDir === 'asc' ? 'cta-sort-asc' : 'cta-sort-desc');
        }
      });
    }
    function renderPagination() {
      var totalPages = Math.max(1, Math.ceil(rows.length / perPage));
      if (currentPage > totalPages) {
        currentPage = totalPages;
      }
      if (totalPages <= 1) {
        pagination.innerHTML = '';
        return;
      }
      var html = '<div class="cta-pagination-controls">';
      if (currentPage > 1) {
        html += '<button class="button" data-page="' + (currentPage - 1) + '">&larr; Prev</button>';
      }
      var maxPages = Math.min(totalPages, 7);
      var startPage = Math.max(1, currentPage - 3);
      var endPage = Math.min(totalPages, startPage + maxPages - 1);
      if (endPage - startPage < maxPages - 1) {
        startPage = Math.max(1, endPage - maxPages + 1);
      }
      if (startPage > 1) {
        html += '<button class="button" data-page="1">1</button>';
        if (startPage > 2) {
          html += '<span class="cta-pagination-dots">...</span>';
        }
      }
      for (var i = startPage; i <= endPage; i++) {
        if (i === currentPage) {
          html += '<span class="cta-pagination-current">' + i + '</span>';
        } else {
          html += '<button class="button" data-page="' + i + '">' + i + '</button>';
        }
      }
      if (endPage < totalPages) {
        if (endPage < totalPages - 1) {
          html += '<span class="cta-pagination-dots">...</span>';
        }
        html += '<button class="button" data-page="' + totalPages + '">' + totalPages + '</button>';
      }
      if (currentPage < totalPages) {
        html += '<button class="button" data-page="' + (currentPage + 1) + '">Next &rarr;</button>';
      }
      html += '</div>';
      pagination.innerHTML = html;
    }
    function renderPage() {
      var startIndex = (currentPage - 1) * perPage;
      var endIndex = startIndex + perPage;
      rows.forEach(function (row, index) {
        row.style.display = index >= startIndex && index < endIndex ? '' : 'none';
      });
      renderPagination();
    }
    table.addEventListener('click', function (event) {
      var header = event.target.closest('th.cta-sortable');
      if (!header) return;
      var sortKey = header.dataset.sortKey;
      if (!sortKey) return;
      if (currentSortKey === sortKey) {
        currentSortDir = currentSortDir === 'asc' ? 'desc' : 'asc';
      } else {
        currentSortKey = sortKey;
        currentSortDir = 'desc';
      }
      sortRows(sortKey);
      updateSortIndicators(sortKey);
      currentPage = 1;
      renderPage();
    });
    pagination.addEventListener('click', function (event) {
      var button = event.target.closest('button[data-page]');
      if (!button) return;
      var nextPage = parseInt(button.getAttribute('data-page'), 10);
      if (!nextPage || nextPage === currentPage) return;
      currentPage = nextPage;
      renderPage();
    });
    perPageSelect.addEventListener('change', function () {
      perPage = parseInt(this.value, 10) || 25;
      currentPage = 1;
      renderPage();
    });
    sortRows('clicks');
    currentSortKey = 'clicks';
    currentSortDir = 'desc';
    updateSortIndicators('clicks');
    renderPage();
  };

  /**
   * Handle form submission
   */
  CTCAdmin.handleFormSubmit = function (e, form) {
    var $form = $(form);

    // Skip AJAX for CTA form - it uses standard POST submission
    if ($form.attr('id') === 'cta-cta-form') {
      return true;
    }
    e.preventDefault();
    var formData = $form.serialize();
    var action = $form.attr('action') || ctaAdminVars.ajaxUrl;
    var method = $form.attr('method') || 'POST';

    // Disable submit button
    var $submitBtn = $form.find('[type="submit"]');
    var originalText = $submitBtn.text();
    CTCAdmin.setButtonLoading($submitBtn, true);

    // Optional: trigger custom validation
    if (this.validateForm($form)) {
      // Proceed with submission
      $.ajax({
        url: action,
        type: method,
        data: formData,
        dataType: 'json',
        success: function (response) {
          if (response.success) {
            CTCAdmin.showNotice('Settings saved successfully.', 'success');
            $form.trigger('ctc:formSaved', [response]);
          } else {
            var message = response.message || 'An error occurred while saving.';
            CTCAdmin.showNotice(message, 'error');
          }
        },
        error: function (xhr, status, error) {
          console.error('Form submission error:', error);
          CTCAdmin.showNotice('An error occurred. Please try again.', 'error');
        },
        complete: function () {
          CTCAdmin.setButtonLoading($submitBtn, false, originalText);
        }
      });
    } else {
      CTCAdmin.setButtonLoading($submitBtn, false, originalText);
      CTCAdmin.showNotice('Please check the form for errors.', 'warning');
    }
  };

  /**
   * Validate form fields
   */
  CTCAdmin.validateForm = function ($form) {
    var isValid = true;
    var errors = [];
    $form.find('[required]').each(function () {
      var $field = $(this);
      var value = $field.val().trim();
      var fieldName = $field.attr('name') || $field.attr('id');
      if (!value) {
        isValid = false;
        errors.push(fieldName + ' is required.');
        $field.addClass('cta-field-error');
      } else {
        $field.removeClass('cta-field-error');
      }
    });

    // Email validation
    $form.find('input[type="email"]').each(function () {
      var $field = $(this);
      var value = $field.val().trim();
      if (value && !CTCAdmin.isValidEmail(value)) {
        isValid = false;
        errors.push($field.attr('name') + ' is not a valid email address.');
        $field.addClass('cta-field-error');
      } else {
        $field.removeClass('cta-field-error');
      }
    });
    if (errors.length && !isValid) {
      console.warn('Form validation errors:', errors);
    }
    return isValid;
  };

  /**
   * Validate email address
   */
  CTCAdmin.isValidEmail = function (email) {
    var regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
  };

  /**
   * Show notice message (now uses toast notifications)
   */
  CTCAdmin.showNotice = function (message, type) {
    type = type || 'info';

    // Use toast system if available
    if (window.CTAToast) {
      if (type === 'success') {
        return CTAToast.success(message);
      } else if (type === 'error') {
        return CTAToast.error(message);
      } else if (type === 'warning') {
        return CTAToast.warning(message);
      } else {
        return CTAToast.info(message);
      }
    }

    // Fallback to inline notices if toast system not available
    var noticeHTML = ['<div class="cta-notice cta-notice-' + type + '">', '<button type="button" class="cta-notice-close">&times;</button>', '<p>' + message + '</p>', '</div>'].join('');
    var $notice = $(noticeHTML);

    // Insert at top of container or body
    if ($('.cta-admin-container').length) {
      $notice.prependTo('.cta-admin-container');
    } else {
      $notice.prependTo('body');
    }

    // Bind close event
    $notice.find('.cta-notice-close').on('click', function () {
      CTCAdmin.dismissNotice($notice);
    });
    return $notice;
  };

  /**
   * Dismiss notice
   */
  CTCAdmin.dismissNotice = function ($notice) {
    $notice.fadeOut(300, function () {
      $(this).remove();
    });
  };

  /**
   * Auto-dismiss notice after delay
   */
  CTCAdmin.autoDismissNotice = function ($notice, delay) {
    delay = delay || 5000;
    setTimeout(function () {
      CTCAdmin.dismissNotice($notice);
    }, delay);
  };

  /**
   * Set button loading state
   */
  CTCAdmin.setButtonLoading = function ($button, isLoading, originalText) {
    if (isLoading) {
      $button.addClass('cta-loading').prop('disabled', true);
      $button.data('originalText', $button.text());
      $button.text('Loading...');
    } else {
      $button.removeClass('cta-loading').prop('disabled', false);
      $button.text(originalText || $button.data('originalText') || 'Save');
    }
  };

  /**
   * Disable button
   */
  CTCAdmin.disableButton = function ($button) {
    $button.prop('disabled', true).addClass('cta-loading');
  };

  /**
   * Enable button
   */
  CTCAdmin.enableButton = function ($button) {
    $button.prop('disabled', false).removeClass('cta-loading');
  };

  /**
   * Show tooltip
   */
  CTCAdmin.showTooltip = function ($element, content) {
    var $tooltip = $('<div class="cta-admin-tooltip"></div>').text(content).css({
      position: 'absolute',
      backgroundColor: '#333',
      color: '#fff',
      padding: '8px 12px',
      borderRadius: '4px',
      fontSize: '12px',
      zIndex: 9999,
      whiteSpace: 'nowrap',
      pointerEvents: 'none'
    });
    $('body').append($tooltip);
    var offset = $element.offset();
    $tooltip.css({
      top: offset.top - $tooltip.outerHeight() - 8 + 'px',
      left: offset.left + $element.outerWidth() / 2 - $tooltip.outerWidth() / 2 + 'px'
    });
    $element.data('ctaTooltip', $tooltip);
  };

  /**
   * Hide tooltip
   */
  CTCAdmin.hideTooltip = function ($element) {
    var $tooltip = $element.data('ctaTooltip');
    if ($tooltip) {
      $tooltip.remove();
      $element.removeData('ctaTooltip');
    }
  };

  /**
   * Toggle help text visibility
   */
  CTCAdmin.toggleHelpText = function ($trigger) {
    var helpId = $trigger.data('toggle-help');
    var $helpText = $('#' + helpId);
    if ($helpText.length) {
      $helpText.slideToggle(300);
      $trigger.toggleClass('active');
    }
  };

  /**
   * Confirm dialog
   */
  CTCAdmin.confirm = function (message) {
    return window.confirm(message);
  };

  /**
   * Get form data as object
   */
  CTCAdmin.getFormData = function ($form) {
    var formArray = $form.serializeArray();
    var formObject = {};
    $.each(formArray, function () {
      if (formObject[this.name]) {
        if (!Array.isArray(formObject[this.name])) {
          formObject[this.name] = [formObject[this.name]];
        }
        formObject[this.name].push(this.value);
      } else {
        formObject[this.name] = this.value;
      }
    });
    return formObject;
  };

  /**
   * Field name mapping: CTA data key -> form field name
   * Allows flexible mapping between CTA data structure and form field names
   */
  CTCAdmin.fieldNameMap = {
    // General
    'name': 'cta_name',
    'status': 'cta_status',
    // Display
    'layout': 'cta_layout',
    // Action
    'type': 'cta_type',
    // Content (Pro)
    'title': 'cta_title',
    'tagline': 'cta_tagline',
    'body_text': 'cta_body_text',
    // Button
    'icon': 'cta_icon',
    'color': 'cta_color',
    'background_type': 'cta_background_type',
    'gradient_type': 'cta_gradient_type',
    'gradient_angle': 'cta_gradient_angle',
    'gradient_start': 'cta_gradient_start',
    'gradient_start_position': 'cta_gradient_start_position',
    'gradient_end': 'cta_gradient_end',
    'gradient_end_position': 'cta_gradient_end_position',
    'border_style': 'cta_border_style',
    'border_color': 'cta_border_color',
    'border_width_top': 'cta_border_width_top',
    'border_width_right': 'cta_border_width_right',
    'border_width_bottom': 'cta_border_width_bottom',
    'border_width_left': 'cta_border_width_left',
    'border_width_linked': 'cta_border_width_linked',
    'border_radius_top_left': 'cta_border_radius_top_left',
    'border_radius_top_right': 'cta_border_radius_top_right',
    'border_radius_bottom_right': 'cta_border_radius_bottom_right',
    'border_radius_bottom_left': 'cta_border_radius_bottom_left',
    'border_radius_linked': 'cta_border_radius_linked',
    'padding_top': 'cta_padding_top',
    'padding_right': 'cta_padding_right',
    'padding_bottom': 'cta_padding_bottom',
    'padding_left': 'cta_padding_left',
    'padding_linked': 'cta_padding_linked',
    // Advanced (Pro)
    'html_id': 'cta_html_id',
    'classes': 'cta_classes'
  };

  /**
   * Populate form from data object
   */
  CTCAdmin.populateForm = function ($form, data) {
    $.each(data, function (key, value) {
      // Map key to form field name if mapping exists
      var fieldName = CTCAdmin.fieldNameMap[key] || key;
      var $field = $form.find('[name="' + fieldName + '"]');

      // Also try original key if mapped field not found
      if (!$field.length && CTCAdmin.fieldNameMap[key]) {
        $field = $form.find('[name="' + key + '"]');
      }
      if ($field.length) {
        if ($field.is(':checkbox') || $field.is(':radio')) {
          if (Array.isArray(value)) {
            $field.filter('[value="' + value.join('"], [value="') + '"]').prop('checked', true);
          } else if ($field.is(':checkbox') && typeof value === 'boolean') {
            $field.prop('checked', value);
          } else {
            $field.filter('[value="' + value + '"]').prop('checked', true);
          }
        } else {
          $field.val(value);
        }
      }
    });

    // Trigger change events to update UI (show/hide conditional fields)
    $form.find('select').trigger('change');
  };

  /**
   * Copy text to clipboard (uses toast notifications)
   */
  CTCAdmin.copyToClipboard = function (text) {
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(text).then(function () {
        if (window.CTAToast) {
          CTAToast.success('Copied to clipboard!');
        } else {
          CTCAdmin.showNotice('Copied to clipboard!', 'success');
        }
      }).catch(function () {
        if (window.CTAToast) {
          CTAToast.error('Failed to copy to clipboard');
        } else {
          CTCAdmin.showNotice('Failed to copy to clipboard.', 'error');
        }
      });
    } else {
      // Fallback for older browsers
      var $textarea = $('<textarea>').val(text).css({
        position: 'fixed',
        opacity: '0'
      });
      $('body').append($textarea);
      $textarea.select();
      try {
        document.execCommand('copy');
        if (window.CTAToast) {
          CTAToast.success('Copied to clipboard!');
        } else {
          CTCAdmin.showNotice('Copied to clipboard!', 'success');
        }
      } catch (err) {
        if (window.CTAToast) {
          CTAToast.error('Failed to copy to clipboard');
        } else {
          CTCAdmin.showNotice('Failed to copy to clipboard.', 'error');
        }
      }
      $textarea.remove();
    }
  };

  /**
   * Open preview modal with CTA data
   */
  CTCAdmin.openPreviewModal = function (ctaData) {
    var $modal = $('#cta-preview-modal');
    var $previewContainer = $modal.find('.cta-frontend-preview');

    // Generate frontend preview HTML
    var previewHTML = this.generateFrontendPreview(ctaData);
    $previewContainer.html(previewHTML);

    // Show modal
    if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
      window.ctaModalAPI.open($modal);
    } else {
      $modal.fadeIn(300);
      $('body').addClass('cta-modal-open');
    }
  };

  /**
   * Close preview modal
   */
  CTCAdmin.closePreviewModal = function () {
    var $modal = $('#cta-preview-modal');
    if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
      window.ctaModalAPI.close($modal);
    } else {
      $modal.fadeOut(300, function () {
        if (!$('.cta-modal:visible').not($modal).length) {
          $('body').removeClass('cta-modal-open');
        }
      });
    }
  };

  /**
   * Generate frontend preview HTML
   */
  CTCAdmin.generateFrontendPreview = function (cta) {
    var layout = cta.layout || 'button';
    var buttonAlignment = cta.button_alignment || 'center';
    var alignmentMap = {
      left: 'flex-start',
      center: 'center',
      right: 'flex-end'
    };
    var justifyContent = alignmentMap[buttonAlignment] || 'center';

    // Get the actual icon value from the CTA data - don't default to 'phone'
    // The database defaults to 'none', so respect that
    var iconChoice = cta.icon || 'none';

    // Map icon choice to dashicons class
    var iconMap = {
      'phone': 'dashicons-phone',
      'phone-alt': 'dashicons-phone',
      'email': 'dashicons-email',
      'star': 'dashicons-star-empty',
      'star-filled': 'dashicons-star-filled',
      'chat': 'dashicons-format-chat',
      'heart': 'dashicons-heart',
      'calendar': 'dashicons-calendar-alt',
      'arrow-right': 'dashicons-arrow-right-alt',
      'download': 'dashicons-download',
      'cart': 'dashicons-cart',
      'bolt': 'dashicons-performance'
    };

    // Only show icon if it's a valid icon choice (not 'none') and show_icon is not false
    var hasValidIcon = iconChoice && iconChoice !== 'none' && iconMap.hasOwnProperty(iconChoice);
    var showIcon = hasValidIcon && cta.show_icon !== false;

    // Build icon HTML
    var iconHTML = '';
    if (showIcon) {
      var iconClass = iconMap[iconChoice];
      iconHTML = '<span class="cta-button__icon"><span class="dashicons ' + iconClass + '"></span></span>';
    }

    // Build button styles from CTA configuration
    var buttonStyles = this.buildButtonStyles(cta);
    var textStyles = this.buildButtonTextStyles(cta);

    // Build button HTML - matches public/partials/button.php structure
    // Use actual button_text from CTA data (PHP already provides defaults)
    var buttonText = cta.button_text || '';
    var buttonHTML = '<a href="#" class="cta-button" style="' + buttonStyles + '" onclick="return false;">' + iconHTML + '<span class="cta-button__text" style="' + textStyles + '">' + this.escapeHtml(buttonText) + '</span>' + '</a>';

    // Build layout-specific HTML
    var html = '';
    if (layout === 'button') {
      // Simple button layout
      html = '<div class="cta-button-wrapper" style="justify-content: ' + justifyContent + ';">' + buttonHTML + '</div>';
    } else {
      // Card layouts - matches public/partials/card.php structure
      var metaHTML = '<div class="cta-meta">';
      if (cta.title) {
        metaHTML += '<h3 class="cta-title">' + this.escapeHtml(cta.title) + '</h3>';
      }
      if (cta.tagline) {
        metaHTML += '<p class="cta-tagline">' + this.escapeHtml(cta.tagline) + '</p>';
      }
      if (cta.body_text) {
        metaHTML += '<p class="cta-body">' + this.escapeHtml(cta.body_text) + '</p>';
      }
      metaHTML += '</div>';
      var layoutClass = 'cta-layout-' + layout.replace('_', '-');
      html = '<div class="cta-container ' + layoutClass + '">' + '<div class="cta-card">' + metaHTML + '<div class="cta-action" style="justify-content: ' + justifyContent + ';">' + buttonHTML + '</div>' + '</div>' + '</div>';
    }
    return html;
  };

  /**
   * Escape HTML to prevent XSS
   */
  CTCAdmin.escapeHtml = function (text) {
    var map = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, function (m) {
      return map[m];
    });
  };

  /**
   * Build inline styles for button from CTA configuration
   */
  CTCAdmin.buildButtonStyles = function (cta) {
    var styles = [];

    // Button width
    var buttonWidth = cta.button_width || 'auto';
    var buttonAlignment = cta.button_alignment || 'center';
    var widthValue = buttonWidth === 'full' ? '100%' : 'fit-content';
    styles.push('width: ' + widthValue);

    // Alignment via margins (only when not full width)
    if (buttonWidth !== 'full') {
      var marginLeft = buttonAlignment === 'left' ? '0' : 'auto';
      var marginRight = buttonAlignment === 'right' ? '0' : 'auto';
      styles.push('margin-left: ' + marginLeft);
      styles.push('margin-right: ' + marginRight);
    }

    // Background
    var bgType = cta.background_type || 'solid';
    if (bgType === 'transparent') {
      styles.push('background: transparent');
    } else if (bgType === 'gradient') {
      var angle = cta.gradient_angle || '90';
      var start = cta.gradient_start || '#667eea';
      var end = cta.gradient_end || '#764ba2';
      styles.push('background: linear-gradient(' + angle + 'deg, ' + start + ', ' + end + ')');
    } else {
      var color = cta.color || '#667eea';
      styles.push('background-color: ' + color);
    }

    // Border
    var borderStyle = cta.border_style || 'none';
    if (borderStyle !== 'none') {
      var borderColor = cta.border_color || '#667eea';
      var bwTop = cta.border_width_top || '2px';
      var bwRight = cta.border_width_right || '2px';
      var bwBottom = cta.border_width_bottom || '2px';
      var bwLeft = cta.border_width_left || '2px';
      styles.push('border-top: ' + bwTop + ' ' + borderStyle + ' ' + borderColor);
      styles.push('border-right: ' + bwRight + ' ' + borderStyle + ' ' + borderColor);
      styles.push('border-bottom: ' + bwBottom + ' ' + borderStyle + ' ' + borderColor);
      styles.push('border-left: ' + bwLeft + ' ' + borderStyle + ' ' + borderColor);
    } else {
      styles.push('border: none');
    }

    // Border radius
    var brTL = cta.border_radius_top_left || '8px';
    var brTR = cta.border_radius_top_right || '8px';
    var brBR = cta.border_radius_bottom_right || '8px';
    var brBL = cta.border_radius_bottom_left || '8px';
    styles.push('border-radius: ' + brTL + ' ' + brTR + ' ' + brBR + ' ' + brBL);

    // Padding
    var pTop = cta.padding_top || '12px';
    var pRight = cta.padding_right || '24px';
    var pBottom = cta.padding_bottom || '12px';
    var pLeft = cta.padding_left || '24px';
    styles.push('padding: ' + pTop + ' ' + pRight + ' ' + pBottom + ' ' + pLeft);

    // Display flex for icon alignment
    styles.push('display: flex');
    styles.push('align-items: center');
    styles.push('justify-content: center');
    styles.push('gap: 8px');
    styles.push('text-decoration: none');
    styles.push('cursor: pointer');
    return styles.join('; ');
  };

  /**
   * Build inline styles for button text from CTA configuration
   */
  CTCAdmin.buildButtonTextStyles = function (cta) {
    var styles = [];
    var fontSize = cta.button_text_font_size || '16px';
    var fontWeight = cta.button_text_font_weight || '600';
    var fontFamily = cta.button_text_font_family || 'inherit';
    var textColor = cta.button_text_color || '#ffffff';
    styles.push('font-size: ' + fontSize);
    styles.push('font-weight: ' + fontWeight);
    if (fontFamily && fontFamily !== 'inherit') {
      styles.push('font-family: ' + fontFamily);
    }
    styles.push('color: ' + textColor);
    return styles.join('; ');
  };

  /**
   * Initialize on document ready
   */
  $(function () {
    CTCAdmin.init();

    // Preview modal handlers
    $(document).on('click', '.cta-preview-cta-btn', function (e) {
      e.preventDefault();
      var ctaData = $(this).data('cta-data');
      if (ctaData) {
        CTCAdmin.openPreviewModal(ctaData);
      }
    });
    $(document).on('click', '#cta-preview-modal [data-close-modal], #cta-preview-modal .cta-modal-overlay', function (e) {
      e.preventDefault();
      CTCAdmin.closePreviewModal();
    });

    // Close modal on ESC key
    $(document).on('keydown', function (e) {
      if (e.key === 'Escape' && $('#cta-preview-modal').is(':visible')) {
        CTCAdmin.closePreviewModal();
      }
    });

    // Documentation trigger button handler (opens docs modal to specific page)
    $(document).on('click', '.cta-docs-trigger[data-docs-page]', function (e) {
      e.preventDefault();
      var docsPage = $(this).data('docs-page');
      if (window.CTAManager && typeof window.CTAManager.openDocumentationModal === 'function') {
        window.CTAManager.openDocumentationModal(docsPage, 'feature');
      } else if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
        window.ctaModalAPI.open('#cta-docs-modal');
        // Navigate to the specific page after modal opens
        setTimeout(function () {
          var navBtn = document.querySelector('.cta-docs-submenu-link[data-docs-page="' + docsPage + '"]');
          if (navBtn) {
            navBtn.click();
          }
        }, 100);
      }
    });

    // Copy to clipboard functionality for shortcode examples
    $(document).on('click', '.cta-copy-btn', function (e) {
      e.preventDefault();
      var textToCopy = $(this).data('copy');
      if (textToCopy) {
        CTCAdmin.copyToClipboard(textToCopy);
      }
    });

    // Copy shortcode from CTA cards (button click)
    $(document).on('click', '.cta-copy-shortcode', function (e) {
      e.preventDefault();
      e.stopPropagation();
      var $btn = $(this);
      var textToCopy = $btn.data('shortcode');
      if (textToCopy) {
        CTCAdmin.copyToClipboard(textToCopy);
        var $icon = $btn.find('.dashicons');
        var originalIconClass = $icon.attr('class');
        // Swap to checkmark icon and add copied class
        $icon.removeClass().addClass('dashicons dashicons-yes');
        $btn.addClass('copied');
        setTimeout(function () {
          $icon.removeClass().addClass(originalIconClass);
          $btn.removeClass('copied');
        }, 1500);
      }
    });

    // Copy shortcode from CTA cards (direct click on code element)
    $(document).on('click', '.cta-manager-shortcode', function (e) {
      e.preventDefault();
      var textToCopy = $(this).text().trim();
      if (textToCopy) {
        CTCAdmin.copyToClipboard(textToCopy);
        var $btn = $(this).closest('.cta-shortcode-wrapper').find('.cta-copy-shortcode');
        var $icon = $btn.find('.dashicons');
        var originalIconClass = $icon.attr('class');
        // Swap to checkmark icon and add copied class
        $icon.removeClass().addClass('dashicons dashicons-yes');
        $btn.addClass('copied');
        setTimeout(function () {
          $icon.removeClass().addClass(originalIconClass);
          $btn.removeClass('copied');
        }, 1500);
      }
    });

    // Format modal handlers
    $(document).on('click', '.cta-format-icon-btn', function (e) {
      e.preventDefault();
      var fieldName = $(this).data('field');
      CTCAdmin.openFormatModal(fieldName);
    });

    // Format modal: Font size slider sync
    $(document).on('input', '#cta-format-font-size-slider', function (e) {
      $('#cta-format-font-size-value').val($(this).val());
      CTCAdmin.updateFormatPreview();
    });

    // Format modal: Font size input sync
    $(document).on('input', '#cta-format-font-size-value', function (e) {
      $('#cta-format-font-size-slider').val($(this).val());
      CTCAdmin.updateFormatPreview();
    });

    // Format modal: Font size unit change
    $(document).on('change', '#cta-format-font-size-unit, #cta-format-font-family', function (e) {
      CTCAdmin.updateFormatPreview();
    });

    // Format modal: Color picker change
    $(document).on('change', '#cta-format-color, #cta-color-wheel', function (e) {
      var color = $(this).val();
      $('#cta-format-color').val(color);
      $('#cta-color-wheel').val(color);
      var rgba = CTCAdmin.hexToRgba(color);
      $('#cta-rgba-r').val(rgba.r).next().val(rgba.r);
      $('#cta-rgba-g').val(rgba.g).next().val(rgba.g);
      $('#cta-rgba-b').val(rgba.b).next().val(rgba.b);
      CTCAdmin.updateFormatPreview();
    });

    // Format modal: RGBA color changes
    $(document).on('input', '#cta-rgba-r, #cta-rgba-g, #cta-rgba-b', function (e) {
      var $input = $(this);
      var isSlider = $input.attr('type') === 'range';
      var value = parseInt($input.val());
      if (isSlider) {
        $input.next().val(value);
      } else {
        $input.prev().val(value);
      }
      var r = parseInt($('#cta-rgba-r').val()) || 0;
      var g = parseInt($('#cta-rgba-g').val()) || 0;
      var b = parseInt($('#cta-rgba-b').val()) || 0;
      var hex = CTCAdmin.rgbaToHex(r, g, b);
      $('#cta-format-color').val(hex);
      $('#cta-color-wheel').val(hex);
      CTCAdmin.updateFormatPreview();
    });

    // Format modal: Font weight buttons
    $(document).on('click', '.cta-weight-btn', function (e) {
      e.preventDefault();
      $('.cta-weight-btn').removeClass('active');
      $(this).addClass('active');
      CTCAdmin.updateFormatPreview();
    });

    // Format modal: Alignment buttons
    $(document).on('click', '.cta-alignment-btn', function (e) {
      e.preventDefault();
      var $button = $(this);
      var $modal = $('#cta-format-modal');

      // Only update modal alignment buttons if this is in the format modal
      if ($button.closest('#cta-format-modal').length) {
        $modal.find('.cta-alignment-btn').removeClass('active');
        $button.addClass('active');
        CTCAdmin.updateFormatPreview();
      }
    });

    // Format modal: Color tab switching
    $(document).on('click', '.cta-color-tab-btn', function (e) {
      e.preventDefault();
      var tabName = $(this).data('tab');
      var $modal = $('#cta-format-modal');
      $modal.find('.cta-color-tab-btn').removeClass('active');
      $(this).addClass('active');
      $modal.find('.cta-color-tab-content').removeClass('active');
      $modal.find('.cta-color-tab-content[data-tab="' + tabName + '"]').addClass('active');
    });

    // Format modal: Save button
    $(document).on('click', '#cta-format-modal .cta-modal-footer .cta-button-primary', function (e) {
      e.preventDefault();
      CTCAdmin.saveFormatChanges();
    });

    // Format modal: Close button
    $(document).on('click', '#cta-format-modal .cta-modal-close, #cta-format-modal .cta-modal-overlay', function (e) {
      e.preventDefault();
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close('#cta-format-modal');
      } else {
        $('#cta-format-modal').fadeOut(200, function () {
          if (!$('.cta-modal:visible').not('#cta-format-modal').length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }
    });

    // Format modal: Close on ESC
    $(document).on('keydown', function (e) {
      if (e.key === 'Escape' && $('#cta-format-modal').is(':visible')) {
        if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
          window.ctaModalAPI.close('#cta-format-modal');
        } else {
          $('#cta-format-modal').fadeOut(200, function () {
            if (!$('.cta-modal:visible').not('#cta-format-modal').length) {
              $('body').removeClass('cta-modal-open');
            }
          });
        }
      }
    });
  });

  /**
   * Icon mappings for preview
   */
  CTCAdmin.iconMap = {
    'none': '',
    'phone': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>',
    'phone-alt': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z"/></svg>',
    'star': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>',
    'star-filled': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>',
    'chat': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>',
    'email': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>',
    'arrow-right': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>',
    'calendar': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>',
    'cart': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/></svg>',
    'download': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>',
    'heart': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>',
    'bolt': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66.19-.34.05-.08.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21z"/></svg>'
  };

  /**
   * CTA type configuration for preview badge
   */
  CTCAdmin.ctaTypeConfig = {
    'phone': {
      icon: 'dashicons-phone',
      label: 'Phone Call',
      color: '#8b5cf6'
    },
    'link': {
      icon: 'dashicons-admin-links',
      label: 'Link',
      color: '#06b6d4'
    },
    'email': {
      icon: 'dashicons-email',
      label: 'Email',
      color: '#f59e0b'
    },
    'popup': {
      icon: 'dashicons-external',
      label: 'Popup Modal',
      color: '#14b8a6'
    },
    'slide-in': {
      icon: 'dashicons-slides',
      label: 'Slide-in',
      color: '#ec4899'
    }
  };

  /**
   * Update live preview with current form values
   */
  CTCAdmin.updateLivePreview = function () {
    var $preview = $('#cta-live-preview');
    if (!$preview.length) return;
    var $card = $preview.find('.cta-preview-card');
    var $button = $preview.find('.cta-preview-button');

    // Get form values
    var layout = $('#cta-layout').val() || 'button';
    var ctaType = $('#cta-type').val() || 'phone';
    var title = $('#cta-title').val() || '';
    var tagline = $('#cta-tagline').val() || '';
    var bodyText = $('#cta-body-text').val() || '';
    var buttonText = $('#button-text').val() || 'Call Now';
    var iconValue = $('#cta-icon').val() || 'none';
    var buttonAnimation = $('#button-animation').val() || 'none';

    // Update layout
    $card.attr('data-layout', layout);
    $card.removeClass('layout-button layout-card-top layout-card-bottom layout-card-left layout-card-right');
    $card.addClass('layout-' + layout);

    // Update CTA type badge
    var typeConfig = this.ctaTypeConfig[ctaType] || this.ctaTypeConfig['phone'];
    var $typeBadge = $preview.find('#cta-preview-type-badge');
    $typeBadge.find('.cta-preview-type-icon').removeClass().addClass('cta-preview-type-icon dashicons ' + typeConfig.icon);
    $typeBadge.find('.cta-preview-type-label').text(typeConfig.label);
    $typeBadge.css('background-color', typeConfig.color);

    // Update text content
    var $titleEl = $preview.find('.cta-preview-title');
    var $taglineEl = $preview.find('.cta-preview-tagline');
    var $bodyEl = $preview.find('.cta-preview-body');
    $titleEl.text(title);
    $taglineEl.text(tagline);
    $bodyEl.text(bodyText);
    $preview.find('.cta-preview-label').text(buttonText);

    // Show/hide text elements based on content
    $titleEl.toggle(!!title);
    $taglineEl.toggle(!!tagline);
    $bodyEl.toggle(!!bodyText);

    // Show/hide text container based on layout
    var $textContainer = $preview.find('.cta-preview-text');
    if (layout === 'button') {
      $textContainer.hide();
    } else {
      $textContainer.show();
    }

    // Update title formatting
    $titleEl.css({
      'font-size': $('#title_font_size').val() || '18px',
      'font-family': $('#title_font_family').val() || 'inherit',
      'font-weight': $('#title_font_weight').val() || '700',
      'color': $('#title_color').val() || '#1e293b',
      'text-align': $('#title_alignment').val() || 'left'
    });

    // Update tagline formatting
    $taglineEl.css({
      'font-size': $('#tagline_font_size').val() || '13px',
      'font-family': $('#tagline_font_family').val() || 'inherit',
      'font-weight': $('#tagline_font_weight').val() || '400',
      'color': $('#tagline_color').val() || '#64748b',
      'text-align': $('#tagline_alignment').val() || 'left'
    });

    // Update body formatting
    $bodyEl.css({
      'font-size': $('#body_font_size').val() || '13px',
      'font-family': $('#body_font_family').val() || 'inherit',
      'font-weight': $('#body_font_weight').val() || '400',
      'color': $('#body_color').val() || '#475569',
      'text-align': $('#body_alignment').val() || 'left'
    });

    // Update button text formatting
    var $buttonLabel = $preview.find('.cta-preview-label');
    var btnAlignment = $('#button_text_alignment').val() || 'center';
    var alignmentMap = {
      'left': 'flex-start',
      'center': 'center',
      'right': 'flex-end'
    };

    // Apply text alignment to button container using justify-content (for flex)
    $button.css('justify-content', alignmentMap[btnAlignment] || 'center');
    $buttonLabel.css({
      'font-size': $('#button_text_font_size').val() || '16px',
      'font-family': $('#button_text_font_family').val() || 'inherit',
      'font-weight': $('#button_text_font_weight').val() || '600',
      'color': $('#button_text_color').val() || '#ffffff'
    });

    // Update button icon
    var $iconWrapper = $button.find('.cta-preview-icon-wrapper');
    var $icon = $button.find('.cta-preview-icon');
    if (iconValue && iconValue !== 'none' && this.iconMap[iconValue]) {
      $icon.html(this.iconMap[iconValue]);
      $iconWrapper.show();
    } else if (iconValue && iconValue !== 'none' && iconValue !== '__add_custom_icon__') {
      // Check for custom icon
      var $selectedOption = $('#cta-icon option:selected');
      if ($selectedOption.data('is-custom') === '1' || $selectedOption.data('is-custom') === 1) {
        // Try to get custom icon from window.ctaCustomIcons if available
        if (window.ctaCustomIcons && window.ctaCustomIcons[iconValue]) {
          $icon.html('<img src="' + window.ctaCustomIcons[iconValue] + '" alt="" style="width: 18px; height: 18px;">');
          $iconWrapper.show();
        } else {
          $iconWrapper.hide();
        }
      } else {
        $iconWrapper.hide();
      }
    } else {
      $iconWrapper.hide();
    }

    // Update button animation class
    $button.removeClass('anim-pulse anim-bounce anim-shake anim-glow anim-heartbeat');
    if (buttonAnimation && buttonAnimation !== 'none') {
      $button.addClass('anim-' + buttonAnimation);
    }
  };

  /**
   * Bind preview updates to form changes
   */
  CTCAdmin.bindPreviewUpdates = function () {
    var self = this;
    var $form = $('#cta-cta-form');
    if (!$form.length) return;

    // Fields that affect the preview
    var textFields = '#cta-title, #cta-tagline, #cta-body-text, #button-text, #cta-layout, #cta-type, #cta-icon, #button-animation';
    var formatFields = '#title_font_size, #title_font_family, #title_font_weight, #title_color, #title_alignment, ' + '#tagline_font_size, #tagline_font_family, #tagline_font_weight, #tagline_color, #tagline_alignment, ' + '#body_font_size, #body_font_family, #body_font_weight, #body_color, #body_alignment, ' + '#button_text_font_size, #button_text_font_family, #button_text_font_weight, #button_text_color, #button_text_alignment';

    // Update on text field changes (input for typing, change for selects)
    $form.on('input change', textFields, function () {
      self.updateLivePreview();
    });

    // Update on formatting field changes
    $form.on('change', formatFields, function () {
      self.updateLivePreview();
    });

    // Also listen for document-level events that might update hidden fields
    $(document).on('ctaFormatApplied', function () {
      self.updateLivePreview();
    });

    // Initial preview render
    this.updateLivePreview();
  };

  /**
   * Open text formatting modal
   */
  CTCAdmin.openFormatModal = function (fieldName) {
    var $modal = $('#cta-format-modal');
    if (!$modal.length) return;
    var fieldMap = {
      'title': {
        prefix: 'title',
        label: 'Title'
      },
      'tagline': {
        prefix: 'tagline',
        label: 'Tagline'
      },
      'body': {
        prefix: 'body',
        label: 'Body Text'
      }
    };
    var field = fieldMap[fieldName];
    if (!field) return;

    // Store current field for reference
    $modal.data('current-field', fieldName);
    $modal.find('#cta-format-modal-title').text('Format ' + field.label);

    // Populate modal with current values
    var fontSize = $('#' + field.prefix + '_font_size').val() || '14px';
    var fontFamily = $('#' + field.prefix + '_font_family').val() || 'inherit';
    var fontWeight = $('#' + field.prefix + '_font_weight').val() || '400';
    var color = $('#' + field.prefix + '_color').val() || '#1e1e1e';
    var alignment = $('#' + field.prefix + '_alignment').val() || 'left';

    // Parse font size value and unit
    var fontSizeMatch = fontSize.match(/^(\d+)(px|rem|em)?$/);
    var fontSizeValue = fontSizeMatch ? fontSizeMatch[1] : 14;
    var fontSizeUnit = fontSizeMatch ? fontSizeMatch[2] || 'px' : 'px';
    $('#cta-format-font-size-value').val(fontSizeValue);
    $('#cta-format-font-size-unit').val(fontSizeUnit);
    $('#cta-format-font-size-slider').val(fontSizeValue);
    $('#cta-format-font-family').val(fontFamily);
    $('#cta-format-color').val(color);
    $('#cta-color-wheel').val(color);

    // Set weight button active state
    $modal.find('.cta-weight-btn').removeClass('active');
    $modal.find('.cta-weight-btn[data-weight="' + fontWeight + '"]').addClass('active');

    // Set alignment button active state
    $modal.find('.cta-alignment-btn').removeClass('active');
    $modal.find('.cta-alignment-btn[data-align="' + alignment + '"]').addClass('active');

    // Update RGBA sliders
    var rgbaColor = CTCAdmin.hexToRgba(color);
    $('#cta-rgba-r').val(rgbaColor.r).next().val(rgbaColor.r);
    $('#cta-rgba-g').val(rgbaColor.g).next().val(rgbaColor.g);
    $('#cta-rgba-b').val(rgbaColor.b).next().val(rgbaColor.b);

    // Update format preview
    this.updateFormatPreview();

    // Show modal
    $modal.fadeIn(200);
    $('body').addClass('cta-modal-open');
  };

  /**
   * Update format preview in modal
   */
  CTCAdmin.updateFormatPreview = function () {
    var $modal = $('#cta-format-modal');
    var $preview = $modal.find('#cta-format-preview-text');
    var fontSize = $('#cta-format-font-size-value').val() || 14;
    var fontSizeUnit = $('#cta-format-font-size-unit').val() || 'px';
    var fontFamily = $('#cta-format-font-family').val() || 'inherit';
    var color = $('#cta-format-color').val() || '#1e1e1e';
    var fontWeight = $modal.find('.cta-weight-btn.active').data('weight') || '400';
    var alignment = $modal.find('.cta-alignment-btn.active').data('align') || 'left';
    $preview.css({
      'font-size': fontSize + fontSizeUnit,
      'font-family': fontFamily,
      'font-weight': fontWeight,
      'color': color,
      'text-align': alignment
    });
  };

  /**
   * Save format changes to hidden fields
   */
  CTCAdmin.saveFormatChanges = function () {
    var $modal = $('#cta-format-modal');
    var fieldName = $modal.data('current-field');
    var fieldMap = {
      'title': 'title',
      'tagline': 'tagline',
      'body': 'body'
    };
    var prefix = fieldMap[fieldName];
    if (!prefix) return;
    var fontSize = $('#cta-format-font-size-value').val() || 14;
    var fontSizeUnit = $('#cta-format-font-size-unit').val() || 'px';
    var fontFamily = $('#cta-format-font-family').val() || 'inherit';
    var fontWeight = $modal.find('.cta-weight-btn.active').data('weight') || '400';
    var color = $('#cta-format-color').val() || '#1e1e1e';
    var alignment = $modal.find('.cta-alignment-btn.active').data('align') || 'left';
    $('#' + prefix + '_font_size').val(fontSize + fontSizeUnit);
    $('#' + prefix + '_font_family').val(fontFamily);
    $('#' + prefix + '_font_weight').val(fontWeight);
    $('#' + prefix + '_color').val(color);
    $('#' + prefix + '_alignment').val(alignment);

    // Update preview
    CTCAdmin.updateLivePreview();

    // Close modal
    $modal.fadeOut(200);
    $('body').removeClass('cta-modal-open');
  };

  /**
   * Helper: Convert hex color to RGBA
   */
  CTCAdmin.hexToRgba = function (hex) {
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : {
      r: 30,
      g: 30,
      b: 30
    };
  };

  /**
   * Helper: Convert RGBA to hex
   */
  CTCAdmin.rgbaToHex = function (r, g, b) {
    return '#' + [r, g, b].map(function (x) {
      var hex = parseInt(x).toString(16);
      return hex.length === 1 ? '0' + hex : hex;
    }).join('').toUpperCase();
  };

  /**
   * ========================================
   * CTA Form - Pro Option Handling
   * ======================================== */

  /**
   * Handle CTA Layout dropdown changes
   */
  CTCAdmin.handleLayoutChange = function () {
    var $select = $('#cta-layout');
    if (!$select.length) return;
    var $proBadge = $('#cta-layout-pro-badge');
    var isPro = $select.data('is-pro') === 1;
    var $errorMsg = $('#cta-layout-pro-error');
    var $cardTextRow = $('#cta-card-text-row');
    var $titleGroup = $('#cta-title-group');
    var $cardProBadges = $('#cta-title-group .cta-pro-badge, #cta-tagline-group .cta-pro-badge, #cta-body-text-group .cta-pro-badge');

    // Gray out Pro options for free users
    if (!isPro) {
      $select.find('option[data-requires-pro="1"]').css({
        'color': '#999',
        'font-style': 'italic'
      });
    }

    // Handle dropdown changes
    $select.on('change', function () {
      var selectedValue = $(this).val();
      var requiresPro = $(this).find('option:selected').data('requires-pro') === 1;

      // Show/hide title, tagline and body text fields based on layout
      if (selectedValue === 'button') {
        $titleGroup.slideUp(200);
        $cardTextRow.slideUp(200);
        $cardProBadges.fadeOut(200);
        // Enable fields when hidden
        $('#cta-title, #cta-tagline, #cta-body-text').prop('disabled', false);
        $('.cta-format-icon-btn').prop('disabled', false);
      } else {
        $titleGroup.slideDown(200);
        $cardTextRow.slideDown(200);
        // Show/hide Pro badges for card layouts
        if (requiresPro && !isPro) {
          $cardProBadges.fadeIn(200);
          // Disable fields if Pro and not Pro user
          $('#cta-title, #cta-tagline, #cta-body-text').prop('disabled', true);
          $('.cta-format-icon-btn').prop('disabled', true);
        } else {
          $cardProBadges.fadeOut(200);
          // Enable fields if Pro feature available
          $('#cta-title, #cta-tagline, #cta-body-text').prop('disabled', false);
          $('.cta-format-icon-btn').prop('disabled', false);
        }
      }

      // Show/hide PRO badge and error message
      if (requiresPro && !isPro) {
        $proBadge.fadeIn(200);
        $errorMsg.slideDown(200);
      } else {
        $proBadge.fadeOut(200);
        $errorMsg.slideUp(200);
      }
    });

    // Trigger change on page load to set initial state
    $select.trigger('change');
  };

  /**
   * Handle CTA Type dropdown changes
   */
  CTCAdmin.handleTypeChange = function () {
    var $select = $('#cta-type');
    if (!$select.length) return;
    var $proBadge = $('#cta-type-pro-badge');
    var isPro = $select.data('is-pro') === 1;
    var $errorMsg = $('#cta-type-pro-error');
    var $slideInSection = $('#cta-slide-in-settings-section');

    // Gray out Pro options for free users
    if (!isPro) {
      $select.find('option[data-requires-pro="1"]').css({
        'color': '#999',
        'font-style': 'italic'
      });
    }

    // Handle dropdown changes
    $select.on('change', function () {
      var selectedType = $(this).val();
      var requiresPro = $(this).find('option:selected').data('requires-pro') === 1;

      // Show/hide slide-in settings section
      if (selectedType === 'slide-in') {
        $slideInSection.slideDown(300);
        // Trigger trigger type change to set initial state
        $('.cta-trigger-type-radio').first().trigger('change');
      } else {
        $slideInSection.slideUp(300);
      }

      // Show/hide PRO badge and error message
      if (requiresPro && !isPro) {
        $proBadge.fadeIn(200);
        $errorMsg.slideDown(200);
      } else {
        $proBadge.fadeOut(200);
        $errorMsg.slideUp(200);
      }
    });

    // Trigger change on page load to set initial state
    $select.trigger('change');
  };

  /**
   * Handle slide-in trigger method change
   */
  CTCAdmin.handleSlideInTriggerChange = function () {
    var $triggerRadios = $('.cta-trigger-type-radio');
    if (!$triggerRadios.length) return;
    var $triggerDelayGroup = $('#cta-trigger-delay-group');
    var $triggerScrollGroup = $('#cta-trigger-scroll-group');

    // Handle radio button changes
    $triggerRadios.on('change', function () {
      var triggerType = $(this).val();
      if (triggerType === 'time') {
        $triggerDelayGroup.slideDown(200);
        $triggerScrollGroup.slideUp(200);
      } else if (triggerType === 'scroll') {
        $triggerDelayGroup.slideUp(200);
        $triggerScrollGroup.slideDown(200);
      }
    });

    // Trigger change on page load to set initial state
    $triggerRadios.filter(':checked').trigger('change');
  };

  /**
   * Handle slide-in auto-dismiss toggle
   */
  CTCAdmin.handleSlideInAutoDismiss = function () {
    var $autoDismissCheckbox = $('#slide-in-auto-dismiss-checkbox');
    if (!$autoDismissCheckbox.length) return;
    var $autoDismissDelayGroup = $('#cta-auto-dismiss-delay-group');

    // Handle checkbox changes
    $autoDismissCheckbox.on('change', function () {
      if ($(this).is(':checked')) {
        $autoDismissDelayGroup.slideDown(200);
      } else {
        $autoDismissDelayGroup.slideUp(200);
      }
    });

    // Trigger change on page load to set initial state
    $autoDismissCheckbox.trigger('change');
  };

  /**
   * Handle Visibility dropdown changes
   */
  CTCAdmin.handleVisibilityChange = function () {
    var $select = $('#cta-visibility');
    if (!$select.length) return;
    var $proBadge = $('#cta-visibility-pro-badge');
    var isPro = $select.data('is-pro') === 1;
    var $errorMsg = $('#cta-visibility-pro-error');

    // Gray out Pro options for free users
    if (!isPro) {
      $select.find('option[data-requires-pro="1"]').css({
        'color': '#999',
        'font-style': 'italic'
      });
    }

    // Handle dropdown changes
    $select.on('change', function () {
      var requiresPro = $(this).find('option:selected').data('requires-pro') === 1;

      // Show/hide PRO badge and error message
      if (requiresPro && !isPro) {
        $proBadge.fadeIn(200);
        $errorMsg.slideDown(200);
      } else {
        $proBadge.fadeOut(200);
        $errorMsg.slideUp(200);
      }
    });

    // Trigger change on page load to set initial state
    $select.trigger('change');
  };

  /**
   * Handle Button Icon dropdown changes
   */
  CTCAdmin.handleIconChange = function () {
    var $select = $('#cta-icon');
    if (!$select.length) return;
    var isPro = $select.data('is-pro') === 1;
    var $errorMsg = $('#cta-icon-pro-error');
    var previousValue = $select.val();
    if (!isPro) {
      $select.find('option[data-requires-pro="1"]').css({
        'color': '#999',
        'font-style': 'italic'
      });
    }
    $select.on('change', function () {
      var $selected = $(this).find('option:selected');
      var value = $(this).val();
      var requiresPro = $selected.data('requires-pro') === 1;
      var action = $selected.data('action');

      // Handle "Add Custom Icon" action
      if (action === 'add-icon') {
        // Revert to previous value
        $(this).val(previousValue);
        // Open the add icon modal
        CTCAdmin.openAddIconModalCTA();
        return;
      }

      // Store new value for next time
      previousValue = value;
      if (requiresPro && !isPro) {
        $errorMsg.slideDown(200);
      } else {
        $errorMsg.slideUp(200);
      }
    });
    $select.trigger('change');
  };

  /**
   * Open the Add Custom Icon modal from CTA Manager page
   */
  CTCAdmin.openAddIconModalCTA = function () {
    var $modal = $('#cta-add-icon-modal-cta');
    if (!$modal.length) return;

    // Reset form
    var $form = $('#cta-add-icon-form-cta');
    if ($form.length && $form[0]) {
      $form[0].reset();
    }
    $('#cta-icon-preview-group-cta').hide();
    $('#cta-icon-preview-cta').empty();
    $('#cta-add-icon-error-cta').hide().empty();
    $modal.addClass('is-open');
    $('body').css('overflow', 'hidden');
    $('#cta-icon-name-cta').focus();
  };

  /**
   * Close the Add Custom Icon modal from CTA Manager page
   */
  CTCAdmin.closeAddIconModalCTA = function () {
    var $modal = $('#cta-add-icon-modal-cta');
    $modal.removeClass('is-open');
    $('body').css('overflow', '');
  };

  /**
   * Initialize custom icon modal handlers for CTA Manager page
   */
  CTCAdmin.initCustomIconsCTA = function () {
    var self = this;
    var $modal = $('#cta-add-icon-modal-cta');
    if (!$modal.length) return;
    var ajaxUrl = window.ctaAdminVars ? window.ctaAdminVars.ajaxUrl : window.ajaxurl;
    var nonce = window.ctaAdminVars ? window.ctaAdminVars.nonce : $('#cta-cta-form input[name="nonce"]').val();

    // SVG preview on textarea change
    $('#cta-icon-svg-cta').on('input change', function () {
      var svg = $(this).val();
      var $previewGroup = $('#cta-icon-preview-group-cta');
      var $preview = $('#cta-icon-preview-cta');
      if (!svg || !svg.trim() || !/^<svg[\s>]/i.test(svg.trim())) {
        $previewGroup.hide();
        $preview.empty();
        return;
      }
      $previewGroup.show();
      $preview.html(svg);
    });

    // Form submission
    $('#cta-add-icon-form-cta').on('submit', function (e) {
      e.preventDefault();
      var $submitBtn = $('#cta-save-icon-btn-cta');
      var $btnText = $submitBtn.find('.cta-button-text');
      var $btnSpinner = $submitBtn.find('.cta-button-spinner');
      var $error = $('#cta-add-icon-error-cta');
      var iconName = $('#cta-icon-name-cta').val().trim();
      var iconSvg = $('#cta-icon-svg-cta').val().trim();

      // Validation
      if (!iconName) {
        $error.text('Icon name is required.').show();
        return;
      }
      if (!iconSvg || !/^<svg[\s>]/i.test(iconSvg) || !/<\/svg>\s*$/i.test(iconSvg)) {
        $error.text('Invalid SVG code. Please provide valid SVG markup.').show();
        return;
      }

      // Show loading state
      $submitBtn.prop('disabled', true);
      $btnText.hide();
      $btnSpinner.show();
      $error.hide();
      $.ajax({
        url: ajaxUrl,
        type: 'POST',
        dataType: 'json',
        data: {
          action: 'cta_add_custom_icon',
          nonce: nonce,
          icon_name: iconName,
          icon_svg: iconSvg
        },
        success: function (response) {
          if (response.success) {
            CTCAdmin.showNotice(response.data.message, 'success');
            // Update the icon dropdown with new icon and select it
            self.updateIconDropdown(response.data.icons, response.data.icon.id);
            self.closeAddIconModalCTA();
          } else {
            var message = response.data && response.data.message ? response.data.message : 'Failed to add icon.';
            $error.text(message).show();
          }
        },
        error: function () {
          $error.text('An error occurred while adding the icon.').show();
        },
        complete: function () {
          $submitBtn.prop('disabled', false);
          $btnText.show();
          $btnSpinner.hide();
        }
      });
    });

    // Modal close handlers
    $modal.on('click', '[data-close-modal]', function (e) {
      e.preventDefault();
      self.closeAddIconModalCTA();
    });

    // ESC key to close
    $(document).on('keydown.ctaIconModal', function (e) {
      if ((e.key === 'Escape' || e.keyCode === 27) && $modal.hasClass('is-open')) {
        self.closeAddIconModalCTA();
      }
    });
  };

  /**
   * Update the icon dropdown with new icons
   */
  CTCAdmin.updateIconDropdown = function (icons, selectId) {
    var $select = $('#cta-icon');
    if (!$select.length) return;
    var isPro = $select.data('is-pro') === 1;

    // Find or create the Custom Icons optgroup
    var $customGroup = $select.find('optgroup[label="Custom Icons"]');
    if (!$customGroup.length) {
      // Insert after "None" option, before Built-in Icons
      var $builtInGroup = $select.find('optgroup[label="Built-in Icons"]');
      if ($builtInGroup.length) {
        $customGroup = $('<optgroup label="Custom Icons"></optgroup>');
        $builtInGroup.before($customGroup);
      }
    }

    // Clear existing custom icons
    $customGroup.empty();

    // Add custom icons
    if (icons && icons.length > 0) {
      icons.forEach(function (icon) {
        var label = icon.name + (isPro ? '' : ' (Pro)');
        var $option = $('<option>').val(icon.id).text(label).attr('data-requires-pro', '1').attr('data-is-custom', '1');
        $customGroup.append($option);
      });
      $customGroup.show();
    } else {
      $customGroup.hide();
    }

    // Select the new icon if provided
    if (selectId) {
      $select.val(selectId).trigger('change');
    }
  };

  /**
   * Handle Animation dropdown changes
   */
  CTCAdmin.handleAnimationChange = function (selectId, errorId) {
    var $select = $(selectId);
    if (!$select.length) return;
    var isPro = $select.data('is-pro') === 1;
    var $errorMsg = $(errorId);
    if (!isPro) {
      $select.find('option[data-requires-pro="1"]').css({
        'color': '#999',
        'font-style': 'italic'
      });
    }
    $select.on('change', function () {
      var requiresPro = $(this).find('option:selected').data('requires-pro') === 1;
      if (requiresPro && !isPro) {
        $errorMsg.slideDown(200);
      } else {
        $errorMsg.slideUp(200);
      }
    });
    $select.trigger('change');
  };

  /**
   * Handle CTA data attributes
   */
  CTCAdmin.handleDataAttributes = function () {
    var $container = $('#cta-data-attributes');
    if (!$container.length) return;
    var isPro = $container.data('is-pro') === 1;
    var $addButton = $('.cta-add-attribute');
    if (!isPro) {
      return;
    }
    $addButton.on('click', function (e) {
      e.preventDefault();
      var $row = $('<div class="cta-data-attribute-row">' + '<input type="text" name="cta_data_attribute_key[]" placeholder="data-attr" />' + '<input type="text" name="cta_data_attribute_value[]" placeholder="Value" />' + '<button type="button" class="cta-button-link cta-remove-attribute">Remove</button>' + '</div>');
      $container.append($row);
    });
    $container.on('click', '.cta-remove-attribute', function (e) {
      e.preventDefault();
      var $rows = $container.find('.cta-data-attribute-row');
      if ($rows.length <= 1) {
        $rows.find('input').val('');
        return;
      }
      $(this).closest('.cta-data-attribute-row').remove();
    });
  };

  /**
   * Check if CTA form has Pro-only options selected on submit
   */
  CTCAdmin.checkCtaProOnSubmit = function () {
    var $layoutSelect = $('#cta-layout');
    var $typeSelect = $('#cta-type');
    var $visibilitySelect = $('#cta-visibility');
    var $iconSelect = $('#cta-icon');
    var $buttonAnimationSelect = $('#button-animation');
    var $iconAnimationSelect = $('#icon-animation');
    if (!$layoutSelect.length || !$typeSelect.length || !$visibilitySelect.length || !$iconSelect.length || !$buttonAnimationSelect.length || !$iconAnimationSelect.length) {
      return true; // Allow submission if elements not found
    }
    var isPro = $layoutSelect.data('is-pro') === 1;
    var layoutRequiresPro = $layoutSelect.find('option:selected').data('requires-pro') === 1;
    var typeRequiresPro = $typeSelect.find('option:selected').data('requires-pro') === 1;
    var visibilityRequiresPro = $visibilitySelect.find('option:selected').data('requires-pro') === 1;
    var iconRequiresPro = $iconSelect.find('option:selected').data('requires-pro') === 1;
    var buttonAnimationRequiresPro = $buttonAnimationSelect.find('option:selected').data('requires-pro') === 1;
    var iconAnimationRequiresPro = $iconAnimationSelect.find('option:selected').data('requires-pro') === 1;

    // If free user selected Pro option, show modal
    if (!isPro && (layoutRequiresPro || typeRequiresPro || visibilityRequiresPro || iconRequiresPro || buttonAnimationRequiresPro || iconAnimationRequiresPro)) {
      CTCAdmin.showProUpgradeModal();
      return false; // Prevent form submission
    }
    return true; // Allow submission
  };

  /**
   * ========================================
   * Analytics Retention Settings
   * ======================================== */

  /**
   * Handle analytics retention dropdown changes
   */
  CTCAdmin.handleRetentionChange = function () {
    var $select = $('#analytics-retention');
    var $customWrapper = $('#cta-custom-retention-wrapper');
    var $proBadge = $('#cta-retention-pro-badge');
    var isPro = $select.data('is-pro') === 1;
    var $errorMsg = $('#cta-retention-pro-error');

    // Gray out Pro options for free users
    if (!isPro) {
      $select.find('option[data-requires-pro="1"]').css({
        'color': '#999',
        'font-style': 'italic'
      });
    }

    // Handle dropdown changes
    $select.on('change', function () {
      var selectedValue = $(this).val();
      var requiresPro = $(this).find('option:selected').data('requires-pro') === 1;

      // Show/hide custom input
      if (selectedValue === 'custom') {
        $customWrapper.slideDown(300);
        $('#analytics-retention-custom-days').focus();
      } else {
        $customWrapper.slideUp(300);
      }

      // Show/hide PRO badge and error message
      if (requiresPro && !isPro) {
        $proBadge.fadeIn(200);
        if ($errorMsg.length === 0) {
          // Create error message if it doesn't exist
          $errorMsg = $('<p id="cta-retention-pro-error" class="cta-error-text" style="display:none; color: #dc3232; margin-top: 8px; font-weight: 500;"><span class="dashicons dashicons-warning" style="font-size: 16px; vertical-align: middle;"></span> This feature requires CTA Manager Pro. Please upgrade or select a free option.</p>');
          $select.after($errorMsg);
        }
        $errorMsg.slideDown(200);
      } else {
        $proBadge.fadeOut(200);
        if ($errorMsg.length) {
          $errorMsg.slideUp(200);
        }
      }
    });

    // Trigger change on page load to set initial state
    $select.trigger('change');
  };

  /**
   * Check if retention requires Pro on form submit
   */
  CTCAdmin.checkRetentionProOnSubmit = function ($form) {
    var $select = $('#analytics-retention');
    var isPro = $select.data('is-pro') === 1;
    var selectedValue = $select.val();
    var requiresPro = $select.find('option:selected').data('requires-pro') === 1;

    // If free user selected Pro option, show modal
    if (!isPro && requiresPro) {
      CTCAdmin.showProUpgradeModal();
      return false; // Prevent form submission
    }
    return true; // Allow submission
  };

  /**
   * Pro Upgrade Modal Functions
   * Moved to cta-pro-upsell.js for better code organization
   */

  // Initialize retention dropdown on document ready
  $(function () {
    if ($('#analytics-retention').length) {
      CTCAdmin.handleRetentionChange();

      // Intercept settings form submission
      $('#cta-settings-form').on('submit', function (e) {
        if (!CTCAdmin.checkRetentionProOnSubmit($(this))) {
          e.preventDefault();
          e.stopImmediatePropagation();
          return false;
        }
      });
    }

    // Initialize CTA form Pro option handlers
    if ($('#cta-cta-form').length) {
      CTCAdmin.handleLayoutChange();
      CTCAdmin.handleTypeChange();
      CTCAdmin.handleVisibilityChange();
      CTCAdmin.handleIconChange();
      CTCAdmin.initCustomIconsCTA();
      CTCAdmin.handleAnimationChange('#button-animation', '#cta-button-animation-pro-error');
      CTCAdmin.handleAnimationChange('#icon-animation', '#cta-icon-animation-pro-error');
      CTCAdmin.handleSlideInTriggerChange();
      CTCAdmin.handleSlideInAutoDismiss();
      CTCAdmin.handleDataAttributes();

      // Initialize live preview updates
      CTCAdmin.bindPreviewUpdates();

      // Intercept CTA form submission
      $('#cta-cta-form').on('submit', function (e) {
        // Check Pro validations
        if (!CTCAdmin.checkCtaProOnSubmit()) {
          e.preventDefault();
          e.stopImmediatePropagation();
          return false;
        }

        // Clear Title, Tagline, and Body Text for free users (allow them to preview but not save)
        var $layoutSelect = $('#cta-layout');
        var isPro = $layoutSelect.data('is-pro') === 1;
        if (!isPro) {
          $('#cta-title').val('');
          $('#cta-tagline').val('');
          $('#cta-body-text').val('');

          // Also clear all the formatting hidden fields
          $('#title_font_size, #title_font_family, #title_font_weight, #title_color, #title_alignment').val('');
          $('#tagline_font_size, #tagline_font_family, #tagline_font_weight, #tagline_color, #tagline_alignment').val('');
          $('#body_font_size, #body_font_family, #body_font_weight, #body_color, #body_alignment').val('');
        }
      });
    }

    // Pro Upgrade Button & Modal Handlers - Moved to cta-pro-upsell.js

    // Inline Pro license activation (when Pro addon is present)
    var $licenseSection = $('#cta-inline-license');
    if ($licenseSection.length) {
      // Prevent multiple initializations
      if ($licenseSection.data('cta-license-initialized')) {
        return;
      }
      $licenseSection.data('cta-license-initialized', true);
      var $keyInput = $('#cta-pro-license-key');
      var $statusBadge = $('#cta-license-status-badge');
      var $activateBtn = $('#cta-license-activate');
      var $deactivateBtn = $('#cta-license-deactivate');
      var ajaxUrl = window.ajaxurl || window.ctaAdminVars && window.ctaAdminVars.ajaxUrl || '';
      var nonce = $('#cta-settings-form input[name="nonce"]').val() || $('input[name="nonce"]').val();
      var activateLabel = $activateBtn.text();
      var deactivateLabel = $deactivateBtn.length ? $deactivateBtn.text() : 'Deactivate';
      var i18n = window.ctaAdminVars && window.ctaAdminVars.i18n || {};

      // License key minimum length (XXXX-XXXX-XXXX-XXXX = 19 chars)
      var minLength = parseInt($licenseSection.attr('data-min-length'), 10) || 19;
      var currentStatus = $licenseSection.attr('data-license-status') || 'inactive';

      // Debounce timer for input validation
      var validationTimer = null;

      // Function to validate license key length and enable/disable activate button
      function validateLicenseKey() {
        var key = ($keyInput.val() || '').trim();
        var isValidLength = key.length >= minLength;
        var isActive = currentStatus === 'active';

        // Only disable button if not already active and key is too short
        if (!isActive && !isValidLength) {
          $activateBtn.prop('disabled', true);
        } else {
          $activateBtn.prop('disabled', false);
        }
      }

      // Debounced validation to prevent excessive calls
      function debouncedValidate() {
        clearTimeout(validationTimer);
        validationTimer = setTimeout(function () {
          validateLicenseKey();
        }, 150);
      }

      // Validate on input change (debounced to prevent flashing)
      $keyInput.on('input keyup paste', function () {
        debouncedValidate();
      });

      // Initial validation on page load
      validateLicenseKey();
      function updateStatus(status, message) {
        var statusConfig = {
          'active': {
            label: i18n.activeLabel || 'Active',
            badgeClass: 'cta-badge-success',
            defaultMessage: 'License is active on this site.',
            enableDeactivate: true
          },
          'inactive': {
            label: i18n.inactiveLabel || 'Inactive',
            badgeClass: 'cta-badge-secondary',
            defaultMessage: 'Enter your license key to activate Pro features.',
            enableDeactivate: false
          },
          'expired': {
            label: 'Expired',
            badgeClass: 'cta-badge-danger',
            defaultMessage: 'Your license has expired. Please renew to continue using Pro features.',
            enableDeactivate: false
          },
          'revoked': {
            label: 'Revoked',
            badgeClass: 'cta-badge-danger',
            defaultMessage: 'License has been revoked. Please contact support for assistance.',
            enableDeactivate: false
          },
          'limit_reached': {
            label: 'Limit Reached',
            badgeClass: 'cta-badge-warning',
            defaultMessage: 'Domain activation limit reached. Deactivate another domain to activate on this site.',
            enableDeactivate: true
          }
        };
        var config = statusConfig[status] || statusConfig['inactive'];
        currentStatus = status;

        // Update badge with appropriate class and text
        $statusBadge.text(config.label).removeClass('cta-badge-success cta-badge-secondary cta-badge-danger cta-badge-warning').addClass(config.badgeClass);

        // Update deactivate button state
        if ($deactivateBtn.length) {
          $deactivateBtn.prop('disabled', !config.enableDeactivate);
        }

        // Update data attribute for potential CSS hooks
        $licenseSection.attr('data-license-status', status);
      }
      $activateBtn.on('click', function () {
        var key = ($keyInput.val() || '').trim();
        if (!key) {
          return;
        }
        if (key.length < minLength) {
          return;
        }
        $activateBtn.prop('disabled', true).text(i18n.activating || 'Activating...');
        $.post(ajaxUrl, {
          action: 'cta_pro_activate_license',
          nonce: nonce,
          license_key: key
        }).done(function (resp) {
          if (resp && resp.success) {
            updateStatus('active', resp.data && resp.data.message ? resp.data.message : i18n.success || 'License activated.');
            // Delay reload to allow user to see success message and prevent flashing
            setTimeout(function () {
              window.location.reload();
            }, 1500);
          } else {
            updateStatus('inactive', resp && resp.data && resp.data.message ? resp.data.message : i18n.error || 'Activation failed.');
          }
        }).fail(function () {
          updateStatus('inactive', i18n.error || 'Activation failed.');
        }).always(function () {
          $activateBtn.text(activateLabel);
          validateLicenseKey();
        });
      });
      if ($deactivateBtn.length) {
        $deactivateBtn.on('click', function () {
          $deactivateBtn.prop('disabled', true).text(i18n.deactivating || 'Deactivating...');
          $.post(ajaxUrl, {
            action: 'cta_pro_deactivate_license',
            nonce: nonce
          }).done(function (resp) {
            if (resp && resp.success) {
              updateStatus('inactive', resp.data && resp.data.message ? resp.data.message : i18n.success || 'License deactivated.');
              // Delay reload to allow user to see success message and prevent flashing
              setTimeout(function () {
                window.location.reload();
              }, 1500);
            } else {
              updateStatus('active', resp && resp.data && resp.data.message ? resp.data.message : i18n.error || 'Could not deactivate.');
              $deactivateBtn.prop('disabled', false).text(deactivateLabel);
            }
          }).fail(function () {
            updateStatus('active', i18n.error || 'Could not deactivate.');
            $deactivateBtn.prop('disabled', false).text(deactivateLabel);
          });
        });
      }

      // Handle "Remove License" button - opens confirmation modal
      var $removeBtn = $('#cta-license-remove');
      if ($removeBtn.length) {
        $removeBtn.on('click', function (e) {
          e.preventDefault();
          var modalTarget = $(this).data('modal-target');
          if (modalTarget) {
            if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
              window.ctaModalAPI.open(modalTarget);
            } else {
              $(modalTarget).fadeIn(200);
              $('body').addClass('cta-modal-open');
            }
          }
        });
      }

      // Handle "Confirm Remove License" button in modal
      var $confirmRemoveBtn = $('#cta-confirm-remove-license');
      if ($confirmRemoveBtn.length) {
        $confirmRemoveBtn.on('click', function () {
          var originalText = $confirmRemoveBtn.text();
          $confirmRemoveBtn.prop('disabled', true).text(i18n.removing || 'Removing...');
          $.post(ajaxUrl, {
            action: 'cta_pro_deactivate_license',
            nonce: nonce
          }).done(function (resp) {
            if (resp && resp.success) {
              if (window.CTAToast) {
                CTAToast.success(resp.data && resp.data.message ? resp.data.message : i18n.success || 'License removed successfully.');
              }
              // Close modal and reload page
              var $modal = $('#cta-remove-license-modal');
              if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
                window.ctaModalAPI.close($modal);
              } else {
                $modal.fadeOut(200);
                $('body').removeClass('cta-modal-open');
              }
              // Delay reload to allow user to see success message
              setTimeout(function () {
                window.location.reload();
              }, 1500);
            } else {
              if (window.CTAToast) {
                CTAToast.error(resp && resp.data && resp.data.message ? resp.data.message : i18n.error || 'Could not remove license.');
              }
              $confirmRemoveBtn.prop('disabled', false).text(originalText);
            }
          }).fail(function () {
            if (window.CTAToast) {
              CTAToast.error(i18n.error || 'Could not remove license.');
            }
            $confirmRemoveBtn.prop('disabled', false).text(originalText);
          });
        });
      }
    }
  });
})(window.jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTCAdmin);

/***/ }),

/***/ "./assets/js/admin/modules/pages/support.js":
/*!**************************************************!*\
  !*** ./assets/js/admin/modules/pages/support.js ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Priority Support Page JavaScript
 *
 * Handles support ticket submission and management.
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

let CTASupport;
(function ($) {
  'use strict';

  // Define support module and assign to hoisted variable
  CTASupport = {
    /**
     * Initialize
     */
    init: function () {
      this.bindEvents();
    },
    /**
     * Bind event handlers
     */
    bindEvents: function () {
      // Open new ticket modal
      $(document).on('click', '#cta-new-ticket-btn', this.openNewTicketModal.bind(this));

      // Close modal
      $(document).on('click', '.cta-modal-close, .cta-modal-overlay', this.closeModal.bind(this));

      // Submit new ticket
      $(document).on('submit', '#cta-support-ticket-form', this.submitTicket.bind(this));

      // Submit reply
      $(document).on('submit', '#cta-ticket-reply-form', this.submitReply.bind(this));
    },
    /**
     * Open new ticket modal
     */
    openNewTicketModal: function (e) {
      e.preventDefault();
      var target = '#cta-new-ticket-modal';
      if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
        window.ctaModalAPI.open(target);
      } else {
        $(target).fadeIn(200);
        $('body').addClass('cta-modal-open');
      }
    },
    /**
     * Close modal
     */
    closeModal: function (e) {
      if (e.target !== e.currentTarget) {
        return;
      }
      var target = '#cta-new-ticket-modal';
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close(target);
      } else {
        $(target).fadeOut(200, function () {
          if (!$('.cta-modal:visible').not(target).length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }

      // Reset form
      var $form = $('#cta-support-ticket-form');
      if ($form.length && $form[0]) {
        $form[0].reset();
      }
      $('#cta-ticket-form-message').hide().removeClass('cta-message--success cta-message--error');
    },
    /**
     * Submit new ticket
     */
    submitTicket: function (e) {
      e.preventDefault();
      const $form = $('#cta-support-ticket-form');
      const $submitBtn = $('#cta-submit-ticket-btn');
      const $message = $('#cta-ticket-form-message');

      // Get form data
      const formData = {
        action: 'cta_submit_support_ticket',
        nonce: $form.find('input[name="cta_support_nonce"]').val(),
        subject: $form.find('input[name="subject"]').val(),
        description: $form.find('textarea[name="description"]').val(),
        priority: $form.find('select[name="priority"]').val()
      };

      // Disable submit button
      $submitBtn.prop('disabled', true).text(cta_support_vars.submitting_text || 'Submitting...');
      $message.hide();

      // Submit AJAX request
      $.ajax({
        url: ajaxurl,
        type: 'POST',
        data: formData,
        success: function (response) {
          if (response.success) {
            $message.removeClass('cta-message--error').addClass('cta-message--success').html('<span class="dashicons dashicons-yes-alt"></span> ' + response.data.message).fadeIn();

            // Reset form
            $form[0].reset();

            // Close modal after delay and reload
            setTimeout(function () {
              if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
                window.ctaModalAPI.close('#cta-new-ticket-modal');
              } else {
                $('#cta-new-ticket-modal').fadeOut(200, function () {
                  if (!$('.cta-modal:visible').not('#cta-new-ticket-modal').length) {
                    $('body').removeClass('cta-modal-open');
                  }
                });
              }
              location.reload();
            }, 1500);
          } else {
            CTASupport.showError($message, response.data.message || 'Failed to submit ticket.');
          }
        },
        error: function (xhr) {
          let errorMessage = 'An error occurred. Please try again.';
          if (xhr.responseJSON && xhr.responseJSON.data && xhr.responseJSON.data.message) {
            errorMessage = xhr.responseJSON.data.message;
          }
          CTASupport.showError($message, errorMessage);
        },
        complete: function () {
          $submitBtn.prop('disabled', false).text(cta_support_vars.submit_text || 'Submit Ticket');
        }
      });
    },
    /**
     * Submit reply
     */
    submitReply: function (e) {
      e.preventDefault();
      const $form = $('#cta-ticket-reply-form');
      const $submitBtn = $('#cta-submit-reply-btn');
      const $message = $('#cta-reply-form-message');

      // Get form data
      const formData = {
        action: 'cta_submit_support_reply',
        nonce: $form.find('input[name="cta_support_reply_nonce"]').val(),
        ticket_id: $form.find('input[name="ticket_id"]').val(),
        message: $form.find('textarea[name="message"]').val()
      };

      // Validate message
      if (!formData.message || formData.message.trim().length < 5) {
        CTASupport.showError($message, 'Reply must be at least 5 characters long.');
        return;
      }

      // Disable submit button
      $submitBtn.prop('disabled', true).text(cta_support_vars.sending_text || 'Sending...');
      $message.hide();

      // Submit AJAX request
      $.ajax({
        url: ajaxurl,
        type: 'POST',
        data: formData,
        success: function (response) {
          if (response.success) {
            $message.removeClass('cta-message--error').addClass('cta-message--success').html('<span class="dashicons dashicons-yes-alt"></span> ' + response.data.message).fadeIn();

            // Reset form
            $form[0].reset();

            // Reload page after delay to show new reply
            setTimeout(function () {
              location.reload();
            }, 1000);
          } else {
            CTASupport.showError($message, response.data.message || 'Failed to submit reply.');
          }
        },
        error: function (xhr) {
          let errorMessage = 'An error occurred. Please try again.';
          if (xhr.responseJSON && xhr.responseJSON.data && xhr.responseJSON.data.message) {
            errorMessage = xhr.responseJSON.data.message;
          }
          CTASupport.showError($message, errorMessage);
        },
        complete: function () {
          $submitBtn.prop('disabled', false).text(cta_support_vars.send_text || 'Send Reply');
        }
      });
    },
    /**
     * Show error message
     */
    showError: function ($element, message) {
      $element.removeClass('cta-message--success').addClass('cta-message--error').html('<span class="dashicons dashicons-warning"></span> ' + message).fadeIn();
    }
  };

  // Initialize on document ready
  $(document).ready(function () {
    CTASupport.init();
    window.CTASupport = CTASupport;
  });
})(jQuery);

// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTASupport);

/***/ }),

/***/ "./assets/js/admin/modules/partials/accordion.js":
/*!*******************************************************!*\
  !*** ./assets/js/admin/modules/partials/accordion.js ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Accordion Component
 *
 * Reusable accordion component with single-open behavior.
 * Handles toggle interactions and ARIA accessibility attributes.
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function () {
  const accordions = document.querySelectorAll('[data-cta-accordion]');
  if (!accordions.length) return;
  accordions.forEach(accordion => {
    accordion.addEventListener('click', event => {
      const trigger = event.target.closest('.cta-accordion__trigger');
      if (!trigger || !accordion.contains(trigger)) return;
      const item = trigger.closest('.cta-accordion__item');
      const panelId = trigger.getAttribute('aria-controls');
      const panel = panelId ? document.getElementById(panelId) : null;

      // Close all other items (single-open behavior)
      accordion.querySelectorAll('.cta-accordion__item').forEach(el => {
        if (el !== item) {
          el.classList.remove('is-open');
          const btn = el.querySelector('.cta-accordion__trigger');
          const pnl = btn ? document.getElementById(btn.getAttribute('aria-controls')) : null;
          if (btn) btn.setAttribute('aria-expanded', 'false');
          if (pnl) pnl.hidden = true;
        }
      });
      const isOpen = item.classList.toggle('is-open');
      trigger.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
      if (panel) {
        panel.hidden = !isOpen;
      }
    });
  });
})();
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/admin/modules/partials/components.js":
/*!********************************************************!*\
  !*** ./assets/js/admin/modules/partials/components.js ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Shared component behaviors
 *
 * Handles clipboard copying for shortcode examples and other reusable UI actions.
 */
(function ($) {
  'use strict';

  function bindShortcodeCopy() {
    $(document).on('click', '.cta-shortcode-copy', function (e) {
      e.preventDefault();
      var text = $(this).data('copy') || '';
      if (!text) return;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text);
      } else {
        var $temp = $('<textarea style="position:absolute;left:-9999px;top:-9999px;"></textarea>').val(text);
        $('body').append($temp);
        $temp[0].select();
        document.execCommand('copy');
        $temp.remove();
      }
    });
  }
  $(function () {
    bindShortcodeCopy();
  });
})(jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/admin/modules/partials/debug.js":
/*!***************************************************!*\
  !*** ./assets/js/admin/modules/partials/debug.js ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Debug Utility
 *
 * Provides console logging when debug mode is enabled.
 * All methods are no-ops when debug mode is disabled.
 */

(function (window) {
  'use strict';

  /**
   * Check if debug mode is enabled
   * @returns {boolean}
   */
  function isDebugEnabled() {
    return !!(window.ctaAdminVars && window.ctaAdminVars.debug || window.ctaPublic && window.ctaPublic.debug || window.ctaTrackerVars && window.ctaTrackerVars.debug);
  }

  /**
   * Format log prefix with timestamp
   * @param {string} context - Optional context category
   * @returns {string}
   */
  function getPrefix(context) {
    var now = new Date();
    var time = now.toTimeString().split(' ')[0];
    var prefix = '%c[CTA ' + time + ']';
    if (context) {
      prefix += ' [' + context.toUpperCase() + ']';
    }
    return prefix;
  }

  /**
   * Console style for debug messages
   */
  var styles = {
    log: 'color: #6366f1; font-weight: bold;',
    info: 'color: #0ea5e9; font-weight: bold;',
    warn: 'color: #f59e0b; font-weight: bold;',
    error: 'color: #ef4444; font-weight: bold;',
    success: 'color: #22c55e; font-weight: bold;',
    timing: 'color: #8b5cf6; font-weight: bold;'
  };

  /**
   * Debug utility object
   */
  var CTADebug = {
    /**
     * Check if debug mode is enabled
     * @returns {boolean}
     */
    isEnabled: function () {
      return isDebugEnabled();
    },
    /**
     * Log a debug message
     * @param {string} message - Message to log
     * @param {string} [context] - Optional context category
     * @param {...*} [args] - Additional arguments to log
     */
    log: function (message, context) {
      if (!isDebugEnabled()) return;
      var args = Array.prototype.slice.call(arguments, 2);
      console.log.apply(console, [getPrefix(context), styles.log, message].concat(args));
    },
    /**
     * Log an info message
     * @param {string} message - Message to log
     * @param {string} [context] - Optional context category
     * @param {...*} [args] - Additional arguments to log
     */
    info: function (message, context) {
      if (!isDebugEnabled()) return;
      var args = Array.prototype.slice.call(arguments, 2);
      console.info.apply(console, [getPrefix(context), styles.info, message].concat(args));
    },
    /**
     * Log a warning message
     * @param {string} message - Message to log
     * @param {string} [context] - Optional context category
     * @param {...*} [args] - Additional arguments to log
     */
    warn: function (message, context) {
      if (!isDebugEnabled()) return;
      var args = Array.prototype.slice.call(arguments, 2);
      console.warn.apply(console, [getPrefix(context), styles.warn, message].concat(args));
    },
    /**
     * Log an error message
     * @param {string} message - Message to log
     * @param {string} [context] - Optional context category
     * @param {...*} [args] - Additional arguments to log
     */
    error: function (message, context) {
      if (!isDebugEnabled()) return;
      var args = Array.prototype.slice.call(arguments, 2);
      console.error.apply(console, [getPrefix(context), styles.error, message].concat(args));
    },
    /**
     * Log a success message
     * @param {string} message - Message to log
     * @param {string} [context] - Optional context category
     * @param {...*} [args] - Additional arguments to log
     */
    success: function (message, context) {
      if (!isDebugEnabled()) return;
      var args = Array.prototype.slice.call(arguments, 2);
      console.log.apply(console, [getPrefix(context), styles.success, 'â ' + message].concat(args));
    },
    /**
     * Log AJAX request/response
     * @param {string} action - AJAX action name
     * @param {string} phase - 'request' or 'response'
     * @param {Object} data - Request/response data
     */
    ajax: function (action, phase, data) {
      if (!isDebugEnabled()) return;
      var icon = phase === 'request' ? 'â' : 'â';
      console.log(getPrefix('ajax'), styles.log, icon + ' ' + action, data);
    },
    /**
     * Log a group of related messages
     * @param {string} label - Group label
     * @param {Function} callback - Callback that logs group contents
     */
    group: function (label, callback) {
      if (!isDebugEnabled()) return;
      console.group(getPrefix(), styles.log, label);
      try {
        callback();
      } finally {
        console.groupEnd();
      }
    },
    /**
     * Log a collapsed group
     * @param {string} label - Group label
     * @param {Function} callback - Callback that logs group contents
     */
    groupCollapsed: function (label, callback) {
      if (!isDebugEnabled()) return;
      console.groupCollapsed(getPrefix(), styles.log, label);
      try {
        callback();
      } finally {
        console.groupEnd();
      }
    },
    /**
     * Log a table of data
     * @param {Array|Object} data - Data to display as table
     * @param {string} [label] - Optional label
     */
    table: function (data, label) {
      if (!isDebugEnabled()) return;
      if (label) {
        console.log(getPrefix(), styles.log, label);
      }
      console.table(data);
    },
    /**
     * Start a timer
     * @param {string} label - Timer label
     */
    time: function (label) {
      if (!isDebugEnabled()) return;
      console.time('[CTA] ' + label);
    },
    /**
     * End a timer and log duration
     * @param {string} label - Timer label
     */
    timeEnd: function (label) {
      if (!isDebugEnabled()) return;
      console.timeEnd('[CTA] ' + label);
    },
    /**
     * Log timing information
     * @param {string} label - Operation label
     * @param {number} startTime - Performance.now() start time
     */
    timing: function (label, startTime) {
      if (!isDebugEnabled()) return;
      var duration = (performance.now() - startTime).toFixed(2);
      console.log(getPrefix('timing'), styles.timing, label + ' completed in ' + duration + 'ms');
    },
    /**
     * Assert a condition and log error if false
     * @param {boolean} condition - Condition to check
     * @param {string} message - Error message if condition is false
     */
    assert: function (condition, message) {
      if (!isDebugEnabled()) return;
      console.assert(condition, getPrefix(), styles.error, message);
    },
    /**
     * Dump an object with label
     * @param {string} label - Object label
     * @param {*} obj - Object to dump
     */
    dump: function (label, obj) {
      if (!isDebugEnabled()) return;
      console.log(getPrefix('dump'), styles.log, label + ':');
      console.dir(obj);
    },
    /**
     * Log a stack trace
     * @param {string} [message] - Optional message
     */
    trace: function (message) {
      if (!isDebugEnabled()) return;
      console.log(getPrefix('trace'), styles.log, message || 'Stack trace:');
      console.trace();
    },
    /**
     * Clear the console
     */
    clear: function () {
      if (!isDebugEnabled()) return;
      console.clear();
      console.log(getPrefix(), styles.log, 'Console cleared');
    },
    /**
     * Get current debug state info
     * @returns {Object}
     */
    getState: function () {
      return {
        enabled: isDebugEnabled(),
        adminVars: !!window.ctaAdminVars,
        publicVars: !!window.ctaPublic,
        trackerVars: !!window.ctaTrackerVars
      };
    }
  };

  // Log debug mode status on load
  if (isDebugEnabled()) {
    console.log('%c[CTA Manager Debug Mode Enabled]', 'background: #6366f1; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;');
  }

  // Expose globally
  window.CTADebug = CTADebug;
})(window);

// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (window.CTADebug);

/***/ }),

/***/ "./assets/js/admin/modules/partials/modal-shell.js":
/*!*********************************************************!*\
  !*** ./assets/js/admin/modules/partials/modal-shell.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Modal Shell Helpers
 *
 * Provides open/close behavior for modals built with the shared modal partial.
 * Fires ctaModalOpened and ctaModalClosed events for individual modals to handle.
 */
(function ($) {
  'use strict';

  /**
   * Reset form fields, status messages, and tab state within a modal
   */
  function resetModalState($modal) {
    // Reset tabs to first
    resetModalTabs($modal);

    // Reset any forms inside the modal to their default values
    $modal.find('form').each(function () {
      if (typeof this.reset === 'function') {
        this.reset();
      }
    });

    // Clear status / error indicators
    var $statusBlocks = $modal.find('.cta-status-message, .cta-import-error, .cta-import-status, .cta-onboarding-import-status, .cta-onboarding-demo-status, .cta-modal-error, .cta-modal-success');
    $statusBlocks.removeClass('status-loading status-success status-error').hide().empty();

    // Hide any selected file UI and show default wrappers
    $modal.find('.cta-file-selected, [id$="-file-selected"]').hide();
    $modal.find('.cta-file-wrapper, [id$="-file-wrapper"]').show();
    $modal.find('.cta-import-actions, [id$="-import-actions"]').hide();

    // Remove error highlighting on inputs
    $modal.find('.is-error, .has-error').removeClass('is-error has-error');
    $modal.find('.cta-input-error').empty().hide();

    // Scroll modal content back to top
    $modal.scrollTop(0);
  }

  /**
   * Reset tabs within a modal to the first tab
   */
  function resetModalTabs($modal) {
    var $tabs = $modal.find('.cta-tabs, .cta-tabs__nav');
    var $tabPanels = $modal.find('.cta-tab-panels');
    if (!$tabs.length) return;

    // Reset tab links to first active
    var $tabLinks = $tabs.find('.cta-tab-link');
    $tabLinks.removeClass('is-active').attr('aria-selected', 'false');
    $tabLinks.first().addClass('is-active').attr('aria-selected', 'true');

    // Reset tab panels to first active
    var $panels = $tabPanels.find('.cta-tab-panel');
    $panels.removeClass('is-active');
    $panels.first().addClass('is-active');
  }
  function closeModal($modal) {
    $modal.fadeOut(150, function () {
      // Reset modal state after it is hidden
      resetModalState($modal);

      // Fire closed event with modal ID for individual handlers
      var modalId = $modal.attr('id') || '';
      $(document).trigger('ctaModalClosed', [$modal, modalId]);
    });
    $('body').removeClass('cta-modal-open');
  }
  function openModal($modal) {
    // Reset modal state before showing (ensures fresh state)
    resetModalState($modal);
    $modal.fadeIn(150);
    $('body').addClass('cta-modal-open');

    // Fire opened event with $modal and modal ID for individual handlers
    var modalId = $modal.attr('id') || '';
    $(document).trigger('ctaModalOpened', [$modal, modalId]);
  }
  $(function () {
    $(document).on('click', '[data-open-modal]', function (e) {
      e.preventDefault();
      var target = $(this).data('open-modal');
      if (!target) return;
      var $modal = $(target);
      if ($modal.length) {
        openModal($modal);
      }
    });
    $(document).on('click', '.cta-modal [data-close-modal], .cta-modal .cta-modal-overlay', function (e) {
      e.preventDefault();
      var $modal = $(this).closest('.cta-modal');
      closeModal($modal);
    });
    $(document).on('keydown', function (e) {
      if (e.key === 'Escape') {
        $('.cta-modal:visible').each(function () {
          closeModal($(this));
        });
      }
    });

    // Check for modal parameter in URL to auto-open modals
    var urlParams = new URLSearchParams(window.location.search);
    var modalId = urlParams.get('modal');
    if (modalId) {
      // Ensure modal ID has # prefix for jQuery selector
      var modalSelector = modalId.startsWith('#') ? modalId : '#' + modalId;
      var $modal = $(modalSelector);
      if ($modal.length && $modal.hasClass('cta-modal')) {
        // Small delay to ensure all modal content is fully loaded
        setTimeout(function () {
          openModal($modal);
        }, 150);

        // Clean up URL without page reload for better UX
        if (window.history && window.history.replaceState) {
          var cleanUrl = window.location.pathname + window.location.search.replace(/[?&]modal=[^&]+/, '').replace(/^&/, '?');
          window.history.replaceState({}, '', cleanUrl || window.location.pathname);
        }
      }
    }
  });

  // Expose modal API globally
  window.ctaModalAPI = {
    open: openModal,
    close: closeModal,
    resetTabs: resetModalTabs
  };
})(jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/admin/modules/partials/notifications.js":
/*!***********************************************************!*\
  !*** ./assets/js/admin/modules/partials/notifications.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager Notifications System
 *
 * Handles notification panel interactions, loading, and deletion.
 * Initial notifications are rendered server-side for instant display.
 * AJAX is used to refresh notifications when panel is re-opened.
 *
 * @since 1.0.0
 */



const NotificationsManager = {
  panelElement: null,
  overlayElement: null,
  listElement: null,
  loadingElement: null,
  emptyElement: null,
  isLoading: false,
  isOpen: false,
  hasOpened: false,
  // Track if panel has been opened before

  /**
   * Initialize the notifications system
   */
  init() {
    this.cacheDom();
    if (!this.panelElement) return;
    this.bindEvents();
    this.updateNotificationCount();
  },
  /**
   * Cache DOM elements
   */
  cacheDom() {
    this.panelElement = document.getElementById('cta-notifications-panel');
    this.overlayElement = document.getElementById('cta-notifications-overlay');
    this.listElement = document.getElementById('cta-notifications-list');
    this.loadingElement = document.getElementById('cta-notifications-loading');
    this.emptyElement = document.getElementById('cta-notifications-empty');
    this.buttonElement = document.querySelector('.cta-notification-button');
    this.closeButton = document.getElementById('cta-notifications-close');
  },
  /**
   * Bind event listeners
   */
  bindEvents() {
    // Button click to toggle panel
    if (this.buttonElement) {
      this.buttonElement.addEventListener('click', e => {
        e.preventDefault();
        e.stopPropagation();
        this.togglePanel();
      });
    }

    // Close button
    if (this.closeButton) {
      this.closeButton.addEventListener('click', e => {
        e.preventDefault();
        this.closePanel();
      });
    }

    // Overlay click to close
    if (this.overlayElement) {
      this.overlayElement.addEventListener('click', () => {
        this.closePanel();
      });
    }

    // Bind delete buttons for server-rendered notifications
    this.bindDeleteButtons();

    // Bind activate pro plugin buttons
    this.bindActivateProButtons();

    // Close panel on Escape key
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape' && this.isOpen) {
        this.closePanel();
      }
    });
  },
  /**
   * Bind delete buttons
   */
  bindDeleteButtons() {
    if (!this.panelElement) return;
    const deleteButtons = this.panelElement.querySelectorAll('.cta-notification-delete');
    deleteButtons.forEach(button => {
      // Remove existing listeners to prevent duplicates
      button.replaceWith(button.cloneNode(true));
    });

    // Re-select and bind
    this.panelElement.querySelectorAll('.cta-notification-delete').forEach(button => {
      button.addEventListener('click', e => {
        e.preventDefault();
        e.stopPropagation();
        const notificationId = button.dataset.notificationId;
        if (notificationId) {
          this.deleteNotification(notificationId);
        }
      });
    });
  },
  /**
   * Bind activate pro plugin buttons
   */
  bindActivateProButtons() {
    if (!this.panelElement) return;
    const activateButtons = this.panelElement.querySelectorAll('.cta-activate-pro-notification');
    activateButtons.forEach(button => {
      // Remove existing listeners to prevent duplicates
      button.replaceWith(button.cloneNode(true));
    });

    // Re-select and bind
    this.panelElement.querySelectorAll('.cta-activate-pro-notification').forEach(button => {
      button.addEventListener('click', e => {
        e.preventDefault();
        e.stopPropagation();
        this.activateProPlugin(button);
      });
    });
  },
  /**
   * Activate Pro plugin via AJAX
   */
  activateProPlugin(button) {
    if (button.classList.contains('is-loading')) return;
    const originalText = button.textContent;
    button.classList.add('is-loading');
    button.textContent = 'Activating...';
    const data = new FormData();
    data.append('action', 'cta_activate_pro_plugin');
    data.append('nonce', ctaAdminVars?.proActivateNonce || '');
    fetch(ajaxurl, {
      method: 'POST',
      body: data
    }).then(response => response.json()).then(response => {
      if (response.success) {
        // Show success and reload to reflect changes
        button.textContent = 'Activated! Reloading...';
        setTimeout(() => {
          window.location.reload();
        }, 500);
      } else {
        const message = response.data && response.data.message ? response.data.message : 'Failed to activate plugin.';
        button.classList.remove('is-loading');
        button.textContent = originalText;
        alert(message);
      }
    }).catch(error => {
      console.error('Error activating plugin:', error);
      button.classList.remove('is-loading');
      button.textContent = originalText;
      alert('Failed to activate plugin. Please try again.');
    });
  },
  /**
   * Toggle panel open/closed
   */
  togglePanel() {
    if (this.isOpen) {
      this.closePanel();
    } else {
      this.openPanel();
    }
  },
  /**
   * Open the notifications panel
   */
  openPanel() {
    if (this.isLoading || this.isOpen) return;
    this.isOpen = true;
    if (this.panelElement) {
      this.panelElement.classList.add('active');
    }
    if (this.overlayElement) {
      this.overlayElement.classList.add('active');
    }

    // Prevent body scroll
    document.body.classList.add('cta-notifications-open');

    // Only fetch via AJAX on subsequent opens to check for new notifications
    if (this.hasOpened) {
      this.refreshNotifications();
    }
    this.hasOpened = true;
  },
  /**
   * Close the notifications panel
   */
  closePanel() {
    this.isOpen = false;
    if (this.panelElement) {
      this.panelElement.classList.remove('active');
    }
    if (this.overlayElement) {
      this.overlayElement.classList.remove('active');
    }

    // Restore body scroll
    document.body.classList.remove('cta-notifications-open');
  },
  /**
   * Refresh notifications via AJAX (shows loading message below existing notifications)
   */
  refreshNotifications() {
    if (this.isLoading) return;
    this.isLoading = true;
    this.showLoadingState();
    const data = new FormData();
    data.append('action', 'cta_get_notifications');
    data.append('nonce', ctaAdminVars?.nonce || '');
    fetch(ajaxurl, {
      method: 'POST',
      body: data
    }).then(response => response.json()).then(data => {
      if (data.success && data.data.notifications) {
        this.renderNotifications(data.data.notifications);
        this.updateButtonBadge(data.data.count);
        this.updateHeaderCount(data.data.count);
      }
    }).catch(error => {
      console.error('Error loading notifications:', error);
    }).finally(() => {
      this.isLoading = false;
      this.hideLoadingState();
    });
  },
  /**
   * Show loading state
   */
  showLoadingState() {
    if (this.loadingElement) {
      this.loadingElement.style.display = 'flex';
    }
  },
  /**
   * Hide loading state
   */
  hideLoadingState() {
    if (this.loadingElement) {
      this.loadingElement.style.display = 'none';
    }
  },
  /**
   * Render notifications in the panel
   */
  renderNotifications(notifications) {
    if (!this.listElement) return;
    if (notifications.length === 0) {
      this.showEmptyState();
      return;
    }

    // Hide the empty state when notifications exist
    this.hideEmptyState();
    this.listElement.innerHTML = '';
    this.listElement.style.display = 'block';
    notifications.forEach(notification => {
      const item = this.createNotificationElement(notification);
      this.listElement.appendChild(item);
    });

    // Re-bind delete buttons and activate buttons after rendering
    this.bindDeleteButtons();
    this.bindActivateProButtons();
  },
  /**
   * Create a notification element
   */
  createNotificationElement(notification) {
    const li = document.createElement('li');
    li.dataset.notificationId = notification.id;
    li.dataset.notificationType = notification.type || '';

    // Check if this is the license CTA notification
    const isLicenseCta = notification.type === 'pro_api_key_missing';
    if (isLicenseCta) {
      li.className = 'cta-notification-item cta-notification-item--license-cta';
      li.innerHTML = this.createLicenseCtaHtml(notification);
    } else {
      li.className = 'cta-notification-item';
      li.innerHTML = this.createRegularNotificationHtml(notification);
    }
    return li;
  },
  /**
   * Create HTML for license CTA notification
   */
  createLicenseCtaHtml(notification) {
    let actionsHtml = '';
    if (notification.actions && notification.actions.length > 0) {
      actionsHtml = '<div class="cta-notification-license-actions">';
      notification.actions.forEach(action => {
        let dataAttrs = '';
        if (action.scrollTo) {
          dataAttrs += ' data-scroll-to="' + this.escapeHtml(action.scrollTo) + '"';
        }
        if (action.focusField) {
          dataAttrs += ' data-focus-field="' + this.escapeHtml(action.focusField) + '"';
        }
        actionsHtml += '<a href="' + this.escapeHtml(action.url) + '" class="cta-button cta-pro-upgrade-button cta-pro-upgrade-button--primary cta-button-primary cta-add-api-key-button"' + dataAttrs + '>' + '<span class="dashicons dashicons-unlock"></span>' + '<span class="cta-pro-upgrade-button__label">' + this.escapeHtml(action.label) + '</span>' + '</a>';
      });
      actionsHtml += '</div>';
    }
    return '<div class="cta-notification-license-glow"></div>' + '<div class="cta-notification-license-header">' + '<div class="cta-notification-license-icon">' + '<span class="dashicons dashicons-star-filled cta-animate-slow"></span>' + '</div>' + '<div class="cta-notification-license-text">' + '<h4 class="cta-notification-license-title">' + this.escapeHtml(notification.title) + '</h4>' + '<span class="cta-pro-badge"><span class="cta-pro-badge__text">Pro</span></span>' + '</div>' + '</div>' + '<p class="cta-notification-license-message">' + this.escapeHtml(notification.message) + '</p>' + actionsHtml;
  },
  /**
   * Create HTML for regular notification
   */
  createRegularNotificationHtml(notification) {
    let actionsHtml = '';
    if (notification.actions && notification.actions.length > 0) {
      actionsHtml = '<div class="cta-notification-actions">';
      notification.actions.forEach(action => {
        let actionClass = 'cta-button sm outline';
        if (action.class) {
          actionClass += ' ' + this.escapeHtml(action.class);
        }
        let dataAttrs = '';
        if (action.scrollTo) {
          dataAttrs += ' data-scroll-to="' + this.escapeHtml(action.scrollTo) + '"';
        }
        if (action.focusField) {
          dataAttrs += ' data-focus-field="' + this.escapeHtml(action.focusField) + '"';
        }
        actionsHtml += '<a href="' + this.escapeHtml(action.url) + '" class="' + actionClass + '"' + dataAttrs + '>' + this.escapeHtml(action.label) + '</a>';
      });
      actionsHtml += '</div>';
    }

    // Only show delete button if notification is deletable
    let deleteButtonHtml = '';
    if (notification.deletable !== false) {
      deleteButtonHtml = '<button class="cta-notification-delete" type="button" data-notification-id="' + notification.id + '" title="Dismiss notification"><span class="dashicons dashicons-no-alt"></span></button>';
    }
    return '<div class="cta-notification-content">' + '<div class="cta-notification-icon cta-notification-icon--' + this.escapeHtml(notification.icon) + '">' + '<span class="dashicons dashicons-' + this.escapeHtml(notification.icon) + '"></span>' + '</div>' + '<div class="cta-notification-text">' + '<h4 class="cta-notification-title">' + this.escapeHtml(notification.title) + '</h4>' + '<p class="cta-notification-message">' + this.escapeHtml(notification.message) + '</p>' + actionsHtml + '</div>' + '</div>' + deleteButtonHtml;
  },
  /**
   * Show empty state
   */
  showEmptyState() {
    if (this.emptyElement) {
      this.emptyElement.style.display = 'flex';
    }
    if (this.listElement) {
      this.listElement.style.display = 'none';
    }
  },
  /**
   * Hide empty state
   */
  hideEmptyState() {
    if (this.emptyElement) {
      this.emptyElement.style.display = 'none';
    }
    if (this.listElement) {
      this.listElement.style.display = 'block';
    }
  },
  /**
   * Delete a notification
   */
  deleteNotification(notificationId) {
    const data = new FormData();
    data.append('action', 'cta_delete_notification');
    data.append('nonce', ctaAdminVars?.nonce || '');
    data.append('notification_id', notificationId);
    fetch(ajaxurl, {
      method: 'POST',
      body: data
    }).then(response => response.json()).then(data => {
      if (data.success) {
        // Remove the notification item from the DOM
        const item = this.panelElement.querySelector('[data-notification-id="' + notificationId + '"]');
        if (item) {
          item.classList.add('removing');
          setTimeout(() => {
            item.remove();

            // Check if list is now empty (only check <li> elements, not the license CTA div)
            const listItems = this.listElement ? this.listElement.querySelectorAll('li') : [];
            if (listItems.length === 0) {
              this.showEmptyState();
            }
          }, 300);
        }

        // Update badge count
        this.updateButtonBadge(data.data.count);
        this.updateHeaderCount(data.data.count);
      }
    }).catch(error => {
      console.error('Error deleting notification:', error);
    });
  },
  /**
   * Update notification count badge on button
   */
  updateButtonBadge(count) {
    if (!this.buttonElement) return;
    let badge = this.buttonElement.querySelector('.cta-notification-badge');
    if (count > 0) {
      if (!badge) {
        badge = document.createElement('span');
        badge.className = 'cta-notification-badge';
        this.buttonElement.appendChild(badge);
      }
      // Badge is just a red dot, no text content
    } else {
      if (badge) {
        badge.remove();
      }
    }
  },
  /**
   * Update count in panel header
   */
  updateHeaderCount(count) {
    if (!this.panelElement) return;
    let countElement = this.panelElement.querySelector('.cta-notifications-count');
    if (count > 0) {
      if (!countElement) {
        const title = this.panelElement.querySelector('.cta-notifications-title');
        if (title) {
          countElement = document.createElement('span');
          countElement.className = 'cta-notifications-count';
          title.appendChild(countElement);
        }
      }
      if (countElement) {
        countElement.textContent = count;
      }
    } else {
      if (countElement) {
        countElement.remove();
      }
    }
  },
  /**
   * Update notification count
   */
  updateNotificationCount() {
    const data = new FormData();
    data.append('action', 'cta_get_notification_count');
    data.append('nonce', ctaAdminVars?.nonce || '');
    fetch(ajaxurl, {
      method: 'POST',
      body: data
    }).then(response => response.json()).then(data => {
      if (data.success) {
        this.updateButtonBadge(data.data.count);
      }
    }).catch(error => {
      console.error('Error updating notification count:', error);
    });
  },
  /**
   * Escape HTML string
   */
  escapeHtml(text) {
    if (!text) return '';
    const map = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, char => map[char]);
  }
};

// Initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', () => {
    NotificationsManager.init();
  });
} else {
  NotificationsManager.init();
}

// Export for testing or external use
window.CTANotificationsManager = NotificationsManager;

// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (NotificationsManager);

/***/ }),

/***/ "./assets/js/admin/modules/partials/tabs.js":
/*!**************************************************!*\
  !*** ./assets/js/admin/modules/partials/tabs.js ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Tabs Navigation Script
 *
 * Modular tab component JavaScript for CTA Manager
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function ($) {
  'use strict';

  /**
   * CTA Tabs Module
   */
  const CTATabs = {
    /**
     * Initialize the module
     */
    init: function () {
      this.bindEvents();
      this.initKeyboardNavigation();
      this.restoreActiveTab();
    },
    /**
     * Bind event handlers
     */
    bindEvents: function () {
      $(document).on('click', '.cta-tab-link', this.handleTabClick.bind(this));
    },
    /**
     * Handle tab click
     *
     * @param {Event} e Click event
     */
    handleTabClick: function (e) {
      e.preventDefault();
      const $btn = $(e.currentTarget);

      // Don't switch if tab is disabled/locked
      if ($btn.hasClass('is-disabled') || $btn.hasClass('is-locked') || $btn.is(':disabled') || $btn.attr('aria-disabled') === 'true') {
        e.stopPropagation();
        return;
      }
      const target = $btn.data('tab-target');
      if (!target) {
        return;
      }
      this.switchTab($btn, target);
    },
    /**
     * Switch to a specific tab
     *
     * @param {jQuery} $btn Tab button element
     * @param {string} target Target tab panel ID
     */
    switchTab: function ($btn, target) {
      const $tabs = $btn.closest('.cta-tabs');
      if (!$tabs.length) {
        return;
      }

      // Update tab buttons
      $tabs.find('.cta-tab-link').removeClass('is-active').attr('aria-selected', 'false');
      $btn.addClass('is-active').attr('aria-selected', 'true');

      // Update tab panels
      $tabs.find('.cta-tab-panel').removeClass('is-active');
      const $targetPanel = $tabs.find('#' + target);
      $targetPanel.addClass('is-active');

      // Store active tab in sessionStorage
      this.saveActiveTab(target);

      // Trigger custom event for other scripts to hook into
      $(document).trigger('cta:tab:changed', {
        tab: target,
        button: $btn,
        panel: $targetPanel
      });

      // Scroll to top of tab content
      this.scrollToTabContent($tabs);
    },
    /**
     * Initialize keyboard navigation for tabs
     */
    initKeyboardNavigation: function () {
      const self = this;
      $(document).on('keydown', '.cta-tab-link', function (e) {
        const $current = $(this);
        const $tabs = $current.closest('.cta-tabs__nav');
        const $allTabs = $tabs.find('.cta-tab-link').not('.is-disabled');
        const currentIndex = $allTabs.index($current);
        let $next = null;
        switch (e.key) {
          case 'ArrowRight':
          case 'ArrowDown':
            e.preventDefault();
            $next = $allTabs.eq((currentIndex + 1) % $allTabs.length);
            break;
          case 'ArrowLeft':
          case 'ArrowUp':
            e.preventDefault();
            $next = $allTabs.eq((currentIndex - 1 + $allTabs.length) % $allTabs.length);
            break;
          case 'Home':
            e.preventDefault();
            $next = $allTabs.first();
            break;
          case 'End':
            e.preventDefault();
            $next = $allTabs.last();
            break;
        }
        if ($next && $next.length && !$next.hasClass('is-disabled')) {
          $next.focus();
          const target = $next.data('tab-target');
          if (target && !$next.is(':disabled') && !$next.hasClass('is-disabled') && !$next.hasClass('is-locked')) {
            self.switchTab($next, target);
          }
        }
      });
    },
    /**
     * Save active tab to sessionStorage
     *
     * @param {string} tabId Active tab ID
     */
    saveActiveTab: function (tabId) {
      try {
        sessionStorage.setItem('cta_active_tab', tabId);
      } catch (e) {
        // SessionStorage not available, fail silently
      }
    },
    /**
     * Restore previously active tab from sessionStorage
     */
    restoreActiveTab: function () {
      try {
        const savedTab = sessionStorage.getItem('cta_active_tab');
        if (savedTab) {
          const $savedTabBtn = $('.cta-tab-link[data-tab-target="' + savedTab + '"]');

          // Don't restore if tab is disabled
          if ($savedTabBtn.length && !$savedTabBtn.hasClass('is-active') && !$savedTabBtn.hasClass('is-disabled') && !$savedTabBtn.hasClass('is-locked') && !$savedTabBtn.is(':disabled') && $savedTabBtn.attr('aria-disabled') !== 'true') {
            this.switchTab($savedTabBtn, savedTab);
          }
        }
      } catch (e) {
        // SessionStorage not available, fail silently
      }
    },
    /**
     * Scroll to top of tab content
     *
     * @param {jQuery} $tabs Tab container element
     */
    scrollToTabContent: function ($tabs) {
      // Check if tabs are in a modal
      const $modal = $tabs.closest('.cta-modal');
      if ($modal.length) {
        // Scroll modal content to top
        const $modalBody = $modal.find('.cta-modal-body');
        if ($modalBody.length) {
          $modalBody.animate({
            scrollTop: 0
          }, 300);
        }
      } else {
        // Scroll window to tabs
        $('html, body').animate({
          scrollTop: $tabs.offset().top - 32
        }, 300);
      }
    },
    /**
     * Programmatically switch to a tab by ID
     *
     * @param {string} tabId Target tab panel ID
     * @param {boolean} force Force switch even if disabled (default: false)
     */
    goToTab: function (tabId, force) {
      const $btn = $('.cta-tab-link[data-tab-target="' + tabId + '"]');
      if ($btn.length && (force || !$btn.hasClass('is-disabled') && !$btn.hasClass('is-locked') && !$btn.is(':disabled') && $btn.attr('aria-disabled') !== 'true')) {
        this.switchTab($btn, tabId);
      }
    },
    /**
     * Get current active tab ID
     *
     * @return {string|null} Active tab ID or null
     */
    getActiveTab: function () {
      const $activeBtn = $('.cta-tab-link.is-active');
      if ($activeBtn.length) {
        return $activeBtn.data('tab-target');
      }
      return null;
    }
  };

  /**
   * Initialize on document ready
   */
  $(function () {
    // Only initialize if tabs exist on the page
    if ($('.cta-tabs').length) {
      CTATabs.init();
    }
  });

  /**
   * Expose to global scope for external access
   */
  window.CTATabs = CTATabs;
})(jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTATabs);

/***/ }),

/***/ "./assets/js/admin/modules/partials/toast.js":
/*!***************************************************!*\
  !*** ./assets/js/admin/modules/partials/toast.js ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Toast Notification System
 *
 * Reusable toast notifications that can be used across all admin pages
 * for AJAX success, error, warning, and info messages
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function (window, $) {
  'use strict';

  /**
   * Toast Notification Class
   */
  class CTAToast {
    constructor() {
      this.container = null;
      this.toasts = [];
      this.currentPosition = 'top-right';
      this.init();
    }

    /**
     * Initialize the toast system
     */
    init() {
      // Create container if it doesn't exist
      if (!$('.cta-toast-container').length) {
        this.container = $('<div class="cta-toast-container cta-toast-position-top-right"></div>');
        $('body').append(this.container);
      } else {
        this.container = $('.cta-toast-container');
      }
    }

    /**
     * Update container position
     */
    updateContainerPosition(position) {
      if (this.currentPosition !== position) {
        this.container.removeClass(`cta-toast-position-${this.currentPosition}`);
        this.container.addClass(`cta-toast-position-${position}`);
        this.currentPosition = position;
      }
    }

    /**
     * Show a toast notification
     *
     * @param {string} message - The message to display
     * @param {string} type - Toast type: 'success', 'error', 'warning', 'info'
     * @param {Object} options - Additional options
     * @param {string} options.title - Optional title for the toast
     * @param {number} options.duration - Duration in ms (default: 5000)
     * @param {boolean} options.progress - Show progress bar (default: true)
     * @param {boolean} options.manualDismiss - Requires manual dismissal with X button (default: false)
     * @param {string} options.position - Toast position: 'top-right', 'top-left', 'top-center', 'center-right', 'center-bottom', 'bottom-center', 'bottom-left', 'center-left', 'center' (default: 'top-right')
     * @param {string} options.width - Toast width: 'auto', 'full', or default (default: current width)
     * @param {boolean} options.showOnce - Show only once per user (default: false)
     * @param {string} options.showOnceId - Required ID when showOnce is true
     * @param {Function} options.onClose - Callback when toast is closed
     * @returns {jQuery|null} The toast element or null if already shown
     */
    show(message, type = 'info', options = {}) {
      const defaults = {
        title: '',
        duration: 5000,
        progress: true,
        manualDismiss: false,
        position: 'top-right',
        width: 'default',
        showOnce: false,
        showOnceId: null,
        onClose: null
      };
      const settings = $.extend({}, defaults, options);

      // Check if this toast should only show once
      if (settings.showOnce) {
        if (!settings.showOnceId) {
          console.error('CTAToast: showOnceId is required when showOnce is true');
          return null;
        }

        // Check localStorage to see if it was already shown
        const storageKey = `cta_toast_shown_${settings.showOnceId}`;
        if (localStorage.getItem(storageKey)) {
          return null; // Already shown, don't display
        }
      }

      // If manualDismiss is true, force duration to 0 and progress to false
      if (settings.manualDismiss) {
        settings.duration = 0;
        settings.progress = false;
      }

      // Update container position
      this.updateContainerPosition(settings.position);

      // Get icon based on type
      const icons = {
        success: 'dashicons-yes-alt',
        error: 'dashicons-dismiss',
        warning: 'dashicons-warning',
        info: 'dashicons-info'
      };
      const icon = icons[type] || icons.info;

      // Build width class
      let widthClass = '';
      if (settings.width === 'auto') {
        widthClass = ' cta-toast-width-auto';
      } else if (settings.width === 'full') {
        widthClass = ' cta-toast-width-full';
      }

      // Build toast HTML
      const $toast = $(`
        <div class="cta-toast cta-toast-${type}${widthClass}" role="alert" aria-live="polite">
          <div class="cta-toast-icon">
            <span class="dashicons ${icon}"></span>
          </div>
          <div class="cta-toast-content">
            ${settings.title ? `<div class="cta-toast-title">${this.escapeHtml(settings.title)}</div>` : ''}
            <div class="cta-toast-message">${this.escapeHtml(message)}</div>
          </div>
          ${settings.manualDismiss ? '<button type="button" class="cta-toast-close" aria-label="Close notification">Ã</button>' : ''}
          ${settings.progress && settings.duration > 0 ? '<div class="cta-toast-progress"><div class="cta-toast-progress-bar"></div></div>' : ''}
        </div>
      `);

      // Add to container
      this.container.append($toast);
      this.toasts.push($toast);

      // Trigger show animation
      setTimeout(() => {
        $toast.addClass('cta-toast-show');
      }, 10);

      // Handle close button (only if manualDismiss is true)
      if (settings.manualDismiss) {
        $toast.find('.cta-toast-close').on('click', () => {
          this.close($toast, settings.onClose, settings.showOnce ? settings.showOnceId : null);
        });
      }

      // Auto-close after duration
      if (settings.duration > 0) {
        // Start progress bar animation
        if (settings.progress) {
          const $progressBar = $toast.find('.cta-toast-progress-bar');
          $progressBar.css({
            width: '100%',
            transition: `width ${settings.duration}ms linear`
          });
          setTimeout(() => {
            $progressBar.css('width', '0%');
          }, 10);
        }

        // Auto-close timer
        setTimeout(() => {
          this.close($toast, settings.onClose, settings.showOnce ? settings.showOnceId : null);
        }, settings.duration);
      }
      return $toast;
    }

    /**
     * Show a success toast
     */
    success(message, options = {}) {
      return this.show(message, 'success', options);
    }

    /**
     * Show an error toast
     */
    error(message, options = {}) {
      return this.show(message, 'error', $.extend({
        duration: 7000
      }, options));
    }

    /**
     * Show a warning toast
     */
    warning(message, options = {}) {
      return this.show(message, 'warning', $.extend({
        duration: 6000
      }, options));
    }

    /**
     * Show an info toast
     */
    info(message, options = {}) {
      return this.show(message, 'info', options);
    }

    /**
     * Close a toast
     */
    close($toast, onCloseCallback = null, showOnceId = null) {
      // Store in localStorage if this is a showOnce toast
      if (showOnceId) {
        const storageKey = `cta_toast_shown_${showOnceId}`;
        localStorage.setItem(storageKey, 'true');
      }
      $toast.removeClass('cta-toast-show').addClass('cta-toast-hide');
      setTimeout(() => {
        $toast.remove();

        // Remove from toasts array
        const index = this.toasts.indexOf($toast);
        if (index > -1) {
          this.toasts.splice(index, 1);
        }

        // Call onClose callback
        if (typeof onCloseCallback === 'function') {
          onCloseCallback();
        }
      }, 300);
    }

    /**
     * Close all toasts
     */
    closeAll() {
      this.toasts.forEach($toast => {
        this.close($toast);
      });
    }

    /**
     * Escape HTML to prevent XSS
     */
    escapeHtml(text) {
      const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
      };
      return String(text).replace(/[&<>"']/g, m => map[m]);
    }
  }

  /**
   * Create global instance
   */
  window.CTAToast = new CTAToast();

  /**
   * jQuery plugin for convenience
   */
  $.ctaToast = {
    show: (message, type, options) => window.CTAToast.show(message, type, options),
    success: (message, options) => window.CTAToast.success(message, options),
    error: (message, options) => window.CTAToast.error(message, options),
    warning: (message, options) => window.CTAToast.warning(message, options),
    info: (message, options) => window.CTAToast.info(message, options),
    close: ($toast, callback) => window.CTAToast.close($toast, callback),
    closeAll: () => window.CTAToast.closeAll()
  };
})(window, jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Check if module exists (development only)
/******/ 		if (__webpack_modules__[moduleId] === undefined) {
/******/ 			var e = new Error("Cannot find module '" + moduleId + "'");
/******/ 			e.code = 'MODULE_NOT_FOUND';
/******/ 			throw e;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	!function() {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = function(exports) {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	}();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry needs to be wrapped in an IIFE because it needs to be isolated against other modules in the chunk.
!function() {
/*!*********************************************!*\
  !*** ./assets/js/admin/components/admin.js ***!
  \*********************************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _modules_partials_debug__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../modules/partials/debug */ "./assets/js/admin/modules/partials/debug.js");
/* harmony import */ var _modules_partials_modal_shell__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../modules/partials/modal-shell */ "./assets/js/admin/modules/partials/modal-shell.js");
/* harmony import */ var _modules_partials_tabs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modules/partials/tabs */ "./assets/js/admin/modules/partials/tabs.js");
/* harmony import */ var _modules_partials_accordion__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../modules/partials/accordion */ "./assets/js/admin/modules/partials/accordion.js");
/* harmony import */ var _modules_partials_toast__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../modules/partials/toast */ "./assets/js/admin/modules/partials/toast.js");
/* harmony import */ var _modules_partials_notifications__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../modules/partials/notifications */ "./assets/js/admin/modules/partials/notifications.js");
/* harmony import */ var _modules_partials_components__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../modules/partials/components */ "./assets/js/admin/modules/partials/components.js");
/* harmony import */ var _modules_modals_modals__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../modules/modals/modals */ "./assets/js/admin/modules/modals/modals.js");
/* harmony import */ var _modules_modals_global_modal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../modules/modals/global-modal */ "./assets/js/admin/modules/modals/global-modal.js");
/* harmony import */ var _modules_modals_preview_modal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../modules/modals/preview-modal */ "./assets/js/admin/modules/modals/preview-modal.js");
/* harmony import */ var _modules_modals_docs_modal__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../modules/modals/docs-modal */ "./assets/js/admin/modules/modals/docs-modal.js");
/* harmony import */ var _modules_modals_pro_upsell_modal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../modules/modals/pro-upsell-modal */ "./assets/js/admin/modules/modals/pro-upsell-modal.js");
/* harmony import */ var _modules_modals_features_modal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../modules/modals/features-modal */ "./assets/js/admin/modules/modals/features-modal.js");
/* harmony import */ var _modules_modals_onboarding_modal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../modules/modals/onboarding-modal */ "./assets/js/admin/modules/modals/onboarding-modal.js");
/* harmony import */ var _modules_modals_format_modal__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../modules/modals/format-modal */ "./assets/js/admin/modules/modals/format-modal.js");
/* harmony import */ var _modules_forms_conditional_tabs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../modules/forms/conditional-tabs */ "./assets/js/admin/modules/forms/conditional-tabs.js");
/* harmony import */ var _modules_forms_button_styling__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../modules/forms/button-styling */ "./assets/js/admin/modules/forms/button-styling.js");
/* harmony import */ var _modules_pages_dashboard__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../modules/pages/dashboard */ "./assets/js/admin/modules/pages/dashboard.js");
/* harmony import */ var _modules_pages_support__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../modules/pages/support */ "./assets/js/admin/modules/pages/support.js");
/**
 * CTA Manager - Admin Global Entry Point
 *
 * This is the main entry point for all CTA Manager admin pages.
 * It imports and initializes all global modules needed across the admin interface.
 *
 * When bundled with npm, this file will import:
 * - partials/modal-shell    (ctaModalAPI)
 * - partials/tabs           (CTATabs)
 * - partials/accordion      (accordion component)
 * - partials/toast          (CTAToast)
 * - partials/notifications  (CTANotificationsManager)
 * - partials/components     (clipboard copy, etc.)
 * - modals/modals           (modal shell helpers)
 * - modals/global-modal     (global form modal)
 * - modals/preview-modal    (CTA form preview functionality)
 * - modals/docs-modal       (CTADocsModal)
 * - modals/pro-upsell-modal (CTCAdmin.showProUpgradeModal)
 * - modals/features-modal   (features/integrations modal)
 * - modals/onboarding-modal (CTAOnboarding)
 * - pages/dashboard         (CTCAdmin core)
 * - pages/support           (CTASupport - ticket submission)
 *
 * Output: /assets/js/minimized/admin/admin.js
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

// ES6 Module Imports (uncomment when bundling with npm)



















(function ($) {
  'use strict';

  /**
   * Get URL parameter value
   *
   * @param {string} param Parameter name
   * @returns {string|null} Parameter value or null
   */
  function getUrlParam(param) {
    var urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  }

  /**
   * Handle modal URL parameter
   * Opens modals based on ?modal=xxx URL parameter
   */
  function handleModalUrlParam() {
    var modalParam = getUrlParam('modal');
    if (!modalParam) {
      return;
    }

    // Special case: add-license redirects to settings page with hash
    if (modalParam === 'add-license') {
      window.location.href = 'admin.php?page=cta-manager-settings#cta-pro-license-key';
      return;
    }

    // Map of modal parameter values to modal selectors
    var modalMap = {
      'new-cta': '#cta-global-form-modal',
      'pro-upgrade': '#cta-pro-upgrade-modal'
    };
    var modalSelector = modalMap[modalParam];
    if (modalSelector && window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
      // Small delay to ensure modal template is ready
      setTimeout(function () {
        window.ctaModalAPI.open(modalSelector);
      }, 100);
    }
  }

  /**
   * CTA Admin Global Controller
   *
   * Coordinates initialization of all global admin modules
   */
  window.CTAAdminApp = window.CTAAdminApp || {
    /**
     * Module registry - maps module names to global objects
     */
    modules: {
      modalShell: 'ctaModalAPI',
      tabs: 'CTATabs',
      toast: 'CTAToast',
      notifications: 'CTANotificationsManager',
      docsModal: 'CTADocsModal',
      onboarding: 'CTAOnboarding',
      admin: 'CTCAdmin'
    },
    /**
     * Check if all required modules are loaded
     *
     * @returns {Array} List of missing module names
     */
    checkModules: function () {
      var missing = [];
      for (var key in this.modules) {
        if (!window[this.modules[key]]) {
          missing.push(this.modules[key]);
        }
      }
      return missing;
    },
    /**
     * Initialize the admin application
     */
    init: function () {
      // Initialize CTCAdmin core if available
      if (typeof window.CTCAdmin !== 'undefined' && typeof window.CTCAdmin.init === 'function') {
        window.CTCAdmin.init();
      }

      // Handle URL parameter for opening modals (e.g., ?modal=new-cta)
      handleModalUrlParam();

      // Trigger global ready event for other scripts to hook into
      $(document).trigger('ctaAdminReady', [this]);
    }
  };

  // Initialize on document ready
  $(function () {
    window.CTAAdminApp.init();
  });
})(jQuery);
}();
/******/ })()
;