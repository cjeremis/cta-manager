/*!
 * CTA Manager - Manage CTAs Bundle
 *
 * JavaScript bundle for the Manage CTAs admin page.
 *
 * @package    CTA_Manager
 * @version    1.0.0
 * @copyright  2026 TopDevAmerica
 * @license    GPL-2.0+
 */
/******/ (function() { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./assets/js/admin/modules/forms/filters.js":
/*!**************************************************!*\
  !*** ./assets/js/admin/modules/forms/filters.js ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Filters Form Module
 *
 * Contains JavaScript behavior for the filters form UI.
 * Used by admin entry bundles for form interactions and state updates.
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function ($) {
  'use strict';

  const CTAFilters = {
    // Filter field IDs mapped to URL param names and data attributes
    filterConfig: {
      'cta-type-filter': {
        param: 'type',
        attr: 'data-cta-type'
      },
      'cta-status-filter': {
        param: 'status',
        attr: 'data-cta-status'
      },
      'cta-layout-filter': {
        param: 'layout',
        attr: 'data-cta-layout'
      },
      'cta-visibility-filter': {
        param: 'visibility',
        attr: 'data-cta-visibility'
      },
      'cta-icon-filter': {
        param: 'icon',
        attr: 'data-cta-icon'
      },
      'cta-button-animation-filter': {
        param: 'button_animation',
        attr: 'data-cta-button-animation'
      },
      'cta-icon-animation-filter': {
        param: 'icon_animation',
        attr: 'data-cta-icon-animation'
      },
      'cta-show-demo-filter': {
        param: 'show_demo',
        attr: 'data-cta-demo',
        isCheckbox: true
      }
    },
    searchParam: 'search',
    defaultStatusFilter: 'all',
    currentStatusFilter: null,
    // Header status filter state

    init() {
      this.cacheElements();
      if (!this.$ctaList.length) return;
      this.loadFiltersFromURL();
      this.setDefaultStatusFilter();
      this.loadHeaderStatusFromURL();
      this.bindEvents();
      this.applyFilters();
      this.updateSearchIcon();
      this.sortCTAList();
    },
    loadHeaderStatusFromURL() {
      const urlParams = new URLSearchParams(window.location.search);
      const statusValue = urlParams.get('status');
      if (statusValue) {
        // Always use status from URL
        this.currentStatusFilter = statusValue;
        // Find matching button and activate it (if exists in header)
        if (this.$statusFilterBtns.length) {
          this.$statusFilterBtns.removeClass('is-active');
          const $matchingBtn = this.$statusFilterBtns.filter('[data-filter="' + statusValue + '"]');
          if ($matchingBtn.length) {
            $matchingBtn.addClass('is-active');
          } else {
            // Fallback to "All" when URL status doesn't map to a header button
            this.currentStatusFilter = 'all';
            this.$statusFilterBtns.filter('[data-filter="all"]').addClass('is-active');
          }
          // If no matching button (e.g., 'archived', 'trash'), no button is active
        }
      } else {
        // No status in URL - use whichever button is marked active in HTML (default: "all")
        const $activeBtn = this.$statusFilterBtns.filter('.is-active');
        if ($activeBtn.length) {
          this.currentStatusFilter = $activeBtn.attr('data-filter') || 'all';
        } else {
          this.currentStatusFilter = 'all';
        }
      }
    },
    cacheElements() {
      this.$ctaList = $('.cta-cta-list');
      this.$ctaItems = this.$ctaList.find('.cta-cta-item');
      this.$applyBtn = $('#cta-apply-cta-filters');
      this.$resetBtn = $('#cta-reset-cta-filters');
      this.$searchInput = $('#cta-search-input');
      this.$searchIcon = $('#cta-search-icon');
      this.$filtersModal = $('#cta-filters-modal');
      this.$statusFilter = $('#cta-status-filter');
      this.$statusFilterBtns = $('.cta-status-filter');
      this.$emptyTrashWrapper = $('#cta-empty-trash-wrapper');
      this.$emptyTrashBtn = $('#cta-empty-trash-btn');
      this.$filterEmptyState = $('#cta-filter-empty-state');
      this.$clearFiltersBtn = $('#cta-clear-filters-btn');
    },
    bindEvents() {
      const self = this;

      // Status filter buttons in header
      this.$statusFilterBtns.on('click', function () {
        const $btn = $(this);
        const filterValue = $btn.attr('data-filter');

        // Update active state
        self.$statusFilterBtns.removeClass('is-active');
        $btn.addClass('is-active');

        // Apply the filter
        self.currentStatusFilter = filterValue;
        self.applyFilters();
        self.updateURL();
      });

      // Apply filters button
      this.$applyBtn.on('click', function () {
        // Sync modal status dropdown with currentStatusFilter
        const modalStatusValue = self.$statusFilter.val();
        if (modalStatusValue) {
          self.currentStatusFilter = modalStatusValue;
          // Update header button active state - clear all if no matching button
          self.$statusFilterBtns.removeClass('is-active');
          const $matchingBtn = self.$statusFilterBtns.filter('[data-filter="' + modalStatusValue + '"]');
          if ($matchingBtn.length) {
            $matchingBtn.addClass('is-active');
          }
        }
        self.applyFilters();
        self.updateURL();
        self.closeModal();
      });

      // Reset filters button
      this.$resetBtn.on('click', function () {
        self.resetFilters();
        self.applyFilters();
        self.updateURL();
        self.toggleEmptyTrashButton();
        self.closeModal();
      });

      // Status filter change - toggle Empty Trash button
      this.$statusFilter.on('change', function () {
        self.toggleEmptyTrashButton();
      });

      // Empty Trash button
      this.$emptyTrashBtn.on('click', function () {
        if (confirm('Are you sure you want to permanently delete all trashed CTAs? This action cannot be undone.')) {
          self.emptyTrash();
        }
      });

      // Search input with debounce
      let searchTimeout;
      this.$searchInput.on('input', function () {
        clearTimeout(searchTimeout);
        self.updateSearchIcon();
        searchTimeout = setTimeout(function () {
          self.applyFilters();
          self.updateURL();
        }, 300);
      });

      // Search icon click (clear when X is shown)
      this.$searchIcon.on('click', function () {
        if (self.$searchInput.val()) {
          self.$searchInput.val('');
          self.updateSearchIcon();
          self.applyFilters();
          self.updateURL();
        }
      });

      // Load search from URL
      const urlParams = new URLSearchParams(window.location.search);
      const searchValue = urlParams.get(this.searchParam);
      if (searchValue) {
        this.$searchInput.val(searchValue);
      }

      // Initial Empty Trash button visibility
      this.toggleEmptyTrashButton();

      // Clear filters button in empty state
      this.$clearFiltersBtn.on('click', function () {
        self.clearAllFilters();
      });
    },
    updateSearchIcon() {
      const hasValue = this.$searchInput.val().length > 0;
      const $icon = this.$searchIcon.find('.dashicons');
      if (hasValue) {
        $icon.removeClass('dashicons-search').addClass('dashicons-no-alt');
        this.$searchIcon.addClass('has-value');
      } else {
        $icon.removeClass('dashicons-no-alt').addClass('dashicons-search');
        this.$searchIcon.removeClass('has-value');
      }
    },
    loadFiltersFromURL() {
      const urlParams = new URLSearchParams(window.location.search);

      // Load each filter from URL
      for (const [fieldId, config] of Object.entries(this.filterConfig)) {
        const $field = $('#' + fieldId);
        if (!$field.length) continue;
        const value = urlParams.get(config.param);
        if (value !== null) {
          if (config.isCheckbox) {
            $field.prop('checked', value === '1');
          } else {
            $field.val(value);
          }
        }
      }

      // Load search
      const searchValue = urlParams.get(this.searchParam);
      if (searchValue) {
        this.$searchInput.val(searchValue);
      }
    },
    getFilterValues() {
      const filters = {};
      for (const [fieldId, config] of Object.entries(this.filterConfig)) {
        const $field = $('#' + fieldId);
        if (!$field.length) continue;
        if (config.isCheckbox) {
          filters[config.param] = $field.prop('checked') ? '1' : '0';
        } else {
          filters[config.param] = $field.val() || '';
        }
      }
      filters[this.searchParam] = this.$searchInput.val() || '';
      return filters;
    },
    setDefaultStatusFilter() {
      // If no status filter is set in URL, set the default
      const urlParams = new URLSearchParams(window.location.search);
      if (!urlParams.has('status')) {
        this.$statusFilter.val(this.defaultStatusFilter);
      }
    },
    toggleEmptyTrashButton() {
      const statusValue = this.$statusFilter.val();
      if (statusValue === 'trash') {
        this.$emptyTrashWrapper.show();
      } else {
        this.$emptyTrashWrapper.hide();
      }
    },
    emptyTrash() {
      // Send AJAX request to permanently delete all trashed CTAs
      const self = this;
      $.ajax({
        url: ctaAdminVars.ajaxUrl,
        type: 'POST',
        data: {
          action: 'cta_empty_trash',
          nonce: ctaAdminVars.nonce
        },
        success: function (response) {
          if (response.success) {
            // Remove trashed items from the DOM
            self.$ctaItems.filter('[data-cta-status="trash"]').remove();
            self.$ctaItems = self.$ctaList.find('.cta-cta-item');
            self.updateVisibleCount();

            // Show success message
            if (window.CTAToast && typeof window.CTAToast.show === 'function') {
              window.CTAToast.show(response.data.message || 'Trash emptied successfully', 'success');
            }
          } else {
            // Show error message
            if (window.CTAToast && typeof window.CTAToast.show === 'function') {
              window.CTAToast.show(response.data.message || 'Failed to empty trash', 'error');
            }
          }
        },
        error: function () {
          if (window.CTAToast && typeof window.CTAToast.show === 'function') {
            window.CTAToast.show('An error occurred while emptying trash', 'error');
          }
        }
      });
    },
    sortCTAList() {
      // Sort CTA items: Scheduled items first, then others
      const $items = this.$ctaItems.get();
      $items.sort(function (a, b) {
        const aStatus = $(a).attr('data-cta-status') || '';
        const bStatus = $(b).attr('data-cta-status') || '';

        // Scheduled items come first
        if (aStatus === 'scheduled' && bStatus !== 'scheduled') return -1;
        if (bStatus === 'scheduled' && aStatus !== 'scheduled') return 1;

        // Otherwise maintain original order
        return 0;
      });

      // Reorder in DOM
      $.each($items, function (idx, item) {
        this.$ctaList.append(item);
      }.bind(this));
    },
    applyFilters() {
      // Refresh items cache in case DOM has changed
      this.$ctaItems = this.$ctaList.find('.cta-cta-item');
      const filters = this.getFilterValues();
      const searchTerm = filters[this.searchParam].toLowerCase();
      // Use header status filter (always set now after init fix)
      const statusFilter = this.currentStatusFilter || 'all';
      this.$ctaItems.each(function () {
        const $item = $(this);
        let visible = true;
        const itemStatus = $item.attr('data-cta-status') || '';

        // Handle status filter with special logic
        if (statusFilter === 'all') {
          // Show all EXCEPT archived and trash
          if (itemStatus === 'archived' || itemStatus === 'trash') {
            visible = false;
          }
        } else if (statusFilter !== itemStatus) {
          // Exact match for other statuses (published, draft, scheduled, archived, trash)
          visible = false;
        }

        // Check other filters
        if (visible) {
          for (const [fieldId, config] of Object.entries(CTAFilters.filterConfig)) {
            // Skip status filter since we handled it above
            if (config.param === 'status') continue;
            const filterValue = filters[config.param];
            if (config.isCheckbox) {
              // Demo filter: if unchecked (0), hide demo items
              if (config.param === 'show_demo' && filterValue === '0') {
                if ($item.attr('data-cta-demo') === '1') {
                  visible = false;
                }
              }
            } else if (filterValue) {
              const itemValue = $item.attr(config.attr) || '';

              // Special handling for "has" filters
              if (filterValue === '__has_icon__') {
                if (!itemValue || itemValue === 'none') {
                  visible = false;
                }
              } else if (filterValue === '__has_animation__') {
                if (!itemValue || itemValue === 'none') {
                  visible = false;
                }
              } else if (itemValue !== filterValue) {
                visible = false;
              }
            }
          }
        }

        // Check search term using comprehensive data-cta-search attribute
        if (visible && searchTerm) {
          const searchableText = $item.attr('data-cta-search') || '';
          if (!searchableText.includes(searchTerm)) {
            visible = false;
          }
        }

        // Use explicit show/hide for reliability and track filtered state
        if (visible) {
          $item.removeClass('is-filter-hidden').show();
        } else {
          $item.addClass('is-filter-hidden').hide();
        }
      });
      this.updateVisibleCount();
    },
    updateVisibleCount() {
      const visibleCount = this.$ctaItems.not('.is-filter-hidden').length;
      const totalCount = this.$ctaItems.length;

      // Show/hide empty state based on visible count
      if (visibleCount === 0 && totalCount > 0) {
        this.$filterEmptyState.show();
        this.$ctaList.hide();
      } else {
        this.$filterEmptyState.hide();
        this.$ctaList.show();
      }

      // Update the CTA count badge if filters are active
      const $countBadge = $('.cta-count-badge-primary-dark');
      if ($countBadge.length) {
        const hasActiveFilters = this.hasActiveFilters();
        if (hasActiveFilters && visibleCount !== totalCount) {
          $countBadge.text(visibleCount + ' of ' + totalCount + ' CTAs');
        } else {
          const ctaText = totalCount === 1 ? 'CTA' : 'CTAs';
          $countBadge.text(totalCount + ' ' + ctaText);
        }
      }
    },
    hasActiveFilters() {
      const filters = this.getFilterValues();
      for (const [param, value] of Object.entries(filters)) {
        if (param === 'show_demo') {
          // Demo filter is active if unchecked
          if (value === '0') return true;
        } else if (value) {
          return true;
        }
      }
      return false;
    },
    updateURL() {
      const filters = this.getFilterValues();
      const url = new URL(window.location.href);

      // Clear existing filter params
      for (const config of Object.values(this.filterConfig)) {
        url.searchParams.delete(config.param);
      }
      url.searchParams.delete(this.searchParam);

      // Add active filter params
      for (const [param, value] of Object.entries(filters)) {
        if (param === 'show_demo') {
          // Only add show_demo if unchecked (hiding demos)
          if (value === '0') {
            url.searchParams.set(param, value);
          }
        } else if (param === 'status') {
          // Always honor header status filter; skip param for "all"
          if (this.currentStatusFilter && this.currentStatusFilter !== 'all') {
            url.searchParams.set(param, this.currentStatusFilter);
          }
        } else if (value) {
          url.searchParams.set(param, value);
        }
      }

      // Update URL without reload
      window.history.replaceState({}, '', url.toString());
    },
    resetFilters() {
      // Reset all select filters
      for (const [fieldId, config] of Object.entries(this.filterConfig)) {
        const $field = $('#' + fieldId);
        if (!$field.length) continue;
        if (config.isCheckbox) {
          $field.prop('checked', true); // Default to showing demo
        } else if (config.param === 'status') {
          // Reset status to default
          $field.val(this.defaultStatusFilter);
        } else {
          $field.val('');
        }
      }

      // Sync currentStatusFilter with the reset value
      this.currentStatusFilter = this.defaultStatusFilter;
      // Update header buttons - clear active and set matching one if exists
      this.$statusFilterBtns.removeClass('is-active');
      const $matchingBtn = this.$statusFilterBtns.filter('[data-filter="' + this.defaultStatusFilter + '"]');
      if ($matchingBtn.length) {
        $matchingBtn.addClass('is-active');
      } else {
        // Default to "all" button if no match
        this.$statusFilterBtns.filter('[data-filter="all"]').addClass('is-active');
      }

      // Reset search
      this.$searchInput.val('');
      this.updateSearchIcon();
    },
    clearAllFilters() {
      // Reset all filter form fields
      this.resetFilters();

      // Reset header status filter to "All"
      this.$statusFilterBtns.removeClass('is-active');
      this.$statusFilterBtns.filter('[data-filter="all"]').addClass('is-active');
      this.currentStatusFilter = 'all';

      // Build clean URL with only the page parameter (remove all filter params)
      const url = new URL(window.location.href);
      const pageParam = url.searchParams.get('page');

      // Clear all search params
      url.search = '';

      // Keep only the essential page parameter
      if (pageParam) {
        url.searchParams.set('page', pageParam);
      }

      // Update URL without reload and re-apply filters
      window.history.replaceState({}, '', url.toString());
      this.applyFilters();
      this.updateURL();
    },
    closeModal() {
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close(this.$filtersModal);
      } else {
        const $modal = this.$filtersModal;
        $modal.fadeOut(150, function () {
          if (!$('.cta-modal:visible').not($modal).length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }
    }
  };

  // Initialize when DOM is ready
  $(function () {
    CTAFilters.init();
  });

  // Export for external use
  window.CTAFilters = CTAFilters;
})(jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTAFilters);

/***/ }),

/***/ "./assets/js/admin/modules/modals/format-modal.js":
/*!********************************************************!*\
  !*** ./assets/js/admin/modules/modals/format-modal.js ***!
  \********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Format Modal Module
 *
 * Contains JavaScript behavior for the format modal.
 * Used by admin entry bundles to handle modal interactions.
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function ($) {
  'use strict';

  window.CTCFormatModal = {
    currentField: null,
    currentFieldType: null,
    init: function () {
      this.bindFormatIcons();
      this.bindModalActions();
      this.bindFormattingControls();
      this.bindColorTabbing();
      this.bindRGBAControls();
      this.bindGradientControls();
    },
    /**
     * Bind format icon button clicks
     */
    bindFormatIcons: function () {
      var self = this;
      $(document).on('click', '.cta-format-icon-btn', function (e) {
        e.preventDefault();
        var fieldType = $(this).data('field');
        self.openModal(fieldType);
      });
    },
    /**
     * Open formatting modal for a specific field
     */
    openModal: function (fieldType) {
      this.currentFieldType = fieldType;
      this.loadCurrentSettings(fieldType);
      if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
        window.ctaModalAPI.open('#cta-format-modal');
      } else {
        $('#cta-format-modal').fadeIn(150);
        $('body').addClass('cta-modal-open');
      }
    },
    /**
     * Load current settings into modal
     */
    loadCurrentSettings: function (fieldType) {
      var fontSize = $('#' + fieldType + '_font_size').val() || '16px';
      var fontFamily = $('#' + fieldType + '_font_family').val() || 'inherit';
      var fontWeight = $('#' + fieldType + '_font_weight').val() || '400';
      var color = $('#' + fieldType + '_color').val() || '#1e1e1e';
      var alignment = $('#' + fieldType + '_alignment').val() || 'left';

      // Parse font size to number and unit
      var sizeMatch = fontSize.match(/^(\d+(?:\.\d+)?)(px|rem|em)$/);
      if (sizeMatch) {
        $('#cta-format-font-size-value').val(sizeMatch[1]);
        $('#cta-format-font-size-unit').val(sizeMatch[2]);
        $('#cta-format-font-size-slider').val(sizeMatch[1]);
      }
      $('#cta-format-font-family').val(fontFamily);
      $('#cta-format-font-weight').val(fontWeight);

      // Set alignment button
      $('.cta-alignment-btn').removeClass('active');
      $('.cta-alignment-btn[data-align="' + alignment + '"]').addClass('active');

      // Determine color type and load into appropriate tab
      if (color.indexOf('gradient') !== -1) {
        // Gradient color - switch to gradient tab
        $('.cta-color-tab-btn').removeClass('active');
        $('.cta-color-tab-btn[data-tab="gradient"]').addClass('active');
        $('.cta-color-tab-content').removeClass('active');
        $('.cta-color-tab-content[data-tab="gradient"]').addClass('active');

        // Parse gradient and populate controls
        // For now, just update the preview - user can adjust settings
        $('.cta-gradient-preview').css('background', color);
      } else if (color.indexOf('rgba') !== -1) {
        // RGBA color - switch to RGBA tab
        $('.cta-color-tab-btn').removeClass('active');
        $('.cta-color-tab-btn[data-tab="rgba"]').addClass('active');
        $('.cta-color-tab-content').removeClass('active');
        $('.cta-color-tab-content[data-tab="rgba"]').addClass('active');

        // Parse RGBA values
        var rgbaMatch = color.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);
        if (rgbaMatch) {
          $('#cta-rgba-r').val(rgbaMatch[1]);
          $('#cta-rgba-g').val(rgbaMatch[2]);
          $('#cta-rgba-b').val(rgbaMatch[3]);
          var alpha = rgbaMatch[4] ? Math.round(parseFloat(rgbaMatch[4]) * 100) : 100;
          $('#cta-rgba-a').val(alpha);

          // Update value inputs
          $('#cta-rgba-r').closest('.cta-rgba-input-group').find('.cta-rgba-value').val(rgbaMatch[1]);
          $('#cta-rgba-g').closest('.cta-rgba-input-group').find('.cta-rgba-value').val(rgbaMatch[2]);
          $('#cta-rgba-b').closest('.cta-rgba-input-group').find('.cta-rgba-value').val(rgbaMatch[3]);
          $('#cta-rgba-a').closest('.cta-rgba-input-group').find('.cta-rgba-value').val(alpha);
          this.updateRGBAPreview();
        }
      } else {
        // Hex/solid color - switch to hex tab (default)
        $('.cta-color-tab-btn').removeClass('active');
        $('.cta-color-tab-btn[data-tab="hex"]').addClass('active');
        $('.cta-color-tab-content').removeClass('active');
        $('.cta-color-tab-content[data-tab="hex"]').addClass('active');
        $('#cta-format-color').val(color);
        $('#cta-color-wheel').val(color);
        this.updateColorPreview(color);
      }
      this.updateFormattingPreview();
    },
    /**
     * Bind modal action buttons
     */
    bindModalActions: function () {
      var self = this;
      $(document).on('click', '#cta-format-modal [data-action="cancel"]', function (e) {
        e.preventDefault();
        self.closeModal();
      });
      $(document).on('click', '#cta-format-modal [data-action="apply"]', function (e) {
        e.preventDefault();
        self.applySettings();
      });
    },
    /**
     * Bind formatting control changes
     */
    bindFormattingControls: function () {
      var self = this;

      // Font family change
      $(document).on('change', '#cta-format-font-family', function () {
        self.updateFormattingPreview();
      });

      // Font size value change
      $(document).on('change input', '#cta-format-font-size-value, #cta-format-font-size-unit', function () {
        var value = $('#cta-format-font-size-value').val();
        $('#cta-format-font-size-slider').val(value);
        self.updateFormattingPreview();
      });

      // Font size slider change
      $(document).on('input', '#cta-format-font-size-slider', function () {
        var value = $(this).val();
        $('#cta-format-font-size-value').val(value);
        self.updateFormattingPreview();
      });

      // Font weight dropdown change
      $(document).on('change', '#cta-format-font-weight', function () {
        self.updateFormattingPreview();
      });

      // Alignment buttons
      $(document).on('click', '.cta-alignment-btn', function (e) {
        e.preventDefault();
        $('.cta-alignment-btn').removeClass('active');
        $(this).addClass('active');
        self.updateFormattingPreview();
      });

      // Hex color input
      $(document).on('input', '#cta-format-color', function () {
        var color = $(this).val();
        $('#cta-color-wheel').val(color);
        self.updateColorPreview(color);
        self.updateFormattingPreview();
      });

      // Color wheel picker
      $(document).on('input', '#cta-color-wheel', function () {
        var color = $(this).val();
        $('#cta-format-color').val(color);
        self.updateColorPreview(color);
        self.updateFormattingPreview();
      });

      // Color presets
      $(document).on('click', '.cta-preset-swatch', function (e) {
        e.preventDefault();
        var color = $(this).data('color');
        $('#cta-format-color').val(color);
        $('#cta-color-wheel').val(color);
        self.updateColorPreview(color);
        self.updateFormattingPreview();
      });
    },
    /**
     * Bind color tabbing
     */
    bindColorTabbing: function () {
      var self = this;
      $(document).on('click', '.cta-color-tab-btn', function (e) {
        e.preventDefault();
        var tab = $(this).data('tab');
        $('.cta-color-tab-btn').removeClass('active');
        $(this).addClass('active');
        $('.cta-color-tab-content').removeClass('active');
        $('.cta-color-tab-content[data-tab="' + tab + '"]').addClass('active');
      });
    },
    /**
     * Bind RGBA controls
     */
    bindRGBAControls: function () {
      var self = this;
      $(document).on('input', '.cta-rgba-slider', function () {
        var container = $(this).closest('.cta-rgba-input-group');
        var valueInput = container.find('.cta-rgba-value');
        valueInput.val($(this).val());
        self.updateRGBAPreview();
      });
      $(document).on('input', '.cta-rgba-value', function () {
        var container = $(this).closest('.cta-rgba-input-group');
        var slider = container.find('.cta-rgba-slider');
        var val = parseInt($(this).val(), 10);
        if (val < 0 || val > 255) {
          val = Math.max(0, Math.min(255, val));
          $(this).val(val);
        }
        slider.val(val);
        self.updateRGBAPreview();
      });
    },
    /**
     * Update RGBA preview
     */
    updateRGBAPreview: function () {
      var r = $('#cta-rgba-r').val();
      var g = $('#cta-rgba-g').val();
      var b = $('#cta-rgba-b').val();
      var a = ($('#cta-rgba-a').val() / 100).toFixed(2);
      var rgba = 'rgba(' + r + ', ' + g + ', ' + b + ', ' + a + ')';
      $('.cta-rgba-preview').css('background-color', rgba);
      $('#cta-format-color').val(rgba);
    },
    /**
     * Bind gradient controls
     */
    bindGradientControls: function () {
      var self = this;
      $(document).on('change', '#cta-gradient-type', function () {
        self.updateGradientPreview();
      });
      $(document).on('input', '#cta-gradient-angle', function () {
        $('.cta-angle-value').text($(this).val() + 'Â°');
        self.updateGradientPreview();
      });
      $(document).on('input', '.cta-gradient-stop input', function () {
        self.updateGradientPreview();
      });
      $(document).on('input', '.cta-stop-position', function () {
        var value = $(this).val();
        $(this).closest('.cta-gradient-stop').find('.cta-stop-label').text(value + '%');
        self.updateGradientPreview();
      });
    },
    /**
     * Update gradient preview
     */
    updateGradientPreview: function () {
      var type = $('#cta-gradient-type').val() || 'linear';
      var angle = $('#cta-gradient-angle').val() || 90;
      var stops = [];
      $('.cta-gradient-stop').each(function () {
        var color = $(this).find('.cta-stop-color').val();
        var position = $(this).find('.cta-stop-position').val();
        stops.push(color + ' ' + position + '%');
      });
      var gradient;
      if (type === 'radial') {
        gradient = 'radial-gradient(' + stops.join(', ') + ')';
      } else {
        gradient = 'linear-gradient(' + angle + 'deg, ' + stops.join(', ') + ')';
      }
      $('.cta-gradient-preview').css('background', gradient);
      // Don't sync gradient to hex color input - keep it separate
    },
    /**
     * Update color preview box
     */
    updateColorPreview: function (color) {
      $('.cta-preview-sample').css('color', color);

      // Adjust background for visibility based on color brightness
      var brightness = this.getBrightness(color);
      var bgColor = brightness > 128 ? '#1e1e1e' : '#ffffff';
      $('.cta-preview-sample').css('background-color', bgColor);
    },
    /**
     * Calculate color brightness (0-255)
     */
    getBrightness: function (color) {
      // Handle hex colors
      if (color.charAt(0) === '#') {
        var hex = color.substring(1);
        var r = parseInt(hex.substr(0, 2), 16);
        var g = parseInt(hex.substr(2, 2), 16);
        var b = parseInt(hex.substr(4, 2), 16);
        return (r * 299 + g * 587 + b * 114) / 1000;
      }
      // For other formats (rgba, gradients), default to light text on dark background
      return 50;
    },
    /**
     * Update formatting preview
     */
    updateFormattingPreview: function () {
      var fontSize = $('#cta-format-font-size-value').val() + $('#cta-format-font-size-unit').val();
      var fontFamily = $('#cta-format-font-family').val();
      var fontWeight = $('#cta-format-font-weight').val() || '400';
      var color = $('#cta-format-color').val();
      var alignment = $('.cta-alignment-btn.active').data('align') || 'left';

      // Note: Preview element was removed from template, this function kept for potential future use
    },
    /**
     * Apply settings to hidden inputs
     */
    applySettings: function () {
      var fieldType = this.currentFieldType;
      var fontSize = $('#cta-format-font-size-value').val() + $('#cta-format-font-size-unit').val();
      var fontFamily = $('#cta-format-font-family').val();
      var fontWeight = $('#cta-format-font-weight').val() || '400';
      var alignment = $('.cta-alignment-btn.active').data('align') || 'left';

      // Determine which color tab is active and get the appropriate color value
      var activeTab = $('.cta-color-tab-btn.active').data('tab');
      var color;
      if (activeTab === 'gradient') {
        // Build gradient CSS from current settings
        var type = $('#cta-gradient-type').val() || 'linear';
        var angle = $('#cta-gradient-angle').val() || 90;
        var stops = [];
        $('.cta-gradient-stop').each(function () {
          var stopColor = $(this).find('.cta-stop-color').val();
          var position = $(this).find('.cta-stop-position').val();
          stops.push(stopColor + ' ' + position + '%');
        });
        if (type === 'radial') {
          color = 'radial-gradient(' + stops.join(', ') + ')';
        } else {
          color = 'linear-gradient(' + angle + 'deg, ' + stops.join(', ') + ')';
        }
      } else if (activeTab === 'rgba') {
        // Get RGBA value
        var r = $('#cta-rgba-r').val();
        var g = $('#cta-rgba-g').val();
        var b = $('#cta-rgba-b').val();
        var a = ($('#cta-rgba-a').val() / 100).toFixed(2);
        color = 'rgba(' + r + ', ' + g + ', ' + b + ', ' + a + ')';
      } else {
        // Get hex/solid color
        color = $('#cta-format-color').val();
      }
      $('#' + fieldType + '_font_size').val(fontSize);
      $('#' + fieldType + '_font_family').val(fontFamily);
      $('#' + fieldType + '_font_weight').val(fontWeight);
      $('#' + fieldType + '_color').val(color);
      $('#' + fieldType + '_alignment').val(alignment);

      // Trigger preview update via custom event
      $(document).trigger('ctaFormatApplied', [fieldType]);
      this.closeModal();
    },
    /**
     * Close modal
     */
    closeModal: function () {
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close('#cta-format-modal');
      } else {
        $('#cta-format-modal').fadeOut(150, function () {
          if (!$('.cta-modal:visible').length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }
    }
  };
  $(function () {
    if ($('#cta-format-modal').length) {
      CTCFormatModal.init();
    }
  });
})(jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTCFormatModal);

/***/ }),

/***/ "./assets/js/admin/modules/modals/preview-modal.js":
/*!*********************************************************!*\
  !*** ./assets/js/admin/modules/modals/preview-modal.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Preview Modal Module
 *
 * Contains JavaScript behavior for the preview modal.
 * Used by admin entry bundles to handle modal interactions.
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function ($) {
  'use strict';

  let docShowHandlerBound = false;
  let addToggleBound = false;
  function initCtaFormPreview($form) {
    if (!$form || !$form.length || $form.data('ctaPreviewReady')) {
      return;
    }
    $form.data('ctaPreviewReady', true);

    // Try multiple ways to find the container
    let $container = $form.closest('#cta-cta-section, .cta-section');
    if (!$container.length) {
      // Fallback: if form is in a modal, look in the modal container
      $container = $form.closest('.cta-global-form-container, .cta-global-form-modal');
      if (!$container.length) {
        // Last fallback: use the form's parent
        $container = $form.parent();
      }
    }
    const $previewCard = $container.find('#cta-live-preview .cta-preview-card').first();
    const $typeIndicator = $container.find('#cta-preview-type-indicator .cta-preview-type-label').first();
    const titleEl = $previewCard.find('.cta-preview-title');
    const taglineEl = $previewCard.find('.cta-preview-tagline');
    const bodyEl = $previewCard.find('.cta-preview-body');
    const btnEl = $previewCard.find('.cta-preview-button');
    const btnLabel = $previewCard.find('.cta-preview-label');
    const iconEl = $previewCard.find('.cta-preview-icon-wrapper');

    // Type labels mapping
    const typeLabels = {
      'phone': 'Phone Call',
      'email': 'Email',
      'link': 'Link',
      'popup': 'Popup',
      'slide-in': 'Slide-in'
    };
    const formWrapper = $container.find('#cta-form-wrapper').first();
    const formSection = $container.is('#cta-cta-section') ? $container : $container.find('#cta-cta-section').first();
    const addToggle = $('#cta-add-new-toggle');
    const isGlobalModal = $form.closest('.cta-global-form-modal').length > 0;
    const typeSelect = $form.find('#cta-type');
    const layoutSelect = $form.find('#cta-layout');
    const emailField = $form.find('#cta-email-to').closest('.cta-form-group');
    const linkField = $form.find('#cta-link-url').closest('.cta-form-group');
    const phoneField = $form.find('#phone-number').closest('.cta-form-group');
    const proNumberSelect = $container.find('#pro-number-select').first();
    const buttonTextField = $form.find('#button-text');
    const blacklistModal = $container.find('#cta-blacklist-modal').first();
    const blacklistRows = $container.find('#cta-blacklist-rows').first();
    const blacklistHiddenContainer = $container.find('#cta-blacklist-hidden-container').first();
    const blacklistCount = $container.find('#cta-blacklist-count').first();
    const openBlacklistBtn = $container.find('#cta-open-blacklist-modal').first();
    const addBlacklistBtn = $container.find('#cta-add-blacklist-row').first();
    let blacklistValues = [];
    function setRequired($el, isRequired) {
      if (!$el || !$el.length) return;
      if (isRequired) {
        $el.attr('required', 'required');
      } else {
        $el.removeAttr('required');
      }
    }
    function toggleFields() {
      const type = typeSelect.val();
      emailField.hide();
      linkField.hide();
      phoneField.hide();
      setRequired(emailField.find('input'), false);
      setRequired(linkField.find('input'), false);
      setRequired(phoneField.find('input'), false);
      switch (type) {
        case 'email':
          emailField.show();
          setRequired(emailField.find('input'), true);
          break;
        case 'link':
          linkField.show();
          setRequired(linkField.find('input[type="url"]'), true);
          break;
        case 'popup':
          break;
        // popup does not need a target field
        default:
          phoneField.show();
          setRequired(phoneField.find('input'), true);
          break;
      }
      setRequired(buttonTextField, true);
    }

    /**
     * Check if all required fields have values
     */
    function checkRequiredFields() {
      const type = typeSelect.val() || 'phone';
      const name = $form.find('#cta-name').val() || '';
      const buttonText = $form.find('#button-text').val() || '';

      // Name and button text are always required
      if (!name.trim() || !buttonText.trim()) {
        return false;
      }

      // Check type-specific required field
      switch (type) {
        case 'email':
          const email = $form.find('#cta-email-to').val() || '';
          if (!email.trim()) return false;
          break;
        case 'link':
          const url = $form.find('#cta-link-url').val() || '';
          if (!url.trim()) return false;
          break;
        case 'popup':
          // Popup doesn't need a target
          break;
        case 'slide-in':
          // Slide-in may have additional requirements - for now just name/button
          break;
        default:
          // phone
          const phone = $form.find('#phone-number').val() || '';
          if (!phone.trim()) return false;
          break;
      }
      return true;
    }

    /**
     * Get missing required fields for hint display
     */
    function getMissingFields() {
      const missing = [];
      const type = typeSelect.val() || 'phone';
      const name = $form.find('#cta-name').val() || '';
      const buttonText = $form.find('#button-text').val() || '';
      if (!name.trim()) missing.push('Name');
      if (!buttonText.trim()) missing.push('Button Text');
      switch (type) {
        case 'email':
          const email = $form.find('#cta-email-to').val() || '';
          if (!email.trim()) missing.push('Email Address');
          break;
        case 'link':
          const url = $form.find('#cta-link-url').val() || '';
          if (!url.trim()) missing.push('Link URL');
          break;
        case 'popup':
          break;
        default:
          // phone
          const phone = $form.find('#phone-number').val() || '';
          if (!phone.trim()) missing.push('Phone Number');
          break;
      }
      return missing;
    }
    function updatePreview() {
      if (!$previewCard.length) {
        return;
      }
      toggleFields();

      // Update type indicator text
      const currentType = typeSelect.val() || 'phone';
      if ($typeIndicator.length) {
        $typeIndicator.text(typeLabels[currentType] || 'Phone Call');
      }
      const $previewContainer = $previewCard.closest('.cta-live-preview');
      const allFieldsValid = checkRequiredFields();

      // Show/hide placeholder state
      if (!allFieldsValid) {
        const missing = getMissingFields();
        $previewCard.addClass('is-placeholder');
        $previewContainer.addClass('has-placeholder');

        // Update or create placeholder message
        let $placeholder = $previewContainer.find('.cta-preview-placeholder');
        if (!$placeholder.length) {
          $placeholder = $('<div class="cta-preview-placeholder"></div>');
          $previewContainer.append($placeholder);
        }
        $placeholder.html('<span class="dashicons dashicons-visibility"></span>' + '<span class="cta-preview-placeholder-title">Preview will appear here</span>' + '<span class="cta-preview-placeholder-hint">Complete required fields: ' + missing.join(', ') + '</span>');
        $placeholder.show();
        $previewCard.hide();
        return;
      }

      // Hide placeholder, show preview
      $previewCard.removeClass('is-placeholder').show();
      $previewContainer.removeClass('has-placeholder');
      $previewContainer.find('.cta-preview-placeholder').hide();
      const title = $form.find('#cta-title').val() || '';
      const tagline = $form.find('#cta-tagline').val() || '';
      const body = $form.find('#cta-body-text').val() || '';
      const btn = $form.find('#button-text').val() || 'Call Now';
      const layout = layoutSelect.val() || 'button';
      const iconValue = $form.find('#cta-icon').val() || 'none';
      const showIcon = iconValue !== 'none';
      titleEl.text(title);
      taglineEl.text(tagline);
      bodyEl.text(body);
      btnLabel.text(btn);
      iconEl.toggle(showIcon);

      // Apply text formatting from format modal
      applyTextFormatting();

      // Make button functional based on type
      updateButtonAction();

      // Apply button styles from form configuration
      applyButtonStyles();
      $previewCard.removeClass(function (index, className) {
        return (className.match(/(^|\s)layout-\S+/g) || []).join(' ');
      }).addClass('layout-' + layout);
    }

    /**
     * Apply inline styles to preview button from form configuration
     */
    function applyButtonStyles() {
      if (!btnEl.length) return;

      // Get background settings
      const backgroundType = $form.find('#cta-background-type').val() || 'solid';
      const buttonColor = $form.find('#cta-color').val() || '#667eea';
      const gradientStart = $form.find('#cta-gradient-start').val() || '#667eea';
      const gradientEnd = $form.find('#cta-gradient-end').val() || '#764ba2';
      const gradientAngle = $form.find('#cta-gradient-angle').val() || '90';

      // Build background style
      let background, backgroundColor;
      if (backgroundType === 'transparent') {
        background = 'transparent';
        backgroundColor = 'transparent';
      } else if (backgroundType === 'gradient') {
        background = 'linear-gradient(' + gradientAngle + 'deg, ' + gradientStart + ', ' + gradientEnd + ')';
        backgroundColor = gradientStart; // Fallback
      } else {
        background = buttonColor;
        backgroundColor = buttonColor;
      }

      // Get border settings (using individual side fields)
      const borderStyle = $form.find('#cta-border-style').val() || 'none';
      const borderColor = $form.find('#cta-border-color').val() || '#667eea';

      // Get border width values (use top as default for shorthand, or build full border)
      const borderWidthTop = $form.find('#cta-border-width-top').val() || '2px';
      const borderWidthRight = $form.find('#cta-border-width-right').val() || '2px';
      const borderWidthBottom = $form.find('#cta-border-width-bottom').val() || '2px';
      const borderWidthLeft = $form.find('#cta-border-width-left').val() || '2px';

      // Get border radius values
      const borderRadiusTL = $form.find('#cta-border-radius-top-left').val() || '8px';
      const borderRadiusTR = $form.find('#cta-border-radius-top-right').val() || '8px';
      const borderRadiusBR = $form.find('#cta-border-radius-bottom-right').val() || '8px';
      const borderRadiusBL = $form.find('#cta-border-radius-bottom-left').val() || '8px';
      const borderRadius = borderRadiusTL + ' ' + borderRadiusTR + ' ' + borderRadiusBR + ' ' + borderRadiusBL;

      // Build border CSS using individual widths
      let borderTop = 'none',
        borderRight = 'none',
        borderBottom = 'none',
        borderLeft = 'none';
      if (borderStyle !== 'none') {
        borderTop = borderWidthTop + ' ' + borderStyle + ' ' + borderColor;
        borderRight = borderWidthRight + ' ' + borderStyle + ' ' + borderColor;
        borderBottom = borderWidthBottom + ' ' + borderStyle + ' ' + borderColor;
        borderLeft = borderWidthLeft + ' ' + borderStyle + ' ' + borderColor;
      }

      // Get padding settings (always enabled now)
      const paddingTop = $form.find('#cta-padding-top').val() || '12px';
      const paddingRight = $form.find('#cta-padding-right').val() || '24px';
      const paddingBottom = $form.find('#cta-padding-bottom').val() || '12px';
      const paddingLeft = $form.find('#cta-padding-left').val() || '24px';
      const padding = paddingTop + ' ' + paddingRight + ' ' + paddingBottom + ' ' + paddingLeft;

      // Apply inline styles - these override the unstyled class defaults
      // Note: We don't set color here - that's handled by applyTextFormatting()
      // We also don't set font-weight and font-size - those come from text formatting
      btnEl.css({
        'background': background,
        'background-color': backgroundColor,
        'border-top': borderTop,
        'border-right': borderRight,
        'border-bottom': borderBottom,
        'border-left': borderLeft,
        'border-radius': borderRadius,
        'padding': padding
      });
    }

    /**
    * Apply text formatting from format modal to preview elements
    */
    function applyTextFormatting() {
      // Title formatting
      var titleFontSize = $form.find('#cta_title_font_size').val();
      var titleFontFamily = $form.find('#cta_title_font_family').val();
      var titleFontWeight = $form.find('#cta_title_font_weight').val();
      var titleColor = $form.find('#cta_title_color').val();
      var titleAlignment = $form.find('#cta_title_alignment').val();
      if (titleEl.length) {
        var titleStyles = {};
        if (titleFontSize) titleStyles['font-size'] = titleFontSize;
        if (titleFontFamily && titleFontFamily !== 'inherit') titleStyles['font-family'] = titleFontFamily;
        if (titleFontWeight) titleStyles['font-weight'] = titleFontWeight;
        if (titleColor) {
          // Handle gradient colors
          if (titleColor.indexOf('gradient') !== -1) {
            titleStyles['background'] = titleColor;
            titleStyles['background-clip'] = 'text';
            titleStyles['-webkit-background-clip'] = 'text';
            titleStyles['-webkit-text-fill-color'] = 'transparent';
            titleStyles['color'] = 'transparent';
          } else {
            titleStyles['color'] = titleColor;
          }
        }
        if (titleAlignment) titleStyles['text-align'] = titleAlignment;
        titleEl.css(titleStyles);
      }

      // Tagline formatting
      var taglineFontSize = $form.find('#cta_tagline_font_size').val();
      var taglineFontFamily = $form.find('#cta_tagline_font_family').val();
      var taglineFontWeight = $form.find('#cta_tagline_font_weight').val();
      var taglineColor = $form.find('#cta_tagline_color').val();
      var taglineAlignment = $form.find('#cta_tagline_alignment').val();
      if (taglineEl.length) {
        var taglineStyles = {};
        if (taglineFontSize) taglineStyles['font-size'] = taglineFontSize;
        if (taglineFontFamily && taglineFontFamily !== 'inherit') taglineStyles['font-family'] = taglineFontFamily;
        if (taglineFontWeight) taglineStyles['font-weight'] = taglineFontWeight;
        if (taglineColor) {
          if (taglineColor.indexOf('gradient') !== -1) {
            taglineStyles['background'] = taglineColor;
            taglineStyles['background-clip'] = 'text';
            taglineStyles['-webkit-background-clip'] = 'text';
            taglineStyles['-webkit-text-fill-color'] = 'transparent';
            taglineStyles['color'] = 'transparent';
          } else {
            taglineStyles['color'] = taglineColor;
          }
        }
        if (taglineAlignment) taglineStyles['text-align'] = taglineAlignment;
        taglineEl.css(taglineStyles);
      }

      // Body formatting
      var bodyFontSize = $form.find('#cta_body_font_size').val();
      var bodyFontFamily = $form.find('#cta_body_font_family').val();
      var bodyFontWeight = $form.find('#cta_body_font_weight').val();
      var bodyColor = $form.find('#cta_body_color').val();
      var bodyAlignment = $form.find('#cta_body_alignment').val();
      if (bodyEl.length) {
        var bodyStyles = {};
        if (bodyFontSize) bodyStyles['font-size'] = bodyFontSize;
        if (bodyFontFamily && bodyFontFamily !== 'inherit') bodyStyles['font-family'] = bodyFontFamily;
        if (bodyFontWeight) bodyStyles['font-weight'] = bodyFontWeight;
        if (bodyColor) {
          if (bodyColor.indexOf('gradient') !== -1) {
            bodyStyles['background'] = bodyColor;
            bodyStyles['background-clip'] = 'text';
            bodyStyles['-webkit-background-clip'] = 'text';
            bodyStyles['-webkit-text-fill-color'] = 'transparent';
            bodyStyles['color'] = 'transparent';
          } else {
            bodyStyles['color'] = bodyColor;
          }
        }
        if (bodyAlignment) bodyStyles['text-align'] = bodyAlignment;
        bodyEl.css(bodyStyles);
      }

      // Button text formatting (with defaults)
      var btnFontSize = $form.find('#button_text_font_size').val() || '16px';
      var btnFontFamily = $form.find('#button_text_font_family').val() || 'inherit';
      var btnFontWeight = $form.find('#button_text_font_weight').val() || '600';
      var btnColor = $form.find('#button_text_color').val() || '#ffffff';
      var btnAlignment = $form.find('#button_text_alignment').val() || 'center';
      var buttonAlignment = $form.find('#button_alignment').val() || 'center';
      var buttonWidth = $form.find('#button_width').val() || 'auto';

      // Apply text alignment to button container using justify-content (for flex)
      // text-align doesn't work on inline spans, so we use flex alignment
      if (btnEl.length) {
        var alignmentMap = {
          'left': 'flex-start',
          'center': 'center',
          'right': 'flex-end'
        };
        var justifyContent = alignmentMap[btnAlignment] || 'center';
        btnEl.css('justify-content', justifyContent);

        // Button width and alignment
        var buttonWidthValue = buttonWidth === 'full' ? '100%' : 'fit-content';
        var buttonStyles = {
          'display': 'flex',
          'width': buttonWidthValue
        };
        if (buttonWidth !== 'full') {
          buttonStyles['margin-left'] = buttonAlignment === 'left' ? '0' : 'auto';
          buttonStyles['margin-right'] = buttonAlignment === 'right' ? '0' : 'auto';
        } else {
          buttonStyles['margin-left'] = '0';
          buttonStyles['margin-right'] = '0';
        }
        btnEl.css(buttonStyles);
      }
      if (btnLabel.length) {
        var btnStyles = {
          'font-size': btnFontSize,
          'font-weight': btnFontWeight
        };
        if (btnFontFamily && btnFontFamily !== 'inherit') {
          btnStyles['font-family'] = btnFontFamily;
        }

        // Apply color (gradient or solid)
        if (btnColor.indexOf('gradient') !== -1) {
          btnStyles['background'] = btnColor;
          btnStyles['background-clip'] = 'text';
          btnStyles['-webkit-background-clip'] = 'text';
          btnStyles['-webkit-text-fill-color'] = 'transparent';
          btnStyles['color'] = 'transparent';
        } else {
          btnStyles['color'] = btnColor;
        }
        btnLabel.css(btnStyles);
      }
    }

    /**
     * Update button action based on CTA type
     */
    function updateButtonAction() {
      if (!btnEl.length) return;
      const type = typeSelect.val() || 'phone';
      let href = '#';
      let target = '_self';
      switch (type) {
        case 'phone':
          const phone = $form.find('#phone-number').val() || '';
          if (phone.trim()) {
            // Remove any non-digit characters for tel: link
            const cleanPhone = phone.replace(/[^\d+]/g, '');
            href = 'tel:' + cleanPhone;
          }
          break;
        case 'email':
          const email = $form.find('#cta-email-to').val() || '';
          if (email.trim()) {
            href = 'mailto:' + email.trim();
          }
          break;
        case 'link':
          const url = $form.find('#cta-link-url').val() || '';
          if (url.trim()) {
            href = url.trim();
          }
          // Check if new tab is enabled
          const newTab = $form.find('#cta-link-target-new-tab').is(':checked');
          target = newTab ? '_blank' : '_self';
          break;
        case 'popup':
        case 'slide-in':
          // These don't need functional links in preview
          href = '#';
          break;
      }

      // Update button attributes
      btnEl.attr('href', href);
      btnEl.attr('target', target);

      // Remove onclick handler if href is functional, add it back if not
      if (href !== '#' && type !== 'popup' && type !== 'slide-in') {
        btnEl.removeAttr('onclick');
      } else {
        btnEl.attr('onclick', 'return false;');
      }
    }
    $form.on('input change', 'input, textarea, select', updatePreview);
    $form.on('click', '.cta-button-alignment-btn', function (e) {
      e.preventDefault();
      var $btn = $(this);
      var $widthSelect = $form.find('#button_width');

      // Don't allow alignment change if full width is selected
      if ($widthSelect.val() === 'full') {
        return;
      }
      var align = $btn.data('align') || 'center';
      $btn.closest('.cta-button-alignment-buttons').find('.cta-button-alignment-btn').removeClass('active');
      $btn.addClass('active');
      $form.find('#button_alignment').val(align).trigger('change');
      updatePreview();
    });

    // Handle button width changes - force center alignment when full width is selected
    function handleButtonWidthChange() {
      var $widthSelect = $form.find('#button_width');
      var $alignmentBtns = $form.find('.cta-button-alignment-btn');
      var $alignmentInput = $form.find('#button_alignment');
      if ($widthSelect.val() === 'full') {
        // Disable alignment buttons and force center
        $alignmentBtns.addClass('disabled').prop('disabled', true);
        $alignmentBtns.removeClass('active');
        $alignmentBtns.filter('[data-align="center"]').addClass('active');
        $alignmentInput.val('center');
      } else {
        // Re-enable alignment buttons
        $alignmentBtns.removeClass('disabled').prop('disabled', false);
      }
      updatePreview();
    }

    // Listen for button width changes
    $form.on('change', '#button_width', handleButtonWidthChange);

    // Initialize on form load
    handleButtonWidthChange();

    // Ensure format modal changes update the live preview immediately
    $(document).on('ctaFormatApplied', function () {
      updatePreview();
    });
    if (proNumberSelect.length) {
      proNumberSelect.on('change', function () {
        const val = $(this).val();
        if (val) {
          phoneField.find('input').val(val).trigger('input');
        }
      });
    }
    function showForm() {
      if (!formWrapper.length) return;
      if (formSection.length && formSection.is(':hidden')) {
        formSection.slideDown(150);
      }
      formWrapper.slideDown(150, function () {
        $form.find('#cta-name').trigger('focus');
      });
    }
    if (addToggle.length && !isGlobalModal && !addToggleBound) {
      addToggle.on('click', function (e) {
        e.preventDefault();
        showForm();
      });
      addToggleBound = true;
    }
    if (!docShowHandlerBound && !isGlobalModal) {
      $(document).on('click', 'a[href="#cta-cta-form"]', function (e) {
        if (!formWrapper.length) return;
        if (formWrapper.is(':hidden')) {
          e.preventDefault();
          showForm();
        }
      });
      docShowHandlerBound = true;
    }
    function loadBlacklistFromInputs() {
      if (!blacklistHiddenContainer.length) return;
      blacklistValues = [];
      blacklistHiddenContainer.find('input[name="cta_blacklist_urls[]"]').each(function () {
        const val = ($(this).val() || '').trim();
        if (val) {
          blacklistValues.push(val);
        }
      });
    }
    function renderBlacklistRows() {
      if (!blacklistRows.length) return;
      blacklistRows.empty();
      if (!blacklistValues.length) {
        blacklistValues.push('');
      }
      blacklistValues.forEach((val, index) => {
        const row = $('<div class="cta-blacklist-row"></div>');
        const input = $('<input type="text" class="regular-text">').val(val);
        const removeBtn = $('<button type="button" class="cta-button-link"></button>').text('Remove');
        removeBtn.on('click', function () {
          blacklistValues.splice(index, 1);
          renderBlacklistRows();
        });
        row.append(input, removeBtn);
        blacklistRows.append(row);
      });
    }
    function syncBlacklistFromModal() {
      if (!blacklistRows.length) return;
      const values = [];
      blacklistRows.find('input[type="text"]').each(function () {
        const val = ($(this).val() || '').trim();
        if (val) {
          values.push(val);
        }
      });
      blacklistValues = values;
    }
    function updateBlacklistCount() {
      if (blacklistCount.length) {
        blacklistCount.text(blacklistValues.length);
      }
    }
    function syncBlacklistHiddenInputs() {
      if (!blacklistHiddenContainer.length) return;
      blacklistHiddenContainer.empty();
      blacklistValues.forEach(val => {
        $('<input>', {
          type: 'hidden',
          name: 'cta_blacklist_urls[]',
          value: val
        }).appendTo(blacklistHiddenContainer);
      });
      updateBlacklistCount();
    }
    function openBlacklistModal() {
      loadBlacklistFromInputs();
      renderBlacklistRows();
      if (window.ctaModalAPI && typeof window.ctaModalAPI.open === 'function') {
        window.ctaModalAPI.open(blacklistModal);
      } else {
        blacklistModal.fadeIn(120);
        $('body').addClass('cta-modal-open');
      }
    }
    function closeBlacklistModal() {
      if (window.ctaModalAPI && typeof window.ctaModalAPI.close === 'function') {
        window.ctaModalAPI.close(blacklistModal);
      } else {
        blacklistModal.fadeOut(120, function () {
          if (!$('.cta-modal:visible').not(blacklistModal).length) {
            $('body').removeClass('cta-modal-open');
          }
        });
      }
    }
    if (openBlacklistBtn.length && blacklistModal.length) {
      openBlacklistBtn.on('click', function () {
        openBlacklistModal();
      });
      blacklistModal.on('click', '.cta-modal-close, .cta-modal-overlay, [data-action="cancel"]', function () {
        closeBlacklistModal();
      });
      blacklistModal.on('click', '[data-action="save"]', function () {
        syncBlacklistFromModal();
        syncBlacklistHiddenInputs();
        closeBlacklistModal();
      });
      if (addBlacklistBtn.length) {
        addBlacklistBtn.on('click', function () {
          blacklistValues.push('');
          renderBlacklistRows();
          const lastInput = blacklistRows.find('input[type="text"]').last();
          if (lastInput.length) {
            lastInput.trigger('focus');
          }
        });
      }
      loadBlacklistFromInputs();
      updateBlacklistCount();
    }
    updatePreview();
  }
  $('.cta-cta-form').each(function () {
    initCtaFormPreview($(this));
  });
  $(document).on('ctc:initCtaForm', function (e, form) {
    initCtaFormPreview($(form));
  });
})(jQuery);
/* harmony default export */ __webpack_exports__["default"] = ({});

/***/ }),

/***/ "./assets/js/shared/modules/page-bootstrap.js":
/*!****************************************************!*\
  !*** ./assets/js/shared/modules/page-bootstrap.js ***!
  \****************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   bootstrapPageController: function() { return /* binding */ bootstrapPageController; }
/* harmony export */ });
/**
 * CTA Manager - Page Bootstrap Utility Module
 *
 * Contains shared bootstrap behavior for component entry-point controllers.
 * Used to centralize document-ready and admin-ready initialization flows.
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

/**
 * Register and bootstrap a page controller.
 *
 * @param {Object} config Bootstrap configuration.
 * @param {string} config.globalName Window key for the controller.
 * @param {Function} [config.define] Function that mutates the controller with page methods.
 * @param {Function} [config.onReady] Function to run once when the page is ready.
 * @param {string} [config.readyEvent] jQuery event name to trigger after ready.
 * @param {boolean} [config.waitForAdminReady=true] Whether to wait for ctaAdminReady.
 * @returns {Object|null} Bootstrapped controller or null when jQuery is unavailable.
 */
function bootstrapPageController(config) {
  var $ = window.jQuery;
  if (typeof $ !== 'function' || !$.fn) {
    return null;
  }
  var settings = config || {};
  var globalName = settings.globalName;
  if (!globalName) {
    return null;
  }
  var controller = window[globalName] || {};
  if (typeof settings.define === 'function') {
    settings.define(controller, $);
  }
  var hasRun = false;
  var runReady = function () {
    if (hasRun) {
      return;
    }
    hasRun = true;
    if (typeof settings.onReady === 'function') {
      settings.onReady(controller, $);
    }
    if (settings.readyEvent) {
      $(document).trigger(settings.readyEvent, [controller]);
    }
  };
  controller.init = function () {
    var waitForAdminReady = settings.waitForAdminReady !== false;
    if (waitForAdminReady) {
      $(document).on('ctaAdminReady', runReady);
      if (window.CTAAdminApp) {
        runReady();
      }
      return;
    }
    runReady();
  };
  window[globalName] = controller;
  $(function () {
    controller.init();
  });
  return controller;
}

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Check if module exists (development only)
/******/ 		if (__webpack_modules__[moduleId] === undefined) {
/******/ 			var e = new Error("Cannot find module '" + moduleId + "'");
/******/ 			e.code = 'MODULE_NOT_FOUND';
/******/ 			throw e;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	!function() {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = function(exports, definition) {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	!function() {
/******/ 		__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	!function() {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = function(exports) {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	}();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry needs to be wrapped in an IIFE because it needs to be isolated against other modules in the chunk.
!function() {
/*!***************************************************!*\
  !*** ./assets/js/admin/components/manage-ctas.js ***!
  \***************************************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _modules_modals_format_modal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../modules/modals/format-modal */ "./assets/js/admin/modules/modals/format-modal.js");
/* harmony import */ var _modules_modals_preview_modal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../modules/modals/preview-modal */ "./assets/js/admin/modules/modals/preview-modal.js");
/* harmony import */ var _modules_forms_filters__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modules/forms/filters */ "./assets/js/admin/modules/forms/filters.js");
/* harmony import */ var _shared_modules_page_bootstrap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/modules/page-bootstrap */ "./assets/js/shared/modules/page-bootstrap.js");
/**
 * CTA Manager - Manage CTAs Page Entry Point
 *
 * This is the entry point for the Manage CTAs admin page (`cta-manager-cta`).
 * It initializes CTA list, filtering, format controls, and preview interactions.
 *
 * When bundled with npm, this file will import:
 * - ../modules/modals/format-modal
 * - ../modules/modals/preview-modal
 * - ../modules/forms/filters
 * - ../../shared/modules/page-bootstrap
 *
 * Dependencies (loaded via admin.js):
 * - CTCAdmin
 * - ctaModalAPI
 * - CTATabs
 *
 * Output: /assets/js/minimized/admin/manage-ctas.js
 *
 * @package CTA_Manager
 * @since 1.0.0
 */





(0,_shared_modules_page_bootstrap__WEBPACK_IMPORTED_MODULE_3__.bootstrapPageController)({
  globalName: 'CTAManageCTAsPage',
  define: function (controller, $) {
    controller.modules = {
      formatModal: 'CTCFormatModal',
      filters: 'CTAFilters'
    };

    /**
     * Auto-open editor modal for a specific CTA via ?edit_id= URL param
     */
    controller.handleEditIdParam = function () {
      var urlParams = new URLSearchParams(window.location.search);
      var editId = urlParams.get('edit_id');
      if (!editId) return;
      var $trigger = $('[data-cta-id="' + editId + '"][data-open-modal="#cta-global-form-modal"]').first();
      if (!$trigger.length) return;

      // Clean up URL param
      if (window.history && window.history.replaceState) {
        var cleanUrl = window.location.pathname + window.location.search.replace(/[?&]edit_id=[^&]+/, '').replace(/^&/, '?');
        window.history.replaceState({}, '', cleanUrl || window.location.pathname);
      }
      setTimeout(function () {
        $trigger.trigger('click');
        if (window.ctaModalAPI) {
          window.ctaModalAPI.open('#cta-global-form-modal');
        }
      }, 200);
    };

    /**
     * Initialize countdown timers for scheduled CTAs
     */
    controller.initCountdownTimers = function () {
      var $countdowns = $('.cta-countdown-time[data-timestamp]');
      if (!$countdowns.length) {
        return;
      }

      // Update all countdowns
      var updateCountdowns = function () {
        $countdowns.each(function () {
          var $countdown = $(this);
          var timestamp = parseInt($countdown.attr('data-timestamp'), 10);
          if (!timestamp) {
            return;
          }
          var now = Math.floor(Date.now() / 1000);
          var diff = timestamp - now;
          if (diff <= 0) {
            var expiredLabel = $countdown.attr('data-expired-label') || 'Now...';
            $countdown.text(expiredLabel);
            return;
          }

          // Calculate time units
          var days = Math.floor(diff / 86400);
          var hours = Math.floor(diff % 86400 / 3600);
          var minutes = Math.floor(diff % 3600 / 60);
          var seconds = diff % 60;

          // Format output
          var parts = [];
          if (days > 0) {
            parts.push(days + (days === 1 ? ' day' : ' days'));
          }
          if (hours > 0) {
            parts.push(hours + (hours === 1 ? ' hour' : ' hours'));
          }
          if (minutes > 0 && days === 0) {
            parts.push(minutes + (minutes === 1 ? ' minute' : ' minutes'));
          }
          if (seconds > 0 && days === 0 && hours === 0) {
            parts.push(seconds + (seconds === 1 ? ' second' : ' seconds'));
          }
          $countdown.text(parts.join(', ') || 'Less than a second');
        });
      };

      // Update immediately
      updateCountdowns();

      // Update every second
      setInterval(updateCountdowns, 1000);
    };
  },
  onReady: function (controller) {
    controller.initCountdownTimers();
    controller.handleEditIdParam();
  },
  readyEvent: 'ctaManageCTAsReady'
});
}();
/******/ })()
;