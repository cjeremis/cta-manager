/*!
 * CTA Manager - Settings Bundle
 *
 * JavaScript bundle for the Settings admin page.
 *
 * @package    CTA_Manager
 * @version    1.0.0
 * @copyright  2026 TopDevAmerica
 * @license    GPL-2.0+
 */
/******/ (function() { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./assets/js/admin/modules/pages/settings.js":
/*!***************************************************!*\
  !*** ./assets/js/admin/modules/pages/settings.js ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/**
 * CTA Manager - Settings Page Module
 *
 * Contains JavaScript behavior for the settings admin page.
 * Used by admin entry bundles to initialize page-level interactions.
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

(function ($) {
  'use strict';

  /**
   * Settings Handler Object
   */
  window.CTCSettings = window.CTCSettings || {};
  CTCSettings.init = function () {
    if (typeof ctaSettingsVars === 'undefined') {
      console.error('CTC Settings: Missing localization variables');
      return;
    }
    this.nonce = ctaSettingsVars.nonce;
    this.ajaxUrl = ctaSettingsVars.ajaxUrl;
    this.currentSettings = ctaSettingsVars.currentSettings || {};
    this.cacheSelectors();
    this.bindEvents();
    this.loadCurrentSettings();
    this.initLivePreview();
    this.autoSaveTimer = null;
    this.originalFormData = null; // Track original form state for dirty checking
    this.captureOriginalState();
  };

  /**
   * Cache frequently used selectors
   */
  CTCSettings.cacheSelectors = function () {
    this.$settingsForm = $('#cta-settings-form');
    this.$buttonNumberInput = $('#cta-button-number');
    this.$buttonTextInput = $('#cta-button-text');
    this.$buttonColorInput = $('#cta-button-color');
    this.$buttonSizeSelect = $('#cta-button-size');
    this.$enableAnimationCheckbox = $('#cta-enable-animation');
    this.$previewContainer = $('#cta-button-preview');
    this.$saveButton = this.$settingsForm.find('[type="submit"]');
    this.$resetButton = this.$settingsForm.find('[data-action="reset"]');
    this.$importExportTabs = $('.cta-import-export-tabs');
    this.$manualSaveFields = this.$settingsForm.find('[data-manual-save="true"]');
    this.$customCssButton = $('#cta-save-custom-css');
  };

  /**
   * Bind event handlers
   */
  CTCSettings.bindEvents = function () {
    var self = this;

    // Form submission
    this.$settingsForm.on('submit', function (e) {
      self.handleSaveSettings(e);
    });

    // Reset settings
    this.$resetButton.on('click', function (e) {
      e.preventDefault();
      self.handleResetSettings();
    });

    // Live preview triggers
    this.$buttonNumberInput.on('change blur', function () {
      self.updateLivePreview();
    });
    this.$buttonTextInput.on('change blur', function () {
      self.updateLivePreview();
    });
    this.$buttonColorInput.on('change', function () {
      self.updateLivePreview();
    });
    this.$buttonSizeSelect.on('change', function () {
      self.updateLivePreview();
    });
    this.$enableAnimationCheckbox.on('change', function () {
      self.updateLivePreview();
    });

    // Auto-save on change/blur for non-manual fields (only if value actually changed)
    this.$settingsForm.on('change blur', 'input, select, textarea', function () {
      var $field = $(this);
      if ($field.is(self.$manualSaveFields)) {
        return;
      }
      // Only queue auto-save if form has actual changes
      if (self.hasFormChanged()) {
        self.queueAutoSave();
      }
    });

    // Manual save for custom CSS
    if (this.$customCssButton.length) {
      this.$customCssButton.on('click', function (e) {
        e.preventDefault();
        self.performSave(self.$customCssButton);
      });
    }

    // Validation on input
    this.$buttonNumberInput.on('input', function () {
      self.validatePhoneNumber($(this));
    });

    // Analytics toggle - show/hide retention dropdown
    $('#cta-enable-analytics').on('change', function () {
      var isChecked = $(this).is(':checked');
      var $retentionWrapper = $('#cta-analytics-retention-wrapper');
      var $customRetentionWrapper = $('#cta-custom-retention-wrapper');
      if (isChecked) {
        $retentionWrapper.show();
        // Only show custom input if custom is selected
        if ($('#analytics-retention').val() === 'custom') {
          $customRetentionWrapper.show();
        }
      } else {
        $retentionWrapper.hide();
        $customRetentionWrapper.hide();
      }
    });
  };

  /**
   * Load current settings into form
   */
  CTCSettings.loadCurrentSettings = function () {
    if ($.isEmptyObject(this.currentSettings)) {
      return;
    }
    var self = this;
    $.each(this.currentSettings, function (key, value) {
      var $field = self.$settingsForm.find('[name="' + key + '"]');
      if ($field.length) {
        if ($field.is(':checkbox')) {
          $field.prop('checked', value === true || value === '1');
        } else if ($field.is(':radio')) {
          self.$settingsForm.find('[name="' + key + '"][value="' + value + '"]').prop('checked', true);
        } else {
          $field.val(value);
        }
      }
    });
  };

  /**
   * Handle save settings
   */
  CTCSettings.handleSaveSettings = function (e) {
    e.preventDefault();
    this.performSave(this.$saveButton);
  };

  /**
   * Queue an auto-save with a short debounce
   */
  CTCSettings.queueAutoSave = function () {
    var self = this;
    clearTimeout(this.autoSaveTimer);
    this.autoSaveTimer = setTimeout(function () {
      self.performSave();
    }, 400);
  };

  /**
   * Capture the original form state for dirty checking
   */
  CTCSettings.captureOriginalState = function () {
    this.originalFormData = this.$settingsForm.serialize();
  };

  /**
   * Check if the form has actually changed from original state
   */
  CTCSettings.hasFormChanged = function () {
    var currentData = this.$settingsForm.serialize();
    return currentData !== this.originalFormData;
  };

  /**
   * Perform AJAX save
   */
  CTCSettings.performSave = function ($button) {
    if (!this.validateForm()) {
      this.showToast('warning', 'Please correct the errors below.');
      return;
    }
    var self = this;
    var formData = this.getFormData();
    if ($button && $button.length) {
      CTCAdmin.setButtonLoading($button, true);
    }
    $.ajax({
      url: this.ajaxUrl,
      type: 'POST',
      dataType: 'json',
      data: {
        action: 'cta_save_settings',
        nonce: this.nonce,
        settings: formData.settings || formData
      },
      success: function (response) {
        if (response.success) {
          self.showToast('success', 'Settings saved successfully.');
          self.currentSettings = response.data.settings || response.data || {};
          self.captureOriginalState(); // Update original state after successful save
          self.$settingsForm.trigger('ctc:settingsSaved', [response]);
        } else {
          var message = response.data.message || response.message || 'Failed to save settings.';
          self.showToast('error', message);
        }
      },
      error: function (xhr, status, error) {
        console.error('Settings save error:', error);
        self.showToast('error', 'An error occurred while saving settings.');
      },
      complete: function () {
        if ($button && $button.length) {
          CTCAdmin.setButtonLoading($button, false);
        }
      }
    });
  };

  /**
   * Handle reset settings
   */
  CTCSettings.handleResetSettings = function () {
    if (!window.confirm('Are you sure you want to reset all settings to defaults?')) {
      return;
    }
    var self = this;
    var $resetBtn = this.$resetButton;
    CTCAdmin.setButtonLoading($resetBtn, true);
    $.ajax({
      url: this.ajaxUrl,
      type: 'POST',
      dataType: 'json',
      data: {
        action: 'cta_reset_settings',
        nonce: this.nonce
      },
      success: function (response) {
        if (response.success) {
          CTCAdmin.showNotice('Settings reset to defaults.', 'success');
          self.currentSettings = response.data || {};
          self.loadCurrentSettings();
          self.updateLivePreview();
        } else {
          CTCAdmin.showNotice('Failed to reset settings.', 'error');
        }
      },
      error: function () {
        CTCAdmin.showNotice('An error occurred while resetting settings.', 'error');
      },
      complete: function () {
        CTCAdmin.setButtonLoading($resetBtn, false, 'Reset to Defaults');
      }
    });
  };

  /**
   * Get form data
   * Handles nested bracket notation: settings[section][field] -> { settings: { section: { field: value } } }
   */
  CTCSettings.getFormData = function () {
    var formData = {};
    var formArray = this.$settingsForm.serializeArray();

    /**
     * Set a nested value in an object using an array of keys
     */
    function setNestedValue(obj, keys, value) {
      var current = obj;
      for (var i = 0; i < keys.length - 1; i++) {
        var key = keys[i];
        if (!current[key] || typeof current[key] !== 'object') {
          current[key] = {};
        }
        current = current[key];
      }
      var lastKey = keys[keys.length - 1];
      current[lastKey] = value;
    }

    /**
     * Get a nested value from an object using an array of keys
     */
    function getNestedValue(obj, keys) {
      var current = obj;
      for (var i = 0; i < keys.length; i++) {
        if (current === undefined || current === null) return undefined;
        current = current[keys[i]];
      }
      return current;
    }

    /**
     * Parse bracket notation into array of keys
     * e.g., "settings[analytics][enabled]" -> ["settings", "analytics", "enabled"]
     */
    function parseKeys(name) {
      var keys = [];
      var match = name.match(/^([^\[]+)/);
      if (match) {
        keys.push(match[1]);
      }
      var bracketMatches = name.match(/\[([^\]]*)\]/g);
      if (bracketMatches) {
        bracketMatches.forEach(function (bracket) {
          var key = bracket.slice(1, -1); // Remove [ and ]
          if (key) keys.push(key);
        });
      }
      return keys;
    }

    // Process all form fields
    $.each(formArray, function () {
      var keys = parseKeys(this.name);
      if (keys.length > 0) {
        setNestedValue(formData, keys, this.value);
      }
    });

    // Handle unchecked checkboxes (they don't appear in serializeArray)
    this.$settingsForm.find('input[type="checkbox"]').each(function () {
      var $checkbox = $(this);
      var name = $checkbox.attr('name');
      if (!name) return;
      var keys = parseKeys(name);
      if (keys.length === 0) return;

      // Check if this checkbox was included in formArray
      var isIncluded = formArray.some(function (item) {
        return item.name === name;
      });
      if (!isIncluded) {
        // Checkbox is unchecked, set to false
        setNestedValue(formData, keys, false);
      } else {
        // Checkbox is checked, convert "on" or "1" to true
        var currentValue = getNestedValue(formData, keys);
        if (currentValue === 'on' || currentValue === '1' || currentValue === 1) {
          setNestedValue(formData, keys, true);
        }
      }
    });
    return formData;
  };

  /**
   * Toast helper
   */
  CTCSettings.showToast = function (type, message) {
    if (window.CTAToast && typeof CTAToast[type] === 'function') {
      CTAToast[type](message);
    } else if (window.CTAToast && typeof CTAToast.show === 'function') {
      CTAToast.show(message, type);
    } else {
      CTCAdmin.showNotice(message, type === 'success' ? 'success' : 'error');
    }
  };

  /**
   * Validate entire form
   */
  CTCSettings.validateForm = function () {
    var isValid = true;

    // Validate phone number
    if (this.$buttonNumberInput.length) {
      if (!this.validatePhoneNumber(this.$buttonNumberInput)) {
        isValid = false;
      }
    }

    // Validate button text
    if (this.$buttonTextInput.length && !this.$buttonTextInput.val().trim()) {
      this.addFieldError(this.$buttonTextInput, 'Button text is required.');
      isValid = false;
    }
    return isValid;
  };

  /**
   * Validate phone number
   */
  CTCSettings.validatePhoneNumber = function ($input) {
    var number = $input.val().trim();
    if (!number) {
      this.addFieldError($input, 'Phone number is required.');
      return false;
    }

    // Remove non-numeric characters for validation
    var cleaned = number.replace(/\D/g, '');
    if (cleaned.length < 10) {
      this.addFieldError($input, 'Phone number must be at least 10 digits.');
      return false;
    }
    this.removeFieldError($input);
    return true;
  };

  /**
   * Add field error
   */
  CTCSettings.addFieldError = function ($field, message) {
    $field.addClass('cta-field-error');
    var $error = $field.next('.cta-field-error-message');
    if (!$error.length) {
      $error = $('<div class="cta-field-error-message"></div>');
      $field.after($error);
    }
    $error.text(message).show();
  };

  /**
   * Remove field error
   */
  CTCSettings.removeFieldError = function ($field) {
    $field.removeClass('cta-field-error');
    $field.next('.cta-field-error-message').hide();
  };

  /**
   * Initialize live preview
   */
  CTCSettings.initLivePreview = function () {
    if (this.$previewContainer.length) {
      this.updateLivePreview();
    }
  };

  /**
   * Update live preview button
   */
  CTCSettings.updateLivePreview = function () {
    if (!this.$previewContainer.length) {
      return;
    }
    var number = this.$buttonNumberInput.val() || '1-800-CALL';
    var text = this.$buttonTextInput.val() || 'Call Now';
    var color = this.$buttonColorInput.val() || '#0073aa';
    var size = this.$buttonSizeSelect.val() || 'md';
    var enableAnimation = this.$enableAnimationCheckbox.is(':checked');
    var classes = 'cta-button ' + size;
    if (enableAnimation) {
      classes += ' pulse';
    }
    var buttonHTML = '<a href="tel:' + number.replace(/\D/g, '') + '" class="' + classes + '" style="background-color: ' + color + ';">' + '<span class="cta-button-icon phone"></span>' + '<span class="cta-button-text">' + this.escapeHtml(text) + '</span>' + '</a>';
    this.$previewContainer.html(buttonHTML);
  };

  /**
   * Escape HTML
   */
  CTCSettings.escapeHtml = function (text) {
    return $('<div>').text(text).html();
  };

  /**
   * Handle tab switching
   */
  CTCSettings.handleTabSwitch = function (tabName) {
    this.$importExportTabs.find('.cta-tab-link').removeClass('active');
    this.$importExportTabs.find('[data-tab="' + tabName + '"]').addClass('active');
    var $tabContents = $('[data-tab-content]');
    $tabContents.addClass('cta-hidden');
    $('[data-tab-content="' + tabName + '"]').removeClass('cta-hidden');
  };

  /**
   * Handle Pro plugin activation via AJAX
   */
  CTCSettings.handleActivateProPlugin = function ($button) {
    var self = this;
    var nonce = $button.data('nonce');
    var $buttonText = $button.find('.cta-button-text');
    var $buttonSpinner = $button.find('.cta-button-spinner');
    var originalText = $buttonText.text();

    // Show loading state
    $button.prop('disabled', true);
    $buttonText.text('Activating...');
    $buttonSpinner.show();
    $.ajax({
      url: ctaSettingsVars ? ctaSettingsVars.ajaxUrl : ajaxurl,
      type: 'POST',
      dataType: 'json',
      data: {
        action: 'cta_activate_pro_plugin',
        nonce: nonce
      },
      success: function (response) {
        if (response.success) {
          $buttonText.text('Activated!');
          $buttonSpinner.hide();
          if (typeof CTCAdmin !== 'undefined' && CTCAdmin.showNotice) {
            CTCAdmin.showNotice(response.data.message, 'success');
          }

          // Reload the page after a short delay to show the license form
          setTimeout(function () {
            if (response.data.redirect) {
              window.location.href = response.data.redirect;
            } else {
              window.location.reload();
            }
          }, 1000);
        } else {
          $button.prop('disabled', false);
          $buttonText.text(originalText);
          $buttonSpinner.hide();
          var message = response.data && response.data.message ? response.data.message : 'Failed to activate plugin.';
          if (typeof CTCAdmin !== 'undefined' && CTCAdmin.showNotice) {
            CTCAdmin.showNotice(message, 'error');
          } else {
            alert(message);
          }
        }
      },
      error: function (xhr, status, error) {
        console.error('Pro plugin activation error:', error);
        $button.prop('disabled', false);
        $buttonText.text(originalText);
        $buttonSpinner.hide();
        if (typeof CTCAdmin !== 'undefined' && CTCAdmin.showNotice) {
          CTCAdmin.showNotice('An error occurred while activating the plugin.', 'error');
        } else {
          alert('An error occurred while activating the plugin.');
        }
      }
    });
  };

  /**
   * Handle import action dropdown Pro option changes
   * Note: Pro options are now disabled via HTML attribute and styled via CSS
   */
  CTCSettings.handleImportActionChange = function () {
    var $select = $('#cta-import-action');
    if (!$select.length) return;
    var $proBadge = $('#cta-import-action-pro-badge');
    var $errorMsg = $('#cta-import-action-pro-error');
    var isPro = $select.data('is-pro') === 1;

    // Handle dropdown changes - show badge/error for Pro-only selections
    $select.on('change', function () {
      var requiresPro = $(this).find('option:selected').data('requires-pro') === 1;

      // Show/hide PRO badge and error message
      if (requiresPro && !isPro) {
        $proBadge.fadeIn(200);
        $errorMsg.slideDown(200);
      } else {
        $proBadge.fadeOut(200);
        $errorMsg.slideUp(200);
      }
    });

    // Trigger change on page load to set initial state
    $select.trigger('change');
  };
  $(function () {
    CTCSettings.init();

    // Initialize import action Pro handling
    CTCSettings.handleImportActionChange();

    // Tab switching
    $(document).on('click', '.cta-tab-link', function (e) {
      e.preventDefault();
      var tabName = $(this).data('tab');
      CTCSettings.handleTabSwitch(tabName);
    });

    // Pro plugin activation button
    $(document).on('click', '#cta-activate-pro-plugin', function (e) {
      e.preventDefault();
      CTCSettings.handleActivateProPlugin($(this));
    });

    // Initialize custom icons functionality
    CTCSettings.initCustomIcons();
  });

  /**
   * Initialize custom icons functionality
   */
  CTCSettings.initCustomIcons = function () {
    var self = this;

    // Cache custom icons elements
    this.$addIconBtn = $('#cta-add-custom-icon-btn');
    this.$addIconModal = $('#cta-add-icon-modal');
    this.$deleteIconModal = $('#cta-delete-icon-modal');
    this.$iconsGrid = $('#cta-custom-icons-grid');
    this.$iconsEmpty = $('#cta-custom-icons-empty');
    if (!this.$addIconBtn.length) return;

    // Open add icon modal
    this.$addIconBtn.on('click', function (e) {
      e.preventDefault();
      self.openAddIconModal();
    });

    // SVG preview on textarea change
    $('#cta-icon-svg').on('input change', function () {
      self.updateSvgPreview($(this).val());
    });

    // Add icon form submission
    $('#cta-add-icon-form').on('submit', function (e) {
      e.preventDefault();
      self.handleAddIcon();
    });

    // Delete icon buttons
    $(document).on('click', '.cta-custom-icon-delete', function (e) {
      e.preventDefault();
      var iconId = $(this).data('icon-id');
      var iconName = $(this).data('icon-name');
      self.openDeleteIconModal(iconId, iconName);
    });

    // Confirm delete
    $('#cta-confirm-delete-icon-btn').on('click', function (e) {
      e.preventDefault();
      self.handleDeleteIcon();
    });

    // Modal close handlers
    this.$addIconModal.on('click', '[data-close-modal]', function (e) {
      e.preventDefault();
      self.closeAddIconModal();
    });
    this.$deleteIconModal.on('click', '[data-close-modal]', function (e) {
      e.preventDefault();
      self.closeDeleteIconModal();
    });

    // ESC key to close modals
    $(document).on('keydown', function (e) {
      if (e.key === 'Escape' || e.keyCode === 27) {
        if (self.$addIconModal.hasClass('is-open')) {
          self.closeAddIconModal();
        }
        if (self.$deleteIconModal.hasClass('is-open')) {
          self.closeDeleteIconModal();
        }
      }
    });
  };

  /**
   * Open add icon modal
   */
  CTCSettings.openAddIconModal = function () {
    // Reset form
    $('#cta-add-icon-form')[0].reset();
    $('#cta-icon-preview-group').hide();
    $('#cta-icon-preview').empty();
    $('#cta-add-icon-error').hide().empty();
    this.$addIconModal.addClass('is-open');
    $('body').css('overflow', 'hidden');
    $('#cta-icon-name').focus();
  };

  /**
   * Close add icon modal
   */
  CTCSettings.closeAddIconModal = function () {
    this.$addIconModal.removeClass('is-open');
    $('body').css('overflow', '');
  };

  /**
   * Update SVG preview
   */
  CTCSettings.updateSvgPreview = function (svg) {
    var $previewGroup = $('#cta-icon-preview-group');
    var $preview = $('#cta-icon-preview');
    if (!svg || !svg.trim()) {
      $previewGroup.hide();
      $preview.empty();
      return;
    }

    // Basic validation - must start with <svg
    if (!/^<svg[\s>]/i.test(svg.trim())) {
      $previewGroup.hide();
      $preview.empty();
      return;
    }

    // Show preview
    $previewGroup.show();
    $preview.html(svg);
  };

  /**
   * Handle add icon form submission
   */
  CTCSettings.handleAddIcon = function () {
    var self = this;
    var $form = $('#cta-add-icon-form');
    var $submitBtn = $('#cta-save-icon-btn');
    var $btnText = $submitBtn.find('.cta-button-text');
    var $btnSpinner = $submitBtn.find('.cta-button-spinner');
    var $error = $('#cta-add-icon-error');
    var iconName = $('#cta-icon-name').val().trim();
    var iconSvg = $('#cta-icon-svg').val().trim();

    // Validation
    if (!iconName) {
      $error.text('Icon name is required.').show();
      return;
    }
    if (!iconSvg) {
      $error.text('SVG code is required.').show();
      return;
    }
    if (!/^<svg[\s>]/i.test(iconSvg) || !/<\/svg>\s*$/i.test(iconSvg)) {
      $error.text('Invalid SVG code. Please provide valid SVG markup.').show();
      return;
    }

    // Show loading state
    $submitBtn.prop('disabled', true);
    $btnText.hide();
    $btnSpinner.show();
    $error.hide();
    $.ajax({
      url: this.ajaxUrl,
      type: 'POST',
      dataType: 'json',
      data: {
        action: 'cta_add_custom_icon',
        nonce: this.nonce,
        icon_name: iconName,
        icon_svg: iconSvg
      },
      success: function (response) {
        if (response.success) {
          CTCAdmin.showNotice(response.data.message, 'success');
          self.updateIconsGrid(response.data.icons);
          self.closeAddIconModal();
        } else {
          var message = response.data && response.data.message ? response.data.message : 'Failed to add icon.';
          $error.text(message).show();
        }
      },
      error: function (xhr, status, error) {
        console.error('Add icon error:', error);
        $error.text('An error occurred while adding the icon.').show();
      },
      complete: function () {
        $submitBtn.prop('disabled', false);
        $btnText.show();
        $btnSpinner.hide();
      }
    });
  };

  /**
   * Open delete icon modal
   */
  CTCSettings.openDeleteIconModal = function (iconId, iconName) {
    $('#cta-delete-icon-id').val(iconId);
    this.$deleteIconModal.find('.cta-confirm-icon-name').text(iconName);
    this.$deleteIconModal.addClass('is-open');
    $('body').css('overflow', 'hidden');
  };

  /**
   * Close delete icon modal
   */
  CTCSettings.closeDeleteIconModal = function () {
    this.$deleteIconModal.removeClass('is-open');
    $('body').css('overflow', '');
  };

  /**
   * Handle delete icon
   */
  CTCSettings.handleDeleteIcon = function () {
    var self = this;
    var iconId = $('#cta-delete-icon-id').val();
    var $submitBtn = $('#cta-confirm-delete-icon-btn');
    var $btnText = $submitBtn.find('.cta-button-text');
    var $btnSpinner = $submitBtn.find('.cta-button-spinner');

    // Show loading state
    $submitBtn.prop('disabled', true);
    $btnText.hide();
    $btnSpinner.show();
    $.ajax({
      url: this.ajaxUrl,
      type: 'POST',
      dataType: 'json',
      data: {
        action: 'cta_delete_custom_icon',
        nonce: this.nonce,
        icon_id: iconId
      },
      success: function (response) {
        if (response.success) {
          CTCAdmin.showNotice(response.data.message, 'success');
          self.updateIconsGrid(response.data.icons);
          self.closeDeleteIconModal();
        } else {
          var message = response.data && response.data.message ? response.data.message : 'Failed to delete icon.';
          CTCAdmin.showNotice(message, 'error');
        }
      },
      error: function (xhr, status, error) {
        console.error('Delete icon error:', error);
        CTCAdmin.showNotice('An error occurred while deleting the icon.', 'error');
      },
      complete: function () {
        $submitBtn.prop('disabled', false);
        $btnText.show();
        $btnSpinner.hide();
      }
    });
  };

  /**
   * Update icons grid
   */
  CTCSettings.updateIconsGrid = function (icons) {
    var $grid = this.$iconsGrid;
    var $empty = this.$iconsEmpty;
    if (!icons || icons.length === 0) {
      $grid.hide().empty();
      $empty.show();
      return;
    }
    var html = '';
    icons.forEach(function (icon) {
      html += '<div class="cta-custom-icon-item" data-icon-id="' + CTCSettings.escapeHtml(icon.id) + '">' + '<div class="cta-custom-icon-preview">' + icon.svg + '</div>' + '<div class="cta-custom-icon-name">' + CTCSettings.escapeHtml(icon.name) + '</div>' + '<button type="button" class="cta-custom-icon-delete" data-icon-id="' + CTCSettings.escapeHtml(icon.id) + '" data-icon-name="' + CTCSettings.escapeHtml(icon.name) + '" title="Delete Icon">' + '<span class="dashicons dashicons-trash"></span>' + '</button>' + '</div>';
    });
    $grid.html(html).show();
    $empty.hide();
  };
})(jQuery);
// ES6 Export
/* harmony default export */ __webpack_exports__["default"] = (CTCSettings);

/***/ }),

/***/ "./assets/js/shared/modules/page-bootstrap.js":
/*!****************************************************!*\
  !*** ./assets/js/shared/modules/page-bootstrap.js ***!
  \****************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   bootstrapPageController: function() { return /* binding */ bootstrapPageController; }
/* harmony export */ });
/**
 * CTA Manager - Page Bootstrap Utility Module
 *
 * Contains shared bootstrap behavior for component entry-point controllers.
 * Used to centralize document-ready and admin-ready initialization flows.
 *
 * @package CTA_Manager
 * @since 1.0.0
 */

/**
 * Register and bootstrap a page controller.
 *
 * @param {Object} config Bootstrap configuration.
 * @param {string} config.globalName Window key for the controller.
 * @param {Function} [config.define] Function that mutates the controller with page methods.
 * @param {Function} [config.onReady] Function to run once when the page is ready.
 * @param {string} [config.readyEvent] jQuery event name to trigger after ready.
 * @param {boolean} [config.waitForAdminReady=true] Whether to wait for ctaAdminReady.
 * @returns {Object|null} Bootstrapped controller or null when jQuery is unavailable.
 */
function bootstrapPageController(config) {
  var $ = window.jQuery;
  if (typeof $ !== 'function' || !$.fn) {
    return null;
  }
  var settings = config || {};
  var globalName = settings.globalName;
  if (!globalName) {
    return null;
  }
  var controller = window[globalName] || {};
  if (typeof settings.define === 'function') {
    settings.define(controller, $);
  }
  var hasRun = false;
  var runReady = function () {
    if (hasRun) {
      return;
    }
    hasRun = true;
    if (typeof settings.onReady === 'function') {
      settings.onReady(controller, $);
    }
    if (settings.readyEvent) {
      $(document).trigger(settings.readyEvent, [controller]);
    }
  };
  controller.init = function () {
    var waitForAdminReady = settings.waitForAdminReady !== false;
    if (waitForAdminReady) {
      $(document).on('ctaAdminReady', runReady);
      if (window.CTAAdminApp) {
        runReady();
      }
      return;
    }
    runReady();
  };
  window[globalName] = controller;
  $(function () {
    controller.init();
  });
  return controller;
}

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Check if module exists (development only)
/******/ 		if (__webpack_modules__[moduleId] === undefined) {
/******/ 			var e = new Error("Cannot find module '" + moduleId + "'");
/******/ 			e.code = 'MODULE_NOT_FOUND';
/******/ 			throw e;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	!function() {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = function(exports, definition) {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	!function() {
/******/ 		__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	!function() {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = function(exports) {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	}();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry needs to be wrapped in an IIFE because it needs to be isolated against other modules in the chunk.
!function() {
/*!************************************************!*\
  !*** ./assets/js/admin/components/settings.js ***!
  \************************************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _modules_pages_settings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../modules/pages/settings */ "./assets/js/admin/modules/pages/settings.js");
/* harmony import */ var _shared_modules_page_bootstrap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/modules/page-bootstrap */ "./assets/js/shared/modules/page-bootstrap.js");
/**
 * CTA Manager - Settings Page Entry Point
 *
 * This is the entry point for the Settings admin page (`cta-manager-settings`).
 * It initializes settings form behaviors and configuration interactions.
 *
 * When bundled with npm, this file will import:
 * - ../modules/pages/settings
 * - ../../shared/modules/page-bootstrap
 *
 * Dependencies (loaded via admin.js):
 * - CTCAdmin
 * - ctaModalAPI
 * - CTATabs
 *
 * Output: /assets/js/minimized/admin/settings.js
 *
 * @package CTA_Manager
 * @since 1.0.0
 */



(0,_shared_modules_page_bootstrap__WEBPACK_IMPORTED_MODULE_1__.bootstrapPageController)({
  globalName: 'CTASettingsPage',
  define: function (controller) {
    controller.modules = {
      settings: 'CTASettings'
    };
  },
  readyEvent: 'ctaSettingsReady'
});
}();
/******/ })()
;